{"version":3,"sources":["engine/roll.tsx","engine/dobasmatrix.tsx","engine/harc.tsx","engine/kasztok.tsx","engine/karakter.tsx","components/DobasEredmeny.tsx","components/DobasInput.tsx","components/NumberInput.tsx","components/DobasMatrixDisplay.tsx","components/PointsTable.tsx","components/Selection.tsx","components/KarakterAlkotasBackground.tsx","pages/KarakterAlkotas.tsx","components/FegyverLista.tsx","components/IntegerInput.tsx","components/FegyverEditor.tsx","components/FegyverValaszto.tsx","components/HMEloszto.tsx","components/KepzettsegModal.tsx","components/KepzettsegLista.tsx","components/PancelLista.tsx","components/PancelEditor.tsx","components/PancelValaszto.tsx","components/Pajzsok.tsx","components/Jegyzetek.tsx","story/components/EditableText.tsx","components/Felszereles.tsx","components/KategoriaEditor.tsx","components/KarakterTabla.tsx","pages/Karakterlap.tsx","engine/pancel.tsx","hooks/dataconnector.tsx","components/CategoriesDropdown.tsx","components/DragAndDrop.tsx","components/KarakterImport.tsx","pages/Kocskadobo.tsx","components/KockaModal.tsx","static/magus.png","components/PageHeader.tsx","components/SzituacioSelector.tsx","components/KombatCard.tsx","pages/Kombat.tsx","story/components/ContextMenu.tsx","story/components/SceneListContextMenu.tsx","story/utils/DomUtils.tsx","story/components/CommentEditorModal.tsx","story/components/CommentList.tsx","story/components/StoryEvent.tsx","story/utils/EditorUtils.tsx","story/components/editor/EditingButtons.tsx","story/components/EditableNode.tsx","story/utils/inlinerenderers/EventRenderer.tsx","story/utils/inlinerenderers/JumpRenderer.tsx","story/utils/inlinerenderers/LanguageRenderer.tsx","story/utils/inlinerenderers/ParagraphRenderer.tsx","story/utils/inlinerenderers/RewardRenderer.tsx","story/utils/inlinerenderers/RollRenderer.tsx","story/utils/inlinerenderers/SettingRenderer.tsx","story/utils/RenderUtils.tsx","story/components/editor/IconComponent.tsx","story/components/editor/EventRoleSelector.tsx","story/components/editor/EventEditor.tsx","story/components/EventEditorModal.tsx","story/components/timeline/Timeline.tsx","story/components/StoryContextMenu.tsx","story/utils/CommentUtils.tsx","story/components/StoryScene.tsx","story/pages/StoryPage.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["PATTERN","random","Math","rollDice","dice","ijasz","Array","numDice","keys","map","_","rollSingle","reduce","acc","curr","value","details","res","floor","die","ceil","div","rollKf","result","max","plus","kfMod","kf","roll","tries","abs","_roll","parseDiceRoll","diceString","Number","isNaN","replace","match","groups","undefined","formatDiceRoll","DobasMatrix","values","sum","add","name","dobas","forEach","key","toString","filter","indexOf","Object","a","b","getRolls","r","clearRolls","this","HARCERTEK_DISPLAY_NAMES","FEGYVER_KEPZETTSEG","ke","te","ve","ce","FEGYVERTELEN","harcertek","tamPerKor","sebzes","FEGYVEREK","lassu","lotav","SZITUACIOK","FegyverUtils","fegyver","toLowerCase","pajzs","KEPESSEG_NEV","ero","gy","ugy","ak","egs","sz","int","ae","asz","erz","FAJ_KEPESSEG","FOKASZTOK","KASZTOK","kepesseg","alapHarcertek","hm","kotelezo","szabad","epfp","ep","fp","fpPerSzint","harcos","lovag","tolvaj","pap","paplovag","findKepzettseg","kepzettseg","kepzettsegek","find","k","folottiResz","hatar","szintlepes","karakter","szint","r1","r2","kaszt","hmHarcertek","Set","akt","calculateSebesulesHatrany","calculateMGT","pancel","valasztottPancel","pancelok","nehez","mgt","calculateHarcertek","szituaciok","masodlagos","index","masodlagosFegyver","valasztottFegyver","fegyverek","findFegyver","tipus","ret","kepessegek","erobonusz","calculateKepessegHarcertek","fejvadasz","pajzsHasznalat","addKepzettseg","ketkezesHarc","addKetkezes","sebesules","DobasEredmeny","pointing","Label","size","color","basic","DobasInput","onChange","setDie","addPlus","ButtonGroup","fluid","labelPosition","Button","onClick","NumberInput","min","icons","style","whiteSpace","Icon","compact","margin","width","e","newValue","target","test","num","parseInt","DobasMatrixDisplay","matrix","keyMap","direction","title","editable","setValue","numberOnly","displayCell","constantRoll","rollString","includes","Table","Cell","collapsing","v","String","celled","striped","Header","Row","HeaderCell","disabled","Body","Footer","definition","PointsTable","points","p","label","Selection","selected","setSelected","options","structure","as","fk","Group","vertical","tag","o","n","i","active","KarakterAlkotasBackground","fajNevek","backgroundSelection","setBackgroundSelection","Input","placeholder","error","s","JSON","parse","stringify","faj","require","default","calculateKepessegek","fajok","newMatrix","KarakterAlkotas","save","useState","setMatrix","useEffect","Grid","relaxed","GridRow","columns","divided","GridColumn","floated","allowEmptyValue","stepAmount","minValue","maxValue","intValue","textAlign","secondary","primary","kar","version","id","v4","categories","createKarakter","FegyverLista","onSelectionChange","extraButton","fegyverLista","rec","selectable","colspan","IntegerInput","mandatory","convertToFormValues","lofegyver","convertFromFormValues","FegyverEditor","submit","cancel","form","setForm","Checkbox","fitted","toggle","checked","FegyverValaszto","saveFegyverek","selectedForDeletion","setSelectedForDeletion","editorOpen","setEditorOpen","listEditorOpen","setListEditorOpen","saveSelection","useCallback","kepzettsegSzint","addFegyverAndKepzettseg","saveDeletion","f","Modal","trigger","onOpen","onClose","open","Content","push","negative","sort","localeCompare","idx","fIdx","findIndex","kepzettsegName","kp","HMEloszto","complete","current","setCurrent","change","he","newCurrent","colSpan","padding","circular","icon","content","KepzettsegModal","modalOpen","setModalOpen","setKepzettseg","setSzint","setKp","marginBottom","marginLeft","newKepzettseg","compare","KepzettsegLista","splice","PancelLista","sfe","PancelEditor","PancelValaszto","savePancelok","some","every","Pajzsok","asztral","termeszetes","mental","statikus","dinamikus","Jegyzetek","borderRadius","height","jegyzetek","EditableText","forwardRef","ref","text","editedText","setEditedText","edited","setEdited","useImperativeHandle","edit","onSubmit","transparent","autoFocus","onBlur","Felszereles","rowRefs","felszereles","qty","q","KategoriaEditor","kategoriak","setKategoriak","ujKategoria","setUjKategoria","list","c","KarakterTabla","clone","remove","torlesKerdes","setTorlesKerdes","Confirm","onCancel","onConfirm","header","cancelButton","confirmButton","fileDownload","Karakterlap","pszi","mp","kepessegMatrix","masodlagosFegyverMutat","PANCELOK","PREFIX","STORY_KEY","CategoriesDropdown","currentCategory","setCurrentCategory","Dropdown","item","Menu","Item","DragAndDrop","state","drag","dropRef","React","createRef","dragCounter","handleDrag","preventDefault","stopPropagation","handleDragIn","dataTransfer","items","length","setState","handleDragOut","handleDrop","files","props","clearData","addEventListener","removeEventListener","display","position","dragPlaceholder","children","Component","KarakterImport","saveMese","l","mese","endsWith","Slider","DICE_ROLLS","PLUS","MERETEK","MOZGASOK","VISZONYOK","Kockadobo","input","setInput","setResult","useReducer","prev","elem","slice","HISTORY_LENGTH","history","addToHistory","tavolsag","meret","mozgas","viszonyok","lofegyverVedo","setLofegyverVedo","dob","setKocka","diceRoll","setPlus","className","floating","reverse","h","settings","step","KockaModal","kockaOpen","setKockaOpen","MAX_KARAKTERS_PER_PAGE","PageHeader","karakterek","page","setPage","karakterStart","setKarakterStart","karakterPos","scrolled","canScrollLeft","canScrollRight","karaktersDisplayed","tabular","Image","src","logo","flexGrow","category","SzituacioSelector","setSzituaciok","szituacioOptions","nev","multiple","simple","renderLabel","KombatCard","dobasEredmeny","setDobasEredmeny","harcertekMatrix","sebzesRoll","rolls","Error","sumRolls","rollKe","rollTe","rollCe","rollSebzes","cellContents","Card","backgroundColor","hatrany","headerColour","Description","singleLine","fegyverCsere","m","extra","Kombat","dobasEredmenyek","setDobasEredmenyek","refs","DobasButton","rollFn","uj","flexDirection","flexWrap","alignItems","one","two","oneKe","order","createContextFromEvent","left","clientX","top","clientY","right","bottom","getBoundingClientRect","ContextMenu","onClicked","event","contextRef","useRef","setOpen","close","onContextMenu","Popup","context","onItemClick","data","SceneListContextMenu","onSelected","findElements","root","elements","ch","concat","addChild","parent","referenceSibling","insert","newElement","type","$parent","addChildElement","child","insertIndex","referenceIndex","deleteChild","deleteIndex","attr","attributes","t","join","DomUtils","addText","previousSibling","childText","findById","found","findElementsByName","findReferences","str","xml2js","nativeType","trim","addParent","parentKey","convertLegacyLinks","split","events","print","js2xml","CommentEditorModal","addComment","kommentModal","setKommentModal","editedKomment","setEditedKomment","CommentList","comments","deleteComment","renderer","hoverable","List","wide","renderElement","ROLE_ICONS","iconForRole","role","StoryEvent","commentUtils","onEdit","status","setActive","justifyContent","borderTop","borderBottom","onMouseEnter","onMouseLeave","listStyle","cursor","comment","createSelection","start","end","SelectionState","createEmpty","getLastBlock","getKey","merge","anchorOffset","focusOffset","addEntityToSelection","selection","console","log","entityKey","createEntity","getLastCreatedEntityKey","Modifier","applyEntity","addEntity","addBlock","block","ContentBlock","genKey","blockMap","getBlockMap","toOrderedMap","EditorUtils","processElement","contentsOnly","insertText","len","getLength","lastPos","getBlocksAsArray","getText","findEntityRanges","getEntityAt","textNode","substring","entity","getEntity","getType","getData","blockToElement","EditingButtons","editorState","setEditorState","editorPopup","setEditorPopup","editedValue","setEditedValue","addTag","attrs","getSelection","newContent","getCurrentContent","EditorState","search","scene","description","EditableNode","create","readOnly","setTimeout","onFinished","EventRenderer","switchToScene","JumpRenderer","LanguageRenderer","level","ParagraphRenderer","RewardRenderer","RollRenderer","SettingRenderer","window","STORY_TAG_ICONS","setting","reward","character","jump","StoryElement","contents","targetElem","targetIcon","StoryCard","TableRow","CharacterCard","NestedTableRow","elems","first","rest","rowSpan","structured","ItemCard","StoryCards","cards","CardGroup","itemsPerRow","raised","Meta","RenderUtils","switchScene","renderCards","IconComponent","offsetKey","contentState","fontWeight","data-offset-key","EventRowSelector","onRoleSelected","labeled","toElements","EventEditor","eventEdited","eventRole","setEventRole","eventDate","setEventDate","onEscape","ContentState","createFromBlockArray","inlineDecorator","CompositeDecorator","strategy","callback","_state","component","createWithContent","Segment","keyBindingFn","getDefaultKeyBinding","handleKeyCommand","EventEditorModal","editedEvent","onEditingFinished","anchor","Timeline","orderedEvents","date","heights","fill","unitHeight","TimelineUnit","crossbar","flexBasis","zIndex","pinned","border","boxShadow","StoryContextMenu","setEditedEvent","operation","ensureComments","story","ensureEventId","CommentUtils","eventId","lastComment","pop","findComments","StoryScene","contextMenu","setContextMenu","displayMode","setDisplayMode","StoryPage","saveStory","activeScene","setActiveScene","storyOb","scenes","sceneTabs","menuItem","render","Tab","Pane","characters","activeIndex","onTabChange","panes","App","operations","setOperations","fetch","localStorage","getItem","put","ob","setItem","all","startsWith","cat","load","info","maxEp","maxFp","exportMagus","importMagus","flatMap","newNev","removeItem","listFajok","listFegyverek","CONFIG_PREFIX","listPancelok","loadStory","useDataConnector","saveKarakter","removeKarakter","ps","renderPage","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.9d442e7b.chunk.js","sourcesContent":["export interface DiceRoll {\n    tries: number;\n    numDice: number;\n    die: number;\n    plus: number;\n    div: number;\n    kf: boolean;\n}\n\nexport interface DiceRollResult {\n    value: number;\n    details: string;\n}\n\nconst PATTERN = /(?<numDice>\\d+)?k(?<die>\\d+)(?:\\/(?<div>\\d+))?(?<plus>[+-]\\d+)?(?:\\((?<tries>\\d+)x\\))?(?:\\+kf(?<kf>))?/;\n\nlet random = Math.random;\n\nconst _roll = (dice: DiceRoll, ijasz: boolean): DiceRollResult => {\n    let result = [...Array(dice.tries).keys()].map(_ => rollDice(dice, ijasz)).reduce((acc, curr) => ({ value: Math.max(acc.value, curr.value), details: `${acc.details ? acc.details + ' or ' : ''}(${curr.details})` }), { value: 0, details: '' });\n    result = {\n        value: result.value + dice.plus,\n        details: `${result.details}${dice.plus > 0 ? ' + ' + dice.plus : (dice.plus < 0 ? ' - ' + Math.abs(dice.plus) : '')}`\n    };\n    if (dice.kf) {\n        return rollKf(dice, result);\n    } else {\n        return result;\n    }\n\n}\n\nconst rollDice = (dice: DiceRoll, ijasz: boolean): DiceRollResult => {\n    return [...Array(dice.numDice).keys()].map(_ => rollSingle(dice, ijasz)).reduce((acc, curr) => ({ value: acc.value + curr, details: `${acc.details ? acc.details + '+' : ''}${curr}` }), { value: 0, details: '' });\n}\n\nconst rollSingle = (dice: DiceRoll, ijasz: boolean): number => {\n    let res = 0;\n    let curr = 0;\n    do {\n        curr = 1 + Math.floor(random() * dice.die);\n        res += Math.ceil(curr / dice.div);\n    } while (ijasz && curr === dice.die)\n    return res;\n}\n\nconst rollKf = (dice: DiceRoll, result: DiceRollResult): DiceRollResult => {\n    const max = dice.numDice * Math.floor(dice.die / dice.div) + dice.plus;\n    if (result.value === max) {\n        let kfMod;\n        const kf = roll('k100').value;\n        if (kf <= 20) {\n            kfMod = -roll('k6').value;\n        } else if (kf <= 50) {\n            kfMod = -1;\n        } else if (kf <= 75) {\n            kfMod = 0;\n        } else if (kf <= 95) {\n            kfMod = 1;\n        } else {\n            kfMod = 2;\n        }\n        return {\n            value: result.value + kfMod,\n            details: `${result.details} (kf: ${kf} / ${kfMod})`\n        }\n    } else {\n        return result;\n    }\n\n}\n\nexport const roll = (dice: DiceRoll | string, ijasz?: boolean): DiceRollResult => _roll(typeof dice === 'string' ? parseDiceRoll(dice) : dice, !!ijasz);\n\nexport const rollSource = (randomFn: () => number): void => { random = randomFn }\n\nexport const parseDiceRoll = (diceString: string = '0'): DiceRoll => {\n    if (!Number.isNaN(Number(diceString))) {\n        return {\n            numDice: 0,\n            die: 0,\n            plus: Number(diceString),\n            tries: 1,\n            div: 1,\n            kf: false\n        };\n    }\n    const res = diceString.replace(/\\s/g, '').match(PATTERN);\n    return {\n        numDice: Number(res?.groups?.numDice ?? 1),\n        die: Number(res?.groups?.die ?? 0),\n        plus: Number(res?.groups?.plus ?? 0),\n        tries: Number(res?.groups?.tries ?? 1),\n        div: Number(res?.groups?.div ?? 1),\n        kf: res?.groups?.kf !== undefined\n    }\n}\n\nexport const formatDiceRoll = (dice: DiceRoll): string => {\n    if (dice.die === 0) {\n        return dice.plus ? `${dice.plus}` : '-';\n    };\n    return `${dice.numDice === 1 ? '' : dice.numDice}k${dice.die}${dice.div > 1 ? '/' + dice.div : ''}${dice.plus ? (dice.plus > 0 ? '+' : '-') + Math.abs(dice.plus) : ''}${dice.tries > 1 ? '(' + dice.tries + 'x)' : ''}${dice.kf ? ' + kf' : ''}`;\n}\n\nexport const formatResult = (result: DiceRollResult): string => {\n    return `${result.value} (${result.details})`\n}\n\nexport const sumRolls = (rolls: Array<DiceRoll>): DiceRoll | null => {\n    try {\n        const ret: DiceRoll = parseDiceRoll();\n        rolls.forEach(r => {\n            if (r.tries > 1 || r.kf) {\n                throw new Error('can\\'t sum rolls with multiple tries or kf');\n            }\n            if (ret.die !== 0 && r.die !== 0 && r.die !== ret.die) {\n                throw new Error('can\\'t sum rolls with different dies');\n            }\n            if (ret.div !== 1 && r.div !== 1 && ret.div !== r.div) {\n                throw new Error('can\\'t sum rolls with different divisors');\n            }\n            if (r.die !== 0) {\n                ret.die = r.die;\n                ret.numDice += r.numDice;\n            }\n            if (r.plus !== 0) {\n                ret.plus += r.plus;\n            }\n            if (r.div > 1) {\n                ret.div = r.div;\n            }\n        })\n        return ret;\n    } catch (e) { }\n    return null;\n}","import { DiceRoll, DiceRollResult, parseDiceRoll, roll } from \"./roll\";\n\nexport interface Dobas {\n    roll: DiceRoll;\n    result?: DiceRollResult;\n}\n\nexport class DobasMatrix {\n    readonly values: Record<string, Record<string, Dobas>>;\n    readonly sum: Record<string, number>;\n\n    constructor(readonly keys: Array<string>) {\n        this.values = {};\n        this.sum = {};\n    }\n\n    add = (name: string, dobas: Record<string, string | number>): DobasMatrix => {\n        this.values[name] = {};\n        if (dobas) {\n            this.keys.forEach(key => {\n                this.values[name][key] = {\n                    roll: parseDiceRoll(dobas[key]?.toString())\n                }\n            });\n        }\n        return this;\n    };\n\n    roll = (keys?: Array<string>): DobasMatrix => {\n        this.keys.filter(key => !keys || keys.indexOf(key) !== -1).forEach(key => {\n            Object.keys(this.values).forEach(name => {\n                const dobas = this.values[name][key];\n                dobas.result = dobas ? roll(dobas.roll) : { value: 0, details: '' };\n                this.sum[key] = Object.values(this.values).map(value => value[key].result?.value).reduce((a, b) => (a ?? 0) + (b ?? 0), 0) ?? 0;\n            });\n        })\n        return this;\n    }\n\n    getRolls = (key: string): Array<DiceRoll> => {\n        return Object.values(this.values).map(r => r[key].roll).filter(roll => roll && (roll.die > 0 || roll.plus !== 0));\n    }\n\n    clearRolls = (): DobasMatrix => {\n        this.keys.forEach(key => {\n            Object.keys(this.values).forEach(name => {\n                const dobas = this.values[name][key];\n                delete dobas.result;\n            });\n        });\n        return this;\n    }\n}\n\n","//todo: ugras\n\nimport { Fegyver } from \"./karakter\";\n\nexport interface Harcertek {\n    ke: number;\n    te: number;\n    ve: number;\n    ce: number;\n}\n\nexport type fegyverTipus = 'kozelharc' | 'lofegyver' | 'pajzs' | 'kl';\n\nexport const HARCERTEK_DISPLAY_NAMES = { 'ke': 'K', 'te': 'T', 've': 'V', 'ce': 'C', 'sebzes': 'Sebzs' };\n\nexport const FEGYVER_KEPZETTSEG: Record<string, Harcertek> = {\n    \"kpzetlen\": {\n        ke: -10,\n        te: -25,\n        ve: -20,\n        ce: -30\n    },\n    \"kpzetlen, fejvadsz\": {\n        ke: -5,\n        te: -5,\n        ve: -10,\n        ce: -15\n    },\n    \"Af\": {\n        ke: 0,\n        te: 0,\n        ve: 0,\n        ce: 0\n    },\n    \"Mf\": {\n        ke: 5,\n        te: 10,\n        ve: 10,\n        ce: 10\n    }\n}\n\nexport const FEGYVERTELEN: Fegyver = {\n    name: 'fegyver nlkl',\n    harcertek: {\n        ke: 0,\n        te: 0,\n        ve: 0,\n        ce: 0,\n    },\n    tamPerKor: 0,\n    sebzes: '0'\n};\n\n\nexport const PUSZTA_KEZ_AF: Fegyver = {\n    name: 'kl',\n    harcertek: {\n        ke: 4,\n        te: 1,\n        ve: 10,\n        ce: 0,\n    },\n    tamPerKor: 2,\n    sebzes: '1k2'\n}\n\nexport const PUSZTA_KEZ_MF: Fegyver = {\n    name: 'kl',\n    harcertek: {\n        ke: 4,\n        te: 1,\n        ve: 10,\n        ce: 0,\n    },\n    tamPerKor: 2,\n    sebzes: '1k6'\n}\n\nexport const FEGYVEREK: Array<Fegyver> = [\n    {\n        name: 'Tr',\n        harcertek: {\n            ke: 10,\n            te: 8,\n            ve: 2,\n            ce: 0,\n        },\n        sebzes: '1k6',\n        tamPerKor: 2\n    },\n    {\n        name: 'Tr, dob',\n        harcertek: {\n            ke: 10,\n            te: 11,\n            ve: 2,\n            ce: 0,\n        },\n        sebzes: '1k6',\n        tamPerKor: 2\n    },\n    {\n        name: 'Tsks buzogny',\n        harcertek: {\n            ke: 7,\n            te: 12,\n            ve: 13,\n            ce: 0,\n        },\n        sebzes: '1k6+2',\n        tamPerKor: 1\n    },\n    {\n        name: 'Hajtbrd',\n        harcertek: {\n            ke: 9,\n            te: 10,\n            ve: 4,\n            ce: 0,\n        },\n        sebzes: '1k6',\n        tamPerKor: 2\n    },\n    {\n        name: 'Dobhl',\n        harcertek: {\n            ke: 1,\n            te: 8,\n            ve: 4,\n            ce: 0,\n        },\n        sebzes: '0',\n        tamPerKor: 3,\n        lassu: true\n    },\n    {\n        name: 'Buzogny, shadleki',\n        harcertek: {\n            ke: 8,\n            te: 13,\n            ve: 14,\n            ce: 0,\n        },\n        sebzes: '1k6+1',\n        tamPerKor: 1\n    },\n    {\n        name: 'Csatabrd, egykezes',\n        harcertek: {\n            ke: 5,\n            te: 12,\n            ve: 11,\n            ce: 0,\n        },\n        sebzes: '1k10',\n        tamPerKor: 1\n    },\n    {\n        name: 'Csatabrd, ktkezes',\n        harcertek: {\n            ke: 0,\n            te: 8,\n            ve: 6,\n            ce: 0,\n        },\n        sebzes: '3k6',\n        tamPerKor: 2,\n        lassu: true\n    },\n    {\n        name: 'Csatacskny',\n        harcertek: {\n            ke: 5,\n            te: 11,\n            ve: 8,\n            ce: 0,\n        },\n        sebzes: '1k10',\n        tamPerKor: 1\n    },\n    {\n        name: 'Kard, rvid',\n        harcertek: {\n            ke: 9,\n            te: 12,\n            ve: 14,\n            ce: 0,\n        },\n        sebzes: '1k6+1',\n        tamPerKor: 1\n    },\n    {\n        name: 'Kard, hossz',\n        harcertek: {\n            ke: 6,\n            te: 14,\n            ve: 16,\n            ce: 0,\n        },\n        sebzes: '1k10',\n        tamPerKor: 1\n    },\n    {\n        name: 'Kard, msflkezes',\n        harcertek: {\n            ke: 4,\n            te: 13,\n            ve: 12,\n            ce: 0,\n        },\n        sebzes: '2k6',\n        tamPerKor: 1\n    },\n    {\n        name: 'Kard, lovagi',\n        harcertek: {\n            ke: 2,\n            te: 10,\n            ve: 7,\n            ce: 0,\n        },\n        sebzes: '2k6+2',\n        tamPerKor: 1\n    },\n    {\n        name: 'Kard, pallos',\n        harcertek: {\n            ke: 0,\n            te: 6,\n            ve: 2,\n            ce: 0,\n        },\n        sebzes: '3k6+2',\n        tamPerKor: 2,\n        lassu: true\n    },\n    {\n        name: 'Kard, szablya',\n        harcertek: {\n            ke: 7,\n            te: 15,\n            ve: 17,\n            ce: 0,\n        },\n        sebzes: '1k6+2',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Kard, dzsenn szablya',\n        harcertek: {\n            ke: 9,\n            te: 20,\n            ve: 17,\n            ce: 0,\n        },\n        sebzes: '1k6+3',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Kard, jatagn',\n        harcertek: {\n            ke: 7,\n            te: 14,\n            ve: 14,\n            ce: 0,\n        },\n        sebzes: '1k6+2',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Kard, handzsr',\n        harcertek: {\n            ke: 6,\n            te: 14,\n            ve: 15,\n            ce: 0,\n        },\n        sebzes: '1k6+3',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Kard, fejvadsz',\n        harcertek: {\n            ke: 8,\n            te: 16,\n            ve: 16,\n            ce: 0,\n        },\n        sebzes: '1k6+2',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Kard, Slan',\n        harcertek: {\n            ke: 8,\n            te: 20,\n            ve: 12,\n            ce: 0,\n        },\n        sebzes: '1k10+2',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Kard, kgy',\n        harcertek: {\n            ke: 6,\n            te: 14,\n            ve: 15,\n            ce: 0,\n        },\n        sebzes: '1k10',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Ks',\n        harcertek: {\n            ke: 10,\n            te: 4,\n            ve: 0,\n            ce: 0,\n        },\n        sebzes: '1k5',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Mara-sequor',\n        harcertek: {\n            ke: 7,\n            te: 16,\n            ve: 14,\n            ce: 0,\n        },\n        sebzes: '2k6+2',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Ramiera',\n        harcertek: {\n            ke: 8,\n            te: 17,\n            ve: 14,\n            ce: 0,\n        },\n        sebzes: '1k6+1',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Sequor',\n        harcertek: {\n            ke: 8,\n            te: 16,\n            ve: 13,\n            ce: 0,\n        },\n        sebzes: '1k6+2',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Slan csillag',\n        harcertek: {\n            ke: 10,\n            te: 4,\n            ve: 0,\n            ce: 0,\n        },\n        sebzes: '1k3',\n        tamPerKor: 3,\n    },\n    {\n        name: 'Tr, Slan',\n        harcertek: {\n            ke: 9,\n            te: 14,\n            ve: 6,\n            ce: 0,\n        },\n        sebzes: '1k6+2',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Trkard',\n        harcertek: {\n            ke: 9,\n            te: 12,\n            ve: 14,\n            ce: 0,\n        },\n        sebzes: '1k6+2',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Bot, hossz',\n        harcertek: {\n            ke: 4,\n            te: 10,\n            ve: 16,\n            ce: 0,\n        },\n        sebzes: '1k5',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Bot, rvid',\n        harcertek: {\n            ke: 9,\n            te: 9,\n            ve: 17,\n            ce: 0,\n        },\n        sebzes: '1k3',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Bot, furks',\n        harcertek: {\n            ke: 2,\n            te: 7,\n            ve: 14,\n            ce: 0,\n        },\n        sebzes: '1k6',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Buzogny, egykezes',\n        harcertek: {\n            ke: 7,\n            te: 11,\n            ve: 12,\n            ce: 0,\n        },\n        sebzes: '1k6',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Buzogny, ktkezes',\n        harcertek: {\n            ke: 0,\n            te: 7,\n            ve: 6,\n            ce: 0,\n        },\n        sebzes: '3k6',\n        tamPerKor: 2,\n        lassu: true\n    },\n    {\n        name: 'Buzogny, tsks',\n        harcertek: {\n            ke: 7,\n            te: 12,\n            ve: 13,\n            ce: 0,\n        },\n        sebzes: '1k6+2',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Buzogny, tollas',\n        harcertek: {\n            ke: 7,\n            te: 12,\n            ve: 13,\n            ce: 0,\n        },\n        sebzes: '1k6+1',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Buzogny, lncos',\n        harcertek: {\n            ke: 4,\n            te: 13,\n            ve: 11,\n            ce: 0,\n        },\n        sebzes: '1k6+3',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Csphadar',\n        harcertek: {\n            ke: 1,\n            te: 6,\n            ve: 5,\n            ce: 0,\n        },\n        sebzes: '1k6+1',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Harcikalapcs',\n        harcertek: {\n            ke: 5,\n            te: 8,\n            ve: 10,\n            ce: 0,\n        },\n        sebzes: '1k6+2',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Alabrd',\n        harcertek: {\n            ke: 1,\n            te: 14,\n            ve: 15,\n            ce: 0,\n        },\n        sebzes: '2k6+2',\n        tamPerKor: 2,\n        lassu: true\n    },\n    {\n        name: 'Drda',\n        harcertek: {\n            ke: 8,\n            te: 13,\n            ve: 5,\n            ce: 0,\n        },\n        sebzes: '1k6+1',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Kopja, knny',\n        harcertek: {\n            ke: 2,\n            te: 11,\n            ve: 12,\n            ce: 0,\n        },\n        sebzes: '1k10',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Kopja, lovas',\n        harcertek: {\n            ke: 1,\n            te: 15,\n            ve: 0,\n            ce: 0,\n        },\n        sebzes: '1k6',\n        tamPerKor: 2,\n        lassu: true\n    },\n    {\n        name: 'Kopja, nehzlovas',\n        harcertek: {\n            ke: 0,\n            te: 16,\n            ve: 0,\n            ce: 0,\n        },\n        sebzes: '2k10',\n        tamPerKor: 3,\n        lassu: true\n    },\n    {\n        name: 'Lndzsa',\n        harcertek: {\n            ke: 4,\n            te: 12,\n            ve: 12,\n            ce: 0,\n        },\n        sebzes: '1k10',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Szigony',\n        harcertek: {\n            ke: 4,\n            te: 15,\n            ve: 10,\n            ce: 0,\n        },\n        sebzes: '1k10+1',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Fvcs',\n        harcertek: {\n            ke: 8,\n            te: 0,\n            ve: 0,\n            ce: 7,\n        },\n        lotav: 30,\n        sebzes: '0',\n        tamPerKor: 3,\n    },\n    {\n        name: 'j, rvid',\n        harcertek: {\n            ke: 5,\n            te: 0,\n            ve: 0,\n            ce: 4,\n        },\n        lotav: 90,\n        sebzes: '1k6',\n        tamPerKor: 2,\n    },\n    {\n        name: 'j, hossz',\n        harcertek: {\n            ke: 4,\n            te: 0,\n            ve: 0,\n            ce: 6,\n        },\n        lotav: 110,\n        sebzes: '1k6+1',\n        tamPerKor: 2,\n    },\n    {\n        name: 'j, visszacsap',\n        harcertek: {\n            ke: 3,\n            te: 0,\n            ve: 0,\n            ce: 8,\n        },\n        lotav: 180,\n        sebzes: '1k10',\n        tamPerKor: 2,\n    },\n    {\n        name: 'j, elf',\n        harcertek: {\n            ke: 6,\n            te: 0,\n            ve: 0,\n            ce: 10,\n        },\n        lotav: 120,\n        sebzes: '2k6',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Nylpuska, aquir',\n        harcertek: {\n            ke: 5,\n            te: 0,\n            ve: 0,\n            ce: 18,\n        },\n        lotav: 35,\n        sebzes: '1k10/2',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Nylpuska, kzi',\n        harcertek: {\n            ke: 3,\n            te: 0,\n            ve: 0,\n            ce: 14,\n        },\n        lotav: 30,\n        sebzes: '1k6/2',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Nylpuska, kahrei',\n        harcertek: {\n            ke: 9,\n            te: 0,\n            ve: 0,\n            ce: 13,\n        },\n        lotav: 30,\n        sebzes: '1k6/2',\n        tamPerKor: 3,\n    },\n    {\n        name: 'Nylpuska, knny',\n        harcertek: {\n            ke: 2,\n            te: 0,\n            ve: 0,\n            ce: 16,\n        },\n        lotav: 50,\n        sebzes: '1k6+1',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Nylpuska, nehz',\n        harcertek: {\n            ke: 0,\n            te: 0,\n            ve: 0,\n            ce: 15,\n        },\n        lotav: 60,\n        sebzes: '1k6+1',\n        tamPerKor: 3,\n        lassu: true\n    },\n    {\n        name: 'Nylpuska, shadoni pncltr',\n        harcertek: {\n            ke: 0,\n            te: 0,\n            ve: 0,\n            ce: 17,\n        },\n        lotav: 80,\n        sebzes: '2k10',\n        tamPerKor: 5,\n        lassu: true\n    },\n    {\n        name: 'Parittya',\n        harcertek: {\n            ke: 2,\n            te: 0,\n            ve: 0,\n            ce: 1,\n        },\n        lotav: 100,\n        sebzes: '1k10/2',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Bola',\n        harcertek: {\n            ke: 2,\n            te: 10,\n            ve: 2,\n            ce: 0,\n        },\n        sebzes: '1k5',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Dobhl',\n        harcertek: {\n            ke: 1,\n            te: 8,\n            ve: 4,\n            ce: 0,\n        },\n        sebzes: '0',\n        tamPerKor: 3,\n        lassu: true\n    },\n    {\n        name: 'Garott',\n        harcertek: {\n            ke: 0,\n            te: 5,\n            ve: -20,\n            ce: 0,\n        },\n        sebzes: '1k10',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Hrttr',\n        harcertek: {\n            ke: 8,\n            te: 4,\n            ve: 19,\n            ce: 0,\n        },\n        sebzes: '1k6',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Korbcs',\n        harcertek: {\n            ke: 4,\n            te: 0,\n            ve: 6,\n            ce: 0,\n        },\n        sebzes: '1k3',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Lassz',\n        harcertek: {\n            ke: 0,\n            te: 1,\n            ve: 0,\n            ce: 0,\n        },\n        sebzes: '0',\n        tamPerKor: 3,\n        lassu: true\n    },\n    {\n        name: 'Ostor',\n        harcertek: {\n            ke: 3,\n            te: 6,\n            ve: 0,\n            ce: 0,\n        },\n        sebzes: '1k2',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Vaskl',\n        harcertek: {\n            ke: 9,\n            te: 2,\n            ve: 5,\n            ce: 0,\n        },\n        sebzes: '1k3',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Dzsambia',\n        harcertek: {\n            ke: 10,\n            te: 8,\n            ve: 4,\n            ce: 0,\n        },\n        sebzes: '1k6',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Mesterkard',\n        harcertek: {\n            ke: 7,\n            te: 16,\n            ve: 14,\n            ce: 0,\n        },\n        sebzes: '1k10',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Predoci egyeneskard',\n        harcertek: {\n            ke: 7,\n            te: 16,\n            ve: 15,\n            ce: 0,\n        },\n        sebzes: '1k10',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Tahdzsi',\n        harcertek: {\n            ke: 9,\n            te: 11,\n            ve: 14,\n            ce: 0,\n        },\n        sebzes: '1k6+1',\n        tamPerKor: 1,\n    },\n    {\n        name: 'Bltp',\n        harcertek: {\n            ke: 10,\n            te: 8,\n            ve: 2,\n            ce: 0,\n        },\n        sebzes: '1k6+2',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Lagoss',\n        harcertek: {\n            ke: 8,\n            te: 14,\n            ve: 14,\n            ce: 0,\n        },\n        sebzes: '1k6+4',\n        tamPerKor: 2,\n    },\n    {\n        name: 'Pugoss',\n        harcertek: {\n            ke: 12,\n            te: 6,\n            ve: 4,\n            ce: 0,\n        },\n        sebzes: '1k6',\n        tamPerKor: 2,\n    },\n];\n\nexport const SZITUACIOK: Record<string, Harcertek> = {\n    'htulrl': {\n        ke: 5,\n        te: 10,\n        ve: 0,\n        ce: 0\n    },\n    'flhtulrl': {\n        ke: 2,\n        te: 5,\n        ve: 0,\n        ce: 0\n    },\n    'magasabbrl': {\n        ke: 2,\n        te: 5,\n        ve: 0,\n        ce: 5\n    },\n    'alacsonyabbrl': {\n        ke: -2,\n        te: -10,\n        ve: 0,\n        ce: -5\n    },\n    'meglepetsbl': {\n        ke: 100,\n        te: 30,\n        ve: 0,\n        ce: 10\n    },\n    'mozg lrl': {\n        ke: 5,\n        te: 10,\n        ve: 20,\n        ce: -20\n    },\n    'vakon': {\n        ke: -20,\n        te: -60,\n        ve: -70,\n        ce: -150\n    },\n    'flhomlyban': {\n        ke: -10,\n        te: -30,\n        ve: -35,\n        ce: -70\n    },\n    'helyhez ktve': {\n        ke: -20,\n        te: -15,\n        ve: -5,\n        ce: 0\n    },\n    'kbultan': {\n        ke: -15,\n        te: -20,\n        ve: -25,\n        ce: -30\n    },\n    'bnultan': {\n        ke: -30,\n        te: -40,\n        ve: -35,\n        ce: -15\n    },\n    'flelemmel': {\n        ke: -10,\n        te: -15,\n        ve: 5,\n        ce: -20\n    },\n    'gyllettel': {\n        ke: 3,\n        te: 10,\n        ve: -20,\n        ce: -20\n    },\n    'roham': {\n        ke: 0,\n        te: 20,\n        ve: -25,\n        ce: -30\n    },\n    'vdharc htrlva': {\n        ke: 0,\n        te: 0,\n        ve: 40,\n        ce: 0\n    },\n    'vdharc llva': {\n        ke: 0,\n        te: 0,\n        ve: 25,\n        ce: 0\n    },\n    'rszleges vdharc': {\n        ke: 0,\n        te: 0,\n        ve: 15,\n        ce: 0\n    },\n    'foglyul ejtsrt': {\n        ke: -5,\n        te: -5,\n        ve: -15,\n        ce: 0\n    },\n}\n\nconst tipus = (fegyver?: Fegyver): fegyverTipus | undefined => {\n    if (!fegyver || fegyver.name === FEGYVERTELEN.name) {\n        return undefined;\n    }\n    if (fegyver.harcertek.ce > 0) {\n        return 'lofegyver';\n    }\n    if (fegyver.name.toLowerCase() === 'kl') {\n        return 'kl';\n    }\n    if (fegyver.pajzs) {\n        return 'pajzs';\n    }\n    return 'kozelharc';\n}\n\nconst kepzettseg = (fegyver: Fegyver, dobas?: boolean): string => {\n    if (fegyver.name.toLowerCase() === 'kl') {\n        return 'klharc';\n    }\n    if (dobas) {\n        return 'Fegyverdobs - ' + fegyver.name.toLowerCase();\n    } else {\n        return 'Fegyverhasznlat - ' + fegyver.name.toLowerCase();\n    }\n}\n\nexport const FegyverUtils = {\n    tipus,\n    kepzettseg\n}\n\n","import { Harcertek } from \"./harc\";\nimport { DiceRollResult } from \"./roll\"\n\nexport interface KepessegDobas {\n    ero: string;\n    gy: string;\n    ugy: string;\n    ak: string;\n    egs: string;\n    sz: string;\n    int: string;\n    ae: string;\n    asz: string;\n    erz: string;\n}\n\nexport type KepessegDobasResult = Record<keyof KepessegDobas, DiceRollResult>;\n\nexport const KEPESSEG_NEV: Record<keyof KepessegDobas, string> = {\n    ero: 'Er',\n    gy: 'Gyorsasg',\n    ugy: 'gyessg',\n    ak: 'llkpessg',\n    egs: 'Egszsg',\n    sz: 'Szpsg',\n    int: 'Intelligencia',\n    ae: 'Akarater',\n    asz: 'Asztrl',\n    erz: 'rzkels'\n}\n\nexport const FAJ_KEPESSEG: Record<string, KepessegDobas> = {\n    \"ember\": {\n        ero: '0',\n        gy: '0',\n        ugy: '0',\n        ak: '0',\n        egs: '0',\n        sz: '0',\n        int: '0',\n        ae: '0',\n        asz: '0',\n        erz: '0'\n    },\n    \"elf\": {\n        ero: '-2',\n        gy: '1',\n        ugy: '1',\n        ak: '-1',\n        egs: '0',\n        sz: '1',\n        int: '0',\n        ae: '0',\n        asz: '0',\n        erz: '2'\n    },\n    \"flelf\": {\n        ero: '-1',\n        gy: '1',\n        ugy: '0',\n        ak: '0',\n        egs: '0',\n        sz: '0',\n        int: '0',\n        ae: '0',\n        asz: '0',\n        erz: '1'\n    },\n    \"trp\": {\n        ero: '1',\n        gy: '1',\n        ugy: '0',\n        ak: '1',\n        egs: '1',\n        sz: '-2',\n        int: '-1',\n        ae: '0',\n        asz: '-1',\n        erz: '0'\n    },\n    \"udvari ork\": {\n        ero: '2',\n        gy: '0',\n        ugy: '0',\n        ak: '1',\n        egs: '2',\n        sz: '-3',\n        int: '-1',\n        ae: '0',\n        asz: '-3',\n        erz: '1'\n    },\n    \"amund\": {\n        ero: '1',\n        gy: '0',\n        ugy: '0',\n        ak: '1',\n        egs: '0',\n        sz: '3',\n        int: '0',\n        ae: '0',\n        asz: '-1',\n        erz: '0'\n    },\n    \"dzsenn\": {\n        ero: '0',\n        gy: '0',\n        ugy: '0',\n        ak: '0',\n        egs: '0',\n        sz: '0',\n        int: '2',\n        ae: '0',\n        asz: '0',\n        erz: '0'\n    },\n    \"khl\": {\n        ero: '3',\n        gy: '2',\n        ugy: '1',\n        ak: '2',\n        egs: '3',\n        sz: '0',\n        int: '-1',\n        ae: '0',\n        asz: '-5',\n        erz: '3'\n    },\n    \"gnm\": {\n        ero: '-1',\n        gy: '0',\n        ugy: '1',\n        ak: '0',\n        egs: '0',\n        sz: '0',\n        int: '1',\n        ae: '0',\n        asz: '0',\n        erz: '2'\n    },\n    \"goblin\": {\n        ero: '-2',\n        gy: '0',\n        ugy: '0',\n        ak: '1',\n        egs: '1',\n        sz: '-2',\n        int: '-1',\n        ae: '0',\n        asz: '-2',\n        erz: '2'\n    },\n\n}\n\nexport const FOKASZTOK: Record<string, Array<string>> = {\n    'harcos': ['harcos', 'gladitor', 'fejvadsz', 'lovag'],\n    'szerencsevadsz': ['tolvaj', 'brd'],\n    'pap': ['pap', 'paplovag'],\n    'harcmvsz': ['harcmvsz', 'kardmvsz'],\n    'varzsl': ['boszorknymester', 'tzvarzsl', 'varzsl'],\n    'egyb': ['egyb']\n};\n\nexport const KASZTOK: Record<string, Kaszt> = {\n    'egyb': {\n        name: 'egyb',\n        kepesseg: {\n            ero: '10',\n            gy: '10',\n            ugy: '10',\n            ak: '10',\n            egs: '10',\n            sz: '10',\n            int: '10',\n            ae: '10',\n            asz: '10',\n            erz: '10'\n        },\n        alapHarcertek: {\n            ke: 0,\n            te: 0,\n            ve: 0,\n            ce: 0\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 0,\n                ve: 0,\n                ce: 0\n            },\n            szabad: 0\n        },\n        epfp: {\n            ep: 0,\n            fp: 0,\n            fpPerSzint: 'k6'\n        }\n    },\n    harcos: {\n        name: 'harcos',\n        kepesseg: {\n            ero: 'k6 + 12 + kf',\n            gy: '2k6 + 6 + kf',\n            ugy: '2k6 + 6 + kf',\n            ak: 'k10 + 8 + kf',\n            egs: 'k10+10',\n            sz: '3k6(2x)',\n            int: '3k6(2x)',\n            ae: '2k6+6',\n            asz: '3k6(2x)',\n            erz: '2k6+6'\n        },\n        alapHarcertek: {\n            ke: 9,\n            te: 20,\n            ve: 75,\n            ce: 0\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 3,\n                ve: 3,\n                ce: 0\n            },\n            szabad: 5\n        },\n        epfp: {\n            ep: 7,\n            fp: 6,\n            fpPerSzint: 'k6+4'\n        }\n    },\n    lovag: {\n        name: 'lovag',\n        kepesseg: {\n            ero: 'k6 + 12 + kf',\n            gy: '3k6(2x)',\n            ugy: '3k6(2x)',\n            ak: 'k10 + 8 + kf',\n            egs: 'k10+10',\n            sz: '2k6+6+kf',\n            int: '2k6+6',\n            ae: 'k10+8',\n            asz: '3k6(2x)',\n            erz: '2k6+6'\n        },\n        alapHarcertek: {\n            ke: 5,\n            te: 20,\n            ve: 75,\n            ce: 0\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 5,\n                ve: 5,\n                ce: 0\n            },\n            szabad: 2\n        },\n        epfp: {\n            ep: 7,\n            fp: 6,\n            fpPerSzint: 'k6+5'\n        }\n    },\n    'gladitor': {\n        name: 'gladitor',\n        kepesseg: {\n            ero: 'k6 + 12 + kf',\n            gy: '2k6 + 6 + kf',\n            ugy: '2k6 + 6 + kf',\n            ak: 'k6 + 12 + kf',\n            egs: 'k10+10',\n            sz: '2k6+6',\n            int: '3k6',\n            ae: '3k6',\n            asz: '3k6',\n            erz: '2k6+6'\n        },\n        alapHarcertek: {\n            ke: 9,\n            te: 20,\n            ve: 75,\n            ce: 0\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 4,\n                ve: 4,\n                ce: 0\n            },\n            szabad: 4\n        },\n        epfp: {\n            ep: 8,\n            fp: 7,\n            fpPerSzint: 'k6+5'\n        }\n    },\n    'fejvadsz': {\n        name: 'fejvadsz',\n        kepesseg: {\n            ero: '2k6+6',\n            gy: 'k6+12+kf',\n            ugy: 'k10+8',\n            ak: 'k6 + 12 + kf',\n            egs: 'k10+10',\n            sz: '3k6',\n            int: '3k6(2x)',\n            ae: 'k10+8',\n            asz: '2k6+6',\n            erz: 'k6+12'\n        },\n        alapHarcertek: {\n            ke: 10,\n            te: 20,\n            ve: 75,\n            ce: 0\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 4,\n                ve: 4,\n                ce: 0\n            },\n            szabad: 3\n        },\n        epfp: {\n            ep: 6,\n            fp: 7,\n            fpPerSzint: 'k6+5'\n        }\n    },\n    tolvaj: {\n        name: 'tolvaj',\n        kepesseg: {\n            ero: '3k6(2x)',\n            gy: 'k10 + 8 + kf',\n            ugy: 'k6 + 12 + kf',\n            ak: '3k6(2x)',\n            egs: '3k6(2x)',\n            sz: '2k6 + 6',\n            int: '2k6 + 6',\n            ae: '3k6',\n            asz: '3k6(2x)',\n            erz: 'k6+12'\n        },\n        alapHarcertek: {\n            ke: 8,\n            te: 17,\n            ve: 72,\n            ce: 10\n        },\n        hm: {\n            kotelezo: {\n                ke: 1,\n                te: 1,\n                ve: 1,\n                ce: 0\n            },\n            szabad: 4\n        },\n        epfp: {\n            ep: 4,\n            fp: 5,\n            fpPerSzint: 'k6+3'\n        }\n    },\n    'brd': {\n        name: 'brd',\n        kepesseg: {\n            ero: 'k10+8',\n            gy: 'k10+8+kf',\n            ugy: 'k10 + 8',\n            ak: '2k6+6',\n            egs: '2k6+6',\n            sz: 'k6+12+kf',\n            int: 'k10+8(2x)',\n            ae: '2k6+6',\n            asz: 'k10+8',\n            erz: 'k10+8'\n        },\n        alapHarcertek: {\n            ke: 10,\n            te: 20,\n            ve: 75,\n            ce: 10\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 2,\n                ve: 2,\n                ce: 0\n            },\n            szabad: 5\n        },\n        epfp: {\n            ep: 5,\n            fp: 6,\n            fpPerSzint: 'k6+3'\n        }\n    },\n    pap: {\n        name: 'pap',\n        kepesseg: {\n            ero: '2k6+6',\n            gy: '3k6(2x)',\n            ugy: '3k6(2x)',\n            ak: '2k6+6',\n            egs: 'k10+8',\n            sz: 'k10+10',\n            int: 'k10+8',\n            ae: 'k10+8+kf',\n            asz: 'k6+12',\n            erz: 'k10+8'\n        },\n        alapHarcertek: {\n            ke: 5,\n            te: 17,\n            ve: 72,\n            ce: 0\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 3,\n                ve: 3,\n                ce: 0\n            },\n            szabad: 2\n        },\n        epfp: {\n            ep: 6,\n            fp: 6,\n            fpPerSzint: 'k6+2'\n        }\n    },\n    paplovag: {\n        name: 'paplovag',\n        kepesseg: {\n            ero: 'k10+8+kf',\n            gy: '3k6(2x)',\n            ugy: '3k6(2x)',\n            ak: 'k10+8',\n            egs: 'k10+10',\n            sz: 'k10+8',\n            int: '2k6 + 6',\n            ae: 'k10+8',\n            asz: 'k10+8+kf',\n            erz: 'k10+8'\n        },\n        alapHarcertek: {\n            ke: 5,\n            te: 20,\n            ve: 75,\n            ce: 0\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 3,\n                ve: 3,\n                ce: 0\n            },\n            szabad: 3\n        },\n        epfp: {\n            ep: 8,\n            fp: 7,\n            fpPerSzint: 'k6+5'\n        }\n    },\n    'harcmvsz': {\n        name: 'harcmvsz',\n        kepesseg: {\n            ero: 'k10+8',\n            gy: 'k6+14',\n            ugy: 'k6+12',\n            ak: 'k6+12',\n            egs: 'k10+10',\n            sz: '3k6(2x)',\n            int: '3k6(2x)',\n            ae: 'k6+12',\n            asz: 'k10+8',\n            erz: 'k6+12'\n        },\n        alapHarcertek: {\n            ke: 10,\n            te: 20,\n            ve: 75,\n            ce: 0\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 3,\n                ve: 3,\n                ce: 0\n            },\n            szabad: 2\n        },\n        epfp: {\n            ep: 4,\n            fp: 8,\n            fpPerSzint: 'k6+5'\n        }\n    },\n    'kardmvsz': {\n        name: 'kardmvsz',\n        kepesseg: {\n            ero: 'k10+8',\n            gy: 'k6+12+kf',\n            ugy: 'k6+14',\n            ak: 'k10+8',\n            egs: 'k10+8',\n            sz: '3k6(2x)',\n            int: '2k6 + 6',\n            ae: 'k6+12',\n            asz: 'k10+8',\n            erz: 'k6+12'\n        },\n        alapHarcertek: {\n            ke: 10,\n            te: 20,\n            ve: 75,\n            ce: 0\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 3,\n                ve: 3,\n                ce: 0\n            },\n            szabad: 2\n        },\n        epfp: {\n            ep: 4,\n            fp: 8,\n            fpPerSzint: 'k6+5'\n        }\n    },\n    'boszorknymester': {\n        name: 'boszorknymester',\n        kepesseg: {\n            ero: '3k6(2x)',\n            gy: 'k10+8',\n            ugy: 'k6+12+kf',\n            ak: '3k6(2x)',\n            egs: '2k6+6',\n            sz: '3k6',\n            int: '2k6 + 6',\n            ae: '2k6+6',\n            asz: '2k6+6',\n            erz: '2k6+6'\n        },\n        alapHarcertek: {\n            ke: 7,\n            te: 17,\n            ve: 72,\n            ce: 5\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 1,\n                ve: 1,\n                ce: 0\n            },\n            szabad: 5\n        },\n        epfp: {\n            ep: 3,\n            fp: 4,\n            fpPerSzint: 'k6+1'\n        }\n    },\n    'tzvarzsl': {\n        name: 'tzvarzsl',\n        kepesseg: {\n            ero: '2k6+6',\n            gy: '3k6(2x)',\n            ugy: '3k6(2x)',\n            ak: '2k6+6',\n            egs: '2k6+6',\n            sz: '3k6',\n            int: '2k6 + 6',\n            ae: '2k6+6',\n            asz: '2k6+6',\n            erz: '2k6+6'\n        },\n        alapHarcertek: {\n            ke: 6,\n            te: 17,\n            ve: 72,\n            ce: 0\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 3,\n                ve: 3,\n                ce: 0\n            },\n            szabad: 2\n        },\n        epfp: {\n            ep: 5,\n            fp: 4,\n            fpPerSzint: 'k6+1'\n        }\n    },\n    'varzsl': {\n        name: 'varzsl',\n        kepesseg: {\n            ero: '3k6',\n            gy: '3k6(2x)',\n            ugy: '3k6(2x)',\n            ak: '3k6',\n            egs: '3k6(2x)',\n            sz: '3k6',\n            int: 'k6+12+kf',\n            ae: 'k6+12+kf',\n            asz: 'k6+12+kf',\n            erz: '2k6+6'\n        },\n        alapHarcertek: {\n            ke: 2,\n            te: 15,\n            ve: 70,\n            ce: 0\n        },\n        hm: {\n            kotelezo: {\n                ke: 0,\n                te: 1,\n                ve: 1,\n                ce: 0\n            },\n            szabad: 2\n        },\n        epfp: {\n            ep: 3,\n            fp: 2,\n            fpPerSzint: 'k6'\n        }\n    },\n}\n\nexport interface Kaszt {\n    name: string,\n    kepesseg: KepessegDobas,\n    alapHarcertek: Harcertek,\n    hm: { kotelezo: Harcertek, szabad: number },\n    epfp: { ep: number, fp: number, fpPerSzint: string }\n}\n\nexport function osszead<T>(r1: Record<keyof T, number>, r2: Record<keyof T, number>): Record<keyof T, number> {\n    const keys = [...new Set([...Object.keys(r1), ...Object.keys(r2)])];\n    return keys.reduce((acc, curr) => { acc[curr as keyof T] = r1[curr as keyof T] + r2[curr as keyof T]; return acc; }, {} as Record<keyof T, number>)\n}","import { DobasMatrix } from \"./dobasmatrix\";\nimport { FEGYVERTELEN, FegyverUtils, FEGYVER_KEPZETTSEG, Harcertek } from \"./harc\";\nimport { Kaszt, osszead } from \"./kasztok\";\nimport { Pancel } from \"./pancel\";\nimport { roll } from \"./roll\";\n\n\nexport interface KarakterKepesseg {\n    ero: number;\n    gy: number;\n    ugy: number;\n    ak: number;\n    egs: number;\n    sz: number;\n    int: number;\n    ae: number;\n    asz: number;\n}\n\nexport interface KarakterInfo {\n    id: string;\n    name: string;\n}\n\nexport interface KarakterInfo {\n    id: string;\n    categories: Array<string>;\n    name: string;\n}\n\nexport interface Points {\n    akt: number;\n    max: number;\n}\n\nexport interface KarakterV1 extends KarakterInfo {\n    version: 1;\n    faj: string;\n    kaszt: Kaszt;\n    szint: number;\n    kepessegek: KarakterKepesseg;\n    kepzettsegek?: Array<Kepzettseg>;\n    alapHarcertek: Harcertek;\n    hmHarcertek: Harcertek;\n    hm: number;\n    fegyverek: Array<Fegyver>;\n    pancelok?: Array<Pancel>;\n    valasztottPancel?: number;\n    valasztottFegyver?: number;\n    masodlagosFegyver?: number;\n    pszi?: Points,\n    mp?: Points,\n\n    maxFp: number;\n    maxEp: number;\n    fp: number;\n    ep: number;\n}\n\nexport interface Pajzs {\n    termeszetes: number;\n    statikus: number;\n    dinamikus: number;\n}\n\nexport interface Karakter extends KarakterInfo {\n    version: 2;\n    faj: string;\n    kaszt: Kaszt;\n    szint: number;\n    kepessegek: KarakterKepesseg;\n    kepzettsegek?: Array<Kepzettseg>;\n    alapHarcertek: Harcertek;\n    hmHarcertek: Harcertek;\n    hm: number;\n    fegyverek: Array<Fegyver>;\n    pancelok?: Array<Pancel>;\n    valasztottPancel?: number;\n    valasztottFegyver?: number;\n    masodlagosFegyver?: number;\n    pszi?: Points,\n    mp?: Points,\n    ep: Points,\n    fp: Points,\n    pajzs?: {\n        asztral: Pajzs;\n        mental: Pajzs;\n    };\n    jegyzetek?: string;\n    felszereles?: Array<FelszerelesItem>;\n    masodlagosFegyverMutat?: boolean;\n}\n\nexport interface FelszerelesItem {\n    name: string;\n    qty: number;\n}\n\nexport interface Fegyver {\n    name: string;\n    harcertek: Harcertek;\n    sebzes: string;\n    tamPerKor: number;\n    lassu?: boolean;\n    lotav?: number;\n    erobonusz?: number;\n    pajzs?: boolean;\n    mgt?: number;\n}\n\nexport interface Kepzettseg {\n    name: string;\n    target?: string;\n    szint: '1' | '2' | '3' | '4' | '5' | 'Af' | 'Mf' | number;\n    kp: number;\n}\n\nexport const findKepzettseg = ({ kepzettsegek }: Pick<Karakter, 'kepzettsegek'>, kepzettseg: string): Kepzettseg | undefined => {\n    return kepzettsegek?.find(k => k.name.toLowerCase() === kepzettseg.toLowerCase());\n}\n\nexport const folottiResz = (kepesseg?: number, hatar: number = 10) => {\n    return Math.max(0, ((kepesseg === undefined || Number.isNaN(kepesseg)) ? 0 : kepesseg) - hatar);\n}\n\nexport const szintlepes = (karakter: Karakter): Karakter => {\n    karakter.szint++;\n    const hm = karakter.kaszt.hm;\n    karakter.hm += hm.szabad;\n    karakter.hmHarcertek = osszead(karakter.hmHarcertek, hm.kotelezo);\n    karakter.fp.max += roll(karakter.kaszt.epfp.fpPerSzint).value;\n    karakter.fp.akt = karakter.fp.max;\n    return karakter;\n}\n\nconst calculateKepessegHarcertek = (karakter: Karakter, fegyver: Fegyver): Record<string, string | number> => {\n    const mgt = calculateMGT(karakter);\n    const ugy = folottiResz(karakter.kepessegek.ugy - mgt[0]);\n    const gy = folottiResz(karakter.kepessegek.gy - mgt[0]);\n    const erobonusz = fegyver.erobonusz ?? 16;\n    return {\n        ke: gy + ugy,\n        te: gy + ugy + folottiResz(karakter.kepessegek.ero),\n        ve: gy + ugy,\n        ce: ugy,\n        sebzes: erobonusz !== 0 ? folottiResz(karakter.kepessegek.ero, erobonusz) : 0\n    }\n}\n\nexport const calculateSebesulesHatrany = (karakter: Karakter): Harcertek | null => {\n    if (karakter.ep.max > 0 && karakter.ep.akt <= karakter.ep.max * 0.25) {\n        return {\n            ke: -15,\n            te: -20,\n            ve: -25,\n            ce: -30\n        }\n    } else if ((karakter.ep.max > 0 && karakter.ep.akt <= karakter.ep.max * 0.5) || (karakter.fp.akt > 0 && karakter.fp.akt < karakter.fp.max * 0.1)) {\n        return {\n            ke: -5,\n            te: -10,\n            ve: -10,\n            ce: -5\n        }\n    }\n    return null;\n}\n\nexport const calculateMGT = (karakter: Karakter): [number, boolean?] => {\n    const pancel = karakter.valasztottPancel !== undefined ? karakter.pancelok?.[karakter.valasztottPancel] : undefined;\n    if (!pancel) {\n        return [0]; // no pancel, no mgt\n    }\n    const nehezvertViselet = findKepzettseg(karakter, 'Nehzvrtviselet')?.szint;\n    switch (nehezvertViselet) {\n        case 'Mf': return [0];\n        case 'Af': return [pancel.nehez ? pancel.mgt : 0];\n        default: return [pancel.mgt, pancel.nehez];\n    }\n}\n\nconst addKepzettseg = (ret: DobasMatrix, karakter: Karakter, fegyver: Fegyver) => {\n    const tipus = FegyverUtils.tipus(fegyver);\n    const fejvadasz = karakter.kaszt?.name === 'fejvadsz';\n    const kepzettseg: Kepzettseg | undefined = karakter.kepzettsegek?.find(k => k.name === FegyverUtils.kepzettseg(fegyver));\n    const pajzsHasznalat = findKepzettseg(karakter, 'Pajzshasznlat');\n\n    const mgt = calculateMGT(karakter);\n    if (mgt[1]) {\n        ret.add('Nehzvrt', { ...FEGYVER_KEPZETTSEG['kpzetlen'] });\n    } else if (!kepzettseg) {\n        if (tipus && !(tipus === 'pajzs' && pajzsHasznalat?.szint)) {\n            if (!fejvadasz) {\n                ret.add('kpzetlen', { ...FEGYVER_KEPZETTSEG['kpzetlen'] });\n            } else {\n                ret.add('kpzetlen', { ...FEGYVER_KEPZETTSEG['kpzetlen, fejvadsz'] });\n            }\n        }\n    } else if (tipus !== 'kl') { // klharcnl nincs bnusz\n        ret.add('Kpzettsg ' + kepzettseg.szint, { ...FEGYVER_KEPZETTSEG[kepzettseg.szint] });\n    }\n}\n\nconst addKetkezes = (ret: DobasMatrix, karakter: Karakter, masodlagos?: boolean) => {\n    if (karakter.valasztottFegyver === undefined || karakter.masodlagosFegyver === undefined) {\n        return;\n    }\n    const pajzsHasznalat = findKepzettseg(karakter, 'Pajzshasznlat');\n    const ketkezesHarc = findKepzettseg(karakter, 'Ktkezes harc');\n    const masodlagosFegyver = karakter.fegyverek[karakter.masodlagosFegyver];\n    if (masodlagosFegyver?.pajzs && pajzsHasznalat) {\n        if (!masodlagos) {\n            ret.add('Pajzs', { ve: masodlagosFegyver.harcertek.ve });\n        }\n    } else {\n        switch (ketkezesHarc?.szint) {\n            case 'Mf': return;\n            case 'Af': {\n                if (masodlagos) {\n                    ret.add('ktkezes harc', { ke: -2, te: -5, ve: -5 });\n                }\n                return;\n            }\n            default: {\n                if (masodlagos) {\n                    ret.add('ktkezes harc', { ...FEGYVER_KEPZETTSEG['kpzetlen'] });\n                } else {\n                    ret.add('ktkezes harc', { ke: -5, te: -10, ve: -10 });\n                }\n                return;\n            }\n        }\n    }\n}\n\nconst findFegyver = (karakter: Karakter, masodlagos?: boolean): Fegyver => {\n    const index = masodlagos ? karakter.masodlagosFegyver : karakter.valasztottFegyver;\n    if (index === undefined) {\n        return FEGYVERTELEN;\n    }\n    return karakter.fegyverek[index] ?? FEGYVERTELEN;\n}\n\nexport const calculateHarcertek = (karakter: Karakter, szituaciok?: Array<Harcertek & { name: string }>, masodlagos?: boolean): DobasMatrix => {\n    const fegyver = findFegyver(karakter, masodlagos);\n    const tipus = FegyverUtils.tipus(fegyver);\n    const ret: DobasMatrix = new DobasMatrix(!tipus ? ['ke', 'te', 've', 'ce', 'sebzes'] : (tipus === 'lofegyver' ? ['ke', 'ce', 've', 'sebzes'] : ['ke', 'te', 've', 'sebzes']));\n\n    ret.add('alap', karakter.alapHarcertek as unknown as Record<string, number>);\n\n    const fejvadasz = karakter.kaszt?.name === 'fejvadsz';\n    if (fejvadasz && karakter.szint) {\n        ret.add('spec', { ke: Math.floor(karakter.szint / 2), sebzes: Math.floor(karakter.szint / 2) });\n    }\n\n    ret.add('hm', karakter.hmHarcertek as unknown as Record<string, number>)\n\n    if (tipus) {\n        ret.add(fegyver.name, { ...fegyver.harcertek, 'sebzes': fegyver.sebzes });\n    }\n\n    ret.add('kepessegek', calculateKepessegHarcertek(karakter, fegyver));\n\n    addKepzettseg(ret, karakter, fegyver);\n\n    addKetkezes(ret, karakter, masodlagos);\n\n    const sebesules = calculateSebesulesHatrany(karakter);\n    if (sebesules) {\n        ret.add('Sebesls', { ...sebesules });\n    }\n\n    szituaciok?.forEach(sz => ret.add(sz.name, { ...sz }));\n\n    return ret;\n}","import React from 'react';\nimport { Label } from 'semantic-ui-react';\nimport { DiceRollResult } from '../engine/roll';\n\nexport const DobasEredmeny: React.FC<{ pointing?: 'left' | 'right', result?: DiceRollResult }> = ({ result, pointing }) => {\n    return <>\n        {result && <Label size='large' pointing={pointing} color='black'>{result?.value}</Label>}\n        {result && <Label basic><i>{result?.details}</i></Label>}\n    </>;\n}","import React from 'react';\r\nimport { Button, ButtonGroup, Label } from 'semantic-ui-react';\r\nimport { DiceRoll, formatDiceRoll } from '../engine/roll';\r\n\r\nexport const DobasInput: React.FC<{ value: DiceRoll, onChange: (dobas: DiceRoll) => unknown }> = ({ value, onChange }) => {\r\n\r\n    const setDie = (die: number) => {\r\n        if (value.die === die) {\r\n            value.numDice++;\r\n        } else {\r\n            value.die = die;\r\n            value.numDice = 1;\r\n        }\r\n        onChange(value);\r\n    }\r\n\r\n    const addPlus = (plus: number) => {\r\n        value.plus += plus;\r\n        onChange(value);\r\n    }\r\n\r\n    const toggleKf = () => {\r\n        value.kf = !value.kf;\r\n        onChange(value);\r\n    }\r\n\r\n    const toggle2x = () => {\r\n        value.tries = (value.tries > 1) ? 1 : 2;\r\n        onChange(value);\r\n    }\r\n\r\n    return <ButtonGroup fluid size='tiny' labelPosition='left'>\r\n        <Label basic>{formatDiceRoll(value)}</Label>\r\n        <Button color='olive' onClick={() => setDie(0)}>-</Button>\r\n        <Button color='olive' onClick={() => setDie(6)}>k6</Button>\r\n        <Button color='olive' onClick={() => setDie(10)}>k10</Button>\r\n        <Button onClick={() => addPlus(-1)}>-1</Button>\r\n        <Button onClick={() => addPlus(1)}>+1</Button>\r\n        <Button color='orange' onClick={() => toggleKf()}>+kf</Button>\r\n        <Button color='blue' onClick={() => toggle2x()}>2x</Button>\r\n    </ButtonGroup>\r\n}","import React from 'react';\r\nimport { Icon } from 'semantic-ui-react';\r\n\r\nexport const NumberInput: React.FC<{ value: number, onChange: (value: number) => unknown, min: number, max: number, icons?: boolean }> = ({ value, onChange, min, max, icons }) => {\r\n    return <span style={{ whiteSpace: 'nowrap' }}>\r\n        {icons && <button onClick={() => { onChange(Math.max(min, value - 1)) }} ><Icon compact name='arrow down' style={{ margin: '0' }} /></button>}\r\n        <input style={{ width: '3rem' }} value={value} onChange={(e) => {\r\n            const newValue = e.target.value;\r\n            if (/^-?\\d+$/.test(newValue) || newValue === '') {\r\n                let num = newValue !== '' ? parseInt(newValue) : 0;\r\n                if (min !== undefined && num < min) {\r\n                    num = min;\r\n                }\r\n                if (max !== undefined && num > max) {\r\n                    num = max;\r\n                }\r\n                onChange(num);\r\n            } else {\r\n                onChange(value);\r\n            }\r\n        }}>\r\n        </input>\r\n        {icons && <button onClick={() => { onChange(Math.min(max, value + 1)) }}><Icon compact name='arrow up' style={{ margin: '0' }} /></button>}\r\n    </span>\r\n}","import React from 'react';\nimport { SemanticCOLORS, Table } from 'semantic-ui-react';\nimport { DobasMatrix } from '../engine/dobasmatrix';\nimport { formatDiceRoll, parseDiceRoll } from '../engine/roll';\nimport { DobasEredmeny } from './DobasEredmeny';\nimport { DobasInput } from './DobasInput';\nimport { NumberInput } from './NumberInput';\n\ninterface DobasMatrixDisplayProps {\n    matrix: DobasMatrix,\n    keyMap: Record<string, string>,\n    direction: 'horizontal' | 'vertical',\n    title: string | React.ReactNode,\n    setValue?: (name: string, key: string, value: string) => unknown,\n    editable?: Array<string>,\n    numberOnly?: boolean,\n    color?: SemanticCOLORS\n}\n\nexport const DobasMatrixDisplay: React.FC<DobasMatrixDisplayProps> = ({ matrix, keyMap, direction, title, editable, setValue, numberOnly, color }) => {\n    const displayCell = (name: string, key: string) => {\n        const value = matrix.values[name][key];\n        const constantRoll = (value?.roll?.die ?? 0) === 0;\n        const rollString = value?.roll ? formatDiceRoll(value.roll) : '';\n        if (!editable?.includes(name)) {\n            return <Table.Cell key={name + '-' + key} collapsing>\n                {rollString}{!constantRoll && value?.result && <> = <DobasEredmeny result={value?.result} /></>}\n            </Table.Cell>;\n        } else {\n            return <Table.Cell key={name + '-' + key} collapsing>\n                {numberOnly ?\n                    <NumberInput value={value?.roll.plus ?? 0} onChange={v => setValue?.(name, key, String(v))} min={0} max={100000} />\n                    :\n                    <DobasInput value={value?.roll ?? parseDiceRoll('')} onChange={e => setValue?.(name, key, formatDiceRoll(e))} />\n                }\n            </Table.Cell>;\n        }\n    }\n\n    if (direction === 'horizontal') {\n        return <Table celled striped compact color={color}>\n            <Table.Header>\n                <Table.Row>\n                    <Table.HeaderCell key='title' disabled={false}>{title}</Table.HeaderCell>\n                    {matrix.keys.map(key => <Table.HeaderCell key={key}>{keyMap[key]}</Table.HeaderCell>)}\n                </Table.Row>\n            </Table.Header>\n            <Table.Body>\n                {Object.keys(matrix.values).map(name => {\n                    return <Table.Row key={name}>\n                        <Table.HeaderCell key={name}>{name}</Table.HeaderCell>\n                        {matrix.keys.map(key => displayCell(name, key))}\n                    </Table.Row>\n                })}\n                <tr key='footer'>\n                </tr>\n            </Table.Body>\n            <Table.Footer>\n                <Table.HeaderCell title='sum'>sszeg</Table.HeaderCell>\n                {matrix.keys.map(key => <Table.HeaderCell key={key} collapsing>{matrix.sum[key]}</Table.HeaderCell>)}\n            </Table.Footer>\n        </Table>\n    } else {\n        return <Table celled striped definition compact color={color}>\n            <Table.Header>\n                <Table.Row>\n                    <Table.HeaderCell key='title'>{title}</Table.HeaderCell>\n                    {Object.keys(matrix.values).map(name => <Table.HeaderCell key={name}>{name}</Table.HeaderCell>)}\n                    <Table.HeaderCell key='sum' collapsing>sszeg</Table.HeaderCell>\n                </Table.Row>\n            </Table.Header>\n            <Table.Body>\n                {matrix.keys.map(key => {\n                    return <Table.Row key={key}>\n                        <Table.HeaderCell key='title'>{keyMap[key]}</Table.HeaderCell>\n                        {Object.keys(matrix.values).map(name => displayCell(name, key))}\n                        <Table.HeaderCell key='sum'>{matrix.sum[key]}</Table.HeaderCell>\n                    </Table.Row>\n                })}\n            </Table.Body>\n        </Table>\n\n    }\n}","import React from 'react';\nimport { Table } from 'semantic-ui-react';\nimport { SemanticCOLORS } from 'semantic-ui-react/dist/commonjs/generic';\nimport { Points } from '../engine/karakter';\nimport { NumberInput } from './NumberInput';\n\n//const NumberInput: any = require('semantic-ui-react-numberinput').default;\n\ninterface Point extends Points {\n    name: string;\n    label: string;\n}\n\ninterface PointsTableProps {\n    points: Array<Point>,\n    onChange: (name: string, max: boolean, newValue: number) => unknown,\n    title?: string,\n    color?: SemanticCOLORS\n}\n\nexport const PointsTable: React.FC<PointsTableProps> = ({ points, onChange, title, color }) => {\n    return <Table striped celled definition fluid compact color={color}>\n        <Table.Header>\n            <Table.Row>\n                <Table.HeaderCell>{title ?? 'Pontok'}</Table.HeaderCell>\n                {points.map(p => <Table.HeaderCell collapsing>{p.label}</Table.HeaderCell>)}\n            </Table.Row>\n\n        </Table.Header>\n        <Table.Body>\n            <Table.Row>\n                <Table.HeaderCell>Max</Table.HeaderCell>\n                {points.map(p => <Table.Cell collapsing><NumberInput icons value={p.max} min={0} max={1000} onChange={(e: number) => onChange(p.name, true, e)} /></Table.Cell>)}\n            </Table.Row>\n            <Table.Row>\n                <Table.HeaderCell>Akt</Table.HeaderCell>\n                {points.map(p => <Table.Cell collapsing><NumberInput icons value={p.akt} min={0} max={p.max} onChange={(e: number) => onChange(p.name, false, Math.min(p.max, e))} /></Table.Cell>)}\n            </Table.Row>\n        </Table.Body>\n    </Table>\n\n}","import React from 'react';\nimport { Button, Label } from 'semantic-ui-react';\n\ninterface SelectionProps { label: JSX.Element | string, selected?: string, setSelected: (newValue: string | undefined) => unknown, options: Array<string>, structure?: Record<string, Array<string>> };\n\nexport const Selection: React.FC<SelectionProps> = ({ label, selected, setSelected, options, structure }) => {\n    if (!structure) {\n        return <Button labelPosition='left' as='div'>\n            <Label basic pointing='right'>\n                {label}\n            </Label>\n            {options.map(n => <Button active={selected === n} onClick={() => setSelected(n)}>{n}</Button>)}\n        </Button>\n    } else {\n        return <Button labelPosition='left' as='div'>\n            <Label basic pointing='right'>\n                {label}\n            </Label>\n            {Object.keys(structure).map(fk => <Button.Group as='div' vertical>\n                <Label tag color='yellow'>{fk}</Label>\n                {options.filter(o => structure[fk].includes(o)).map((n, i) => <Button compact active={selected === n} onClick={() => setSelected(n)}>{n}</Button>)}\n            </Button.Group>\n            )}\n        </Button>\n    }\n\n}","import React from 'react';\r\nimport { Input, Label } from 'semantic-ui-react';\r\nimport { KASZTOK, FOKASZTOK } from '../engine/kasztok';\r\nimport { BackgroundSelection } from '../pages/KarakterAlkotas';\r\nimport { Selection } from './Selection';\r\n\r\nexport const KarakterAlkotasBackground: React.FC<{ fajNevek: Array<string>, backgroundSelection: BackgroundSelection, setBackgroundSelection: (backgroundSelection: BackgroundSelection) => unknown }> = ({ fajNevek, backgroundSelection, setBackgroundSelection }) => {\r\n\r\n    const changeKasztSelection = (s: string | undefined) => {\r\n        const kaszt = (!!s && KASZTOK[s]) || KASZTOK['egyb']\r\n        setBackgroundSelection({ ...backgroundSelection, kaszt: JSON.parse(JSON.stringify(kaszt)) });\r\n    };\r\n\r\n\r\n    return <div>\r\n        <div>\r\n            <Input fluid labelPosition='left' placeholder='Karakter neve...' error={!backgroundSelection.name} value={backgroundSelection.name} onChange={e => setBackgroundSelection({ ...backgroundSelection, name: e.target.value })}>\r\n                <Label pointing='right' basic>Nv</Label>\r\n                <input />\r\n            </Input>\r\n        </div>\r\n        <div><Selection label='Kaszt' selected={backgroundSelection.kaszt?.name} setSelected={changeKasztSelection} options={Object.keys(KASZTOK)} structure={FOKASZTOK} /></div>\r\n        <div><Selection label='Faj' selected={backgroundSelection.faj} setSelected={faj => setBackgroundSelection({ ...backgroundSelection, faj })} options={fajNevek} /></div>\r\n        <div><Input labelPosition='left' value={backgroundSelection.szint} onChange={e => {\r\n            const value = e.target.value ? Math.max(0, Math.floor(Number(e.target.value))) : undefined;\r\n            setBackgroundSelection({ ...backgroundSelection, szint: value });\r\n        }}>\r\n            <Label pointing='right' basic>Szint</Label>\r\n            <input />\r\n        </Input>\r\n        </div>\r\n        <div>\r\n            <Input labelPosition='left' error={!backgroundSelection.kaszt?.name} value={backgroundSelection.kaszt?.name} onChange={e => {\r\n                if (backgroundSelection.kaszt) {\r\n                    setBackgroundSelection({ ...backgroundSelection, kaszt: { ...backgroundSelection.kaszt, name: e.target.value } });\r\n                }\r\n            }}>\r\n                <Label pointing='right' basic>Kaszt neve</Label>\r\n                <input />\r\n            </Input>\r\n        </div>\r\n    </div>\r\n\r\n}\r\n","import React, { useEffect, useState } from 'react';\nimport { Button, Grid, GridColumn, GridRow, Input, Label } from 'semantic-ui-react';\nimport { v4 } from 'uuid';\nimport { DobasMatrix } from '../engine/dobasmatrix';\nimport { HARCERTEK_DISPLAY_NAMES } from '../engine/harc';\nimport { calculateHarcertek, folottiResz, Karakter, KarakterKepesseg, szintlepes } from '../engine/karakter';\nimport { Kaszt, KepessegDobas, KEPESSEG_NEV } from '../engine/kasztok';\nimport { DobasMatrixDisplay } from '../components/DobasMatrixDisplay';\nimport { PointsTable } from '../components/PointsTable';\nimport { KarakterAlkotasBackground } from '../components/KarakterAlkotasBackground';\n\nconst NumberInput: any = require('semantic-ui-react-numberinput').default;\n\nexport interface BackgroundSelection {\n    name: string;\n    faj?: string;\n    kaszt?: Kaszt;\n    szint?: number;\n}\n\n\nconst calculateKepessegek = (fajok: Record<string, KepessegDobas>, { kaszt, faj }: { kaszt?: Kaszt, faj?: string }, roll?: boolean) => {\n    const newMatrix = new DobasMatrix(Object.keys(KEPESSEG_NEV));\n    if (kaszt) {\n        newMatrix.add('Kaszt: ' + kaszt.name, kaszt.kepesseg as unknown as Record<string, string>);\n    }\n    if (faj && fajok[faj]) {\n        newMatrix.add('Faj: ' + faj, fajok[faj] as unknown as Record<string, string>);\n    }\n    if (roll) {\n        newMatrix.roll();\n    }\n    return newMatrix;\n}\n\nconst createKarakter = ({ kaszt, faj, szint, name }: BackgroundSelection, kepessegek: DobasMatrix) => {\n    if (!kaszt || !kepessegek.sum || !faj) {\n        return null;\n    }\n    const epfp = kaszt.epfp;\n    const ep = epfp.ep + folottiResz(kepessegek.sum.egs);\n    const fp = epfp.fp + folottiResz(kepessegek.sum.ae) + folottiResz(kepessegek.sum.ak);\n    const karakter: Karakter = {\n        version: 2,\n        id: v4(),\n        name,\n        faj,\n        categories: [],\n        kepessegek: kepessegek.sum as unknown as KarakterKepesseg,\n        kaszt,\n        szint: 0,\n        hm: 0,\n        ep: { max: ep, akt: ep },\n        fp: { max: fp, akt: fp },\n        hmHarcertek: { ke: 0, te: 0, ve: 0, ce: 0 },\n        kepzettsegek: [],\n        alapHarcertek: kaszt.alapHarcertek,\n        fegyverek: []\n    };\n    [...Array(szint).keys()].forEach(() => szintlepes(karakter));\n    return karakter;\n};\n\n\n\nexport const KarakterAlkotas: React.FC<{ save: (karakter: Karakter) => unknown, fajok: Record<string, KepessegDobas> }> = ({ save, fajok }) => {\n    const [backgroundSelection, setBackgroundSelection] = useState<BackgroundSelection>({ szint: 1, name: '' });\n    const [matrix, setMatrix] = useState<DobasMatrix>(new DobasMatrix(Object.keys(KEPESSEG_NEV)));\n\n    useEffect(() => {\n        setMatrix(calculateKepessegek(fajok, { kaszt: backgroundSelection.kaszt, faj: backgroundSelection.faj }));\n    }, [fajok, backgroundSelection.faj, backgroundSelection.kaszt, setMatrix]);\n\n    const dob = () => {\n        setMatrix(calculateKepessegek(fajok, backgroundSelection, true));\n    };\n\n\n\n    const { kaszt } = backgroundSelection;\n    const karakter = kaszt ? {\n        kepessegek: matrix.sum as unknown as KarakterKepesseg,\n        alapHarcertek: kaszt.alapHarcertek,\n        hmHarcertek: kaszt.hm.kotelezo,\n        ep: { max: kaszt.epfp.ep + folottiResz(matrix.sum.egs), akt: kaszt.epfp.ep + folottiResz(matrix.sum.egs) },\n        fp: { max: kaszt.epfp.fp + folottiResz(matrix.sum.ae) + folottiResz(matrix.sum.ak), akt: kaszt.epfp.fp + folottiResz(matrix.sum.ae) + folottiResz(matrix.sum.ak) }\n    } : undefined;\n\n    return <Grid relaxed>\n        <GridRow columns={2} divided>\n            <GridColumn>\n                <GridRow>\n                    <KarakterAlkotasBackground backgroundSelection={backgroundSelection} setBackgroundSelection={setBackgroundSelection} fajNevek={Object.keys(fajok)} />\n                </GridRow>\n                {karakter && <>\n                    <div>\n                        <Button as='div' basic floated='left'>\n                            <Label basic>Eloszthat HM:</Label>\n                            <NumberInput size='mini' allowEmptyValue value={backgroundSelection.kaszt?.hm.szabad} stepAmount={1} minValue={0} maxValue={1000} onChange={(e: string) => {\n                                if (backgroundSelection.kaszt) {\n                                    backgroundSelection.kaszt.hm.szabad = Number(e);\n                                    setBackgroundSelection({ ...backgroundSelection });\n                                }\n                            }} />\n                        </Button>\n                        <Button as='div' basic floated='right'>\n                            <Label basic>Szintenknti FP:</Label>\n                            <Input disabled={!kaszt} value={kaszt?.epfp.fpPerSzint} onChange={e => {\n                                if (kaszt) {\n                                    kaszt.epfp.fpPerSzint = e.target.value;\n                                    setBackgroundSelection({ ...backgroundSelection, kaszt })\n                                }\n                            }} />\n\n                        </Button>\n                    </div>\n                    <div><DobasMatrixDisplay\n                        title='Harcrtkek'\n                        editable={kaszt ? ['alap', 'hm'] : []}\n                        numberOnly\n                        setValue={(name, key, value) => {\n                            const intValue = Number(value);\n                            if (kaszt && !isNaN(intValue)) {\n                                if (name === 'alap') {\n                                    (kaszt.alapHarcertek as any)[key] = value;\n                                } else if (name === 'hm') {\n                                    (kaszt.hm.kotelezo as any)[key] = value;\n                                }\n                                setBackgroundSelection({ ...backgroundSelection, kaszt })\n                            }\n                        }}\n                        matrix={calculateHarcertek(karakter as Karakter).roll(['te', 've', 'ce', 'ke'])}\n                        direction='vertical'\n                        keyMap={HARCERTEK_DISPLAY_NAMES} />\n                    </div>\n                    <div>\n                        <PointsTable\n                            title='leter 0. szinten'\n                            points={[{ name: 'ep', label: 'P', ...karakter.ep }, { name: 'fp', label: 'FP', ...karakter.fp }]}\n\n                            onChange={(name, max, value) => {\n                                if (kaszt && max) {\n                                    if (name === 'ep') {\n                                        kaszt.epfp.ep = value - folottiResz(matrix.sum.egs);\n                                    }\n                                    if (name === 'fp') {\n                                        kaszt.epfp.fp = value - folottiResz(matrix.sum.ae) - folottiResz(matrix.sum.ak);\n                                    }\n                                    setBackgroundSelection({ ...backgroundSelection, kaszt })\n                                }\n                            }}\n                        />\n                    </div>\n                </>\n                }\n            </GridColumn>\n            <GridColumn>\n                <DobasMatrixDisplay\n                    title='Kpessgek'\n                    matrix={matrix}\n                    keyMap={KEPESSEG_NEV}\n                    direction='vertical'\n                    editable={kaszt?.name ? ['Kaszt: ' + kaszt.name] : []}\n                    setValue={(name, key, value) => kaszt && setBackgroundSelection({ ...backgroundSelection, kaszt: { ...kaszt, kepesseg: { ...kaszt.kepesseg, [key]: value } } })} />\n            </GridColumn>\n        </GridRow>\n        <GridRow columns={1} textAlign='center'>\n            <GridColumn>\n                <Button disabled={!kaszt} secondary onClick={dob}>Dob</Button>\n                <Button disabled={!backgroundSelection.name || backgroundSelection.szint === undefined || !matrix.sum} primary onClick={() => { const kar = createKarakter(backgroundSelection, matrix); if (kar) { save(kar) } }}>Ment</Button>\n            </GridColumn>\n        </GridRow>\n    </Grid>\n}","import React from 'react';\nimport { SemanticCOLORS, Table } from 'semantic-ui-react';\nimport { Fegyver } from '../engine/karakter';\n\ninterface FegyverListaProps {\n    fegyverek: Array<Fegyver>,\n    selected?: number,\n    onSelectionChange?: (newSelection: number | undefined) => unknown,\n    title?: string;\n    extraButton?: JSX.Element;\n    color?: SemanticCOLORS;\n\n}\n\nexport const FegyverLista: React.FC<FegyverListaProps> = ({ fegyverek, selected, onSelectionChange, title, extraButton, color }) => {\n    const fegyverLista: Array<Record<string, string | number>> = fegyverek.map(fegyver => {\n        const rec: Record<string, string | number> = {};\n        rec.name = fegyver.name;\n        rec.ke = fegyver.harcertek.ke;\n        rec.te = fegyver.harcertek.te || '-';\n        rec.ve = fegyver.harcertek.ve;\n        rec.ce = fegyver.harcertek.ce || '-';\n        rec.sebzes = fegyver.sebzes;\n        rec.tamPerKor = fegyver.lassu ? '1/' + fegyver.tamPerKor : fegyver.tamPerKor;\n        rec.lotav = fegyver.lotav ?? '-';\n        return rec;\n    });\n\n    return <Table compact celled striped definition selectable={onSelectionChange !== undefined} color={color}>\n        <Table.Header>\n            <Table.Row>\n                <Table.HeaderCell>{title ?? 'Fegyver'}</Table.HeaderCell>\n                <Table.HeaderCell>K</Table.HeaderCell>\n                <Table.HeaderCell>T</Table.HeaderCell>\n                <Table.HeaderCell>V</Table.HeaderCell>\n                <Table.HeaderCell>C</Table.HeaderCell>\n                <Table.HeaderCell>Sebzs</Table.HeaderCell>\n                <Table.HeaderCell>Tm / kr</Table.HeaderCell>\n                <Table.HeaderCell>Ltv</Table.HeaderCell>\n            </Table.Row>\n        </Table.Header>\n        <Table.Body>\n            {fegyverLista.map((r, i) => <Table.Row key={i} active={selected === i} onClick={() => onSelectionChange?.(selected === i ? undefined : i)}>\n                <Table.Cell>{r.name}</Table.Cell>\n                <Table.Cell>{r.ke}</Table.Cell>\n                <Table.Cell>{r.te}</Table.Cell>\n                <Table.Cell>{r.ve}</Table.Cell>\n                <Table.Cell>{r.ce}</Table.Cell>\n                <Table.Cell>{r.sebzes}</Table.Cell>\n                <Table.Cell>{r.tamPerKor}</Table.Cell>\n                <Table.Cell>{r.lotav}</Table.Cell>\n            </Table.Row>\n            )}\n            {extraButton && <Table.Row key='__extra'>\n                <Table.Cell colspan={8}>{extraButton}</Table.Cell>\n            </Table.Row>}\n        </Table.Body>\n    </Table>\n}","import React from 'react'\r\nimport { Input, Label } from 'semantic-ui-react';\r\n\r\ninterface IntegerInputProps {\r\n    value?: number,\r\n    onChange: (value?: number) => unknown,\r\n    label?: string;\r\n    labelPosition?: 'left' | 'right';\r\n    mandatory?: boolean;\r\n    disabled?: boolean;\r\n}\r\n\r\n\r\nexport const IntegerInput: React.FC<IntegerInputProps> = ({ value, onChange, label, labelPosition = 'left', mandatory, disabled }) => {\r\n    return <Input disabled={disabled} labelPosition={labelPosition} error={mandatory && (value === undefined)} value={value ?? ''} onChange={e => {\r\n        const newValue = e.target.value ? Math.max(0, Math.floor(Number(e.target.value))) : undefined;\r\n        if (newValue === undefined || !Number.isNaN(newValue)) {\r\n            onChange(newValue);\r\n        }\r\n    }}>\r\n        {label && labelPosition === 'left' && <Label pointing='right' basic>{label}</Label>}\r\n        <input style={{ width: '5rem' }} />\r\n        {label && labelPosition === 'right' && <Label pointing='left' basic>{label}</Label>}\r\n    </Input>;\r\n}","import React, { useEffect, useState } from 'react';\r\nimport { Button, Checkbox, Grid, GridColumn, GridRow, Input, Label } from 'semantic-ui-react';\r\nimport { Fegyver } from '../engine/karakter';\r\nimport { IntegerInput } from './IntegerInput';\r\n\r\ninterface FormValues {\r\n    name: string;\r\n    ke?: number;\r\n    te?: number;\r\n    ve?: number;\r\n    ce?: number;\r\n    lofegyver: boolean;\r\n    lotav?: number;\r\n    sebzes: string;\r\n    tamPerKor?: number;\r\n    erobonusz?: number;\r\n    lassu: boolean;\r\n    pajzs: boolean;\r\n    mgt?: number;\r\n}\r\n\r\nexport type FEGYVER_KEPZETTSEG = 'kpzetlen' | 'Af' | 'Mf';\r\n\r\nconst convertToFormValues = (fegyver?: Fegyver): FormValues => {\r\n    return {\r\n        name: fegyver?.name ?? '',\r\n        ke: fegyver?.harcertek.ke,\r\n        te: fegyver?.harcertek.te,\r\n        ve: fegyver?.harcertek.ve,\r\n        ce: fegyver?.harcertek.ce,\r\n        lofegyver: (fegyver?.harcertek.ce ?? 0) > 0,\r\n        lotav: fegyver?.lotav,\r\n        sebzes: fegyver?.sebzes ?? '',\r\n        tamPerKor: fegyver?.tamPerKor,\r\n        erobonusz: fegyver?.erobonusz,\r\n        lassu: fegyver?.lassu ?? false,\r\n        pajzs: fegyver?.pajzs ?? false,\r\n        mgt: fegyver?.mgt ?? 0\r\n    }\r\n}\r\n\r\nconst convertFromFormValues = (fegyver: FormValues): Fegyver => {\r\n    return {\r\n        name: fegyver.name,\r\n        harcertek: {\r\n            ke: fegyver.ke ?? 0,\r\n            te: fegyver.te ?? 0,\r\n            ve: fegyver.ve ?? 0,\r\n            ce: fegyver.ce ?? 0\r\n        },\r\n        lotav: fegyver.lotav,\r\n        sebzes: fegyver.sebzes,\r\n        tamPerKor: fegyver.tamPerKor ?? 1,\r\n        erobonusz: fegyver.erobonusz,\r\n        lassu: fegyver.lassu,\r\n        pajzs: fegyver.pajzs,\r\n        mgt: fegyver.mgt\r\n    }\r\n}\r\n\r\nexport const FegyverEditor: React.FC<{ kepzettseg?: boolean, fegyver?: Fegyver, submit: (fegyver: Fegyver, kepzettseg?: FEGYVER_KEPZETTSEG) => unknown, cancel: () => unknown }> = ({ fegyver, submit, cancel, kepzettseg }) => {\r\n\r\n    const [form, setForm] = useState<FormValues>(convertToFormValues(fegyver));\r\n\r\n    useEffect(() => {\r\n        setForm(convertToFormValues(fegyver));\r\n    }, [fegyver]);\r\n\r\n    return <Grid columns={1} relaxed>\r\n        <GridRow>\r\n            <GridColumn>\r\n                <div>\r\n                    <Input fluid labelPosition='left' placeholder='Fegyver neve...' error={!form.name} value={form.name} onChange={e => setForm({ ...form, name: e.target.value })}>\r\n                        <Label pointing='right' basic>Nv</Label>\r\n                        <input />\r\n                    </Input>\r\n                </div>\r\n                <div><IntegerInput value={form.ke} onChange={ke => setForm({ ...form, ke })} label='K' /></div>\r\n                <div>\r\n                    <Label pointing='right' basic>Lfegyver:</Label>\r\n                    <Checkbox fitted={true} toggle checked={form.lofegyver} onChange={() => setForm({ ...form, lofegyver: !form.lofegyver })}>\r\n                    </Checkbox>\r\n                </div>\r\n                {!form.lofegyver &&\r\n                    <div><IntegerInput value={form.te} onChange={te => setForm({ ...form, te })} label='T' /></div>\r\n                }\r\n                {form.lofegyver &&\r\n                    <div><IntegerInput value={form.ce} onChange={ce => setForm({ ...form, ce })} label='C' /></div>\r\n                }\r\n                <div><IntegerInput value={form.ve} onChange={ve => setForm({ ...form, ve })} label='V' /></div>\r\n                <div>\r\n                    <Input fluid labelPosition='left' placeholder='Fegyver sebzse...' error={!form.sebzes} value={form.sebzes} onChange={e => setForm({ ...form, sebzes: e.target.value })}>\r\n                        <Label pointing='right' basic>Sebzs</Label>\r\n                        <input />\r\n                    </Input>\r\n                </div>\r\n                {form.lofegyver &&\r\n                    <div><IntegerInput value={form.lotav} onChange={lotav => setForm({ ...form, lotav })} label='Ltv' /></div>\r\n                }\r\n                <div>\r\n                    <Label pointing='right' basic>Lass:</Label>\r\n                    <Checkbox fitted={true} toggle checked={form.lassu} onChange={() => setForm({ ...form, lassu: !form.lassu })}>\r\n                    </Checkbox>\r\n                </div>\r\n                <div><IntegerInput value={form.tamPerKor} onChange={tamPerKor => setForm({ ...form, tamPerKor })} label={`Tmads krnknt: ${form.lassu ? '1 / ' : ''}`} /></div>\r\n                <div><IntegerInput value={form.erobonusz} onChange={erobonusz => setForm({ ...form, erobonusz })} label={`Minimum er bnuszhoz:`} /></div>\r\n                <div>\r\n                    <Label pointing='right' basic>Pajzs:</Label>\r\n                    <Checkbox fitted={true} toggle checked={form.pajzs} onChange={() => setForm({ ...form, pajzs: !form.pajzs })}>\r\n                    </Checkbox>\r\n                </div>\r\n                <div><IntegerInput disabled={!form.pajzs} value={form.mgt} onChange={mgt => setForm({ ...form, mgt })} label='MGT' /></div>\r\n            </GridColumn>\r\n        </GridRow>\r\n        <GridRow textAlign='center'>\r\n            <GridColumn>\r\n                {!kepzettseg && <Button onClick={() => submit(convertFromFormValues(form))}>Ment</Button>}\r\n                {kepzettseg &&\r\n                    <Button as='div' labelPosition='left'>\r\n                        <Label pointing='right'>\r\n                            Hasznlat szintje\r\n                    </Label>\r\n                        <Button onClick={() => submit(convertFromFormValues(form), 'kpzetlen')}>Kpzetlen</Button>\r\n                        <Button secondary onClick={() => submit(convertFromFormValues(form), 'Af')}>Af</Button>\r\n                        <Button primary onClick={() => submit(convertFromFormValues(form), 'Mf')}>Mf</Button>\r\n                    </Button>\r\n                }\r\n                <Button secondary basic onClick={cancel}>Mgse</Button>\r\n            </GridColumn>\r\n        </GridRow>\r\n    </Grid>;\r\n}","import React, { useCallback, useState } from 'react';\nimport { Button, Grid, GridColumn, GridRow, Header, Label, Modal } from 'semantic-ui-react';\nimport { Fegyver, Karakter, Kepzettseg } from '../engine/karakter';\nimport { FegyverEditor, FEGYVER_KEPZETTSEG } from './FegyverEditor';\nimport { FegyverLista } from './FegyverLista';\n\ninterface FegyverValasztoProps {\n    fegyverek: Array<Fegyver>,\n    karakter: Karakter,\n    save: (karakter: Karakter) => unknown,\n    saveFegyverek: (fegyverek: Array<Fegyver>) => unknown\n}\n\nexport const FegyverValaszto: React.FC<FegyverValasztoProps> = ({ karakter, save, fegyverek, saveFegyverek }) => {\n\n    const [selected, setSelected] = useState<number>();\n    const [selectedForDeletion, setSelectedForDeletion] = useState<number>();\n    const [editorOpen, setEditorOpen] = useState<boolean>(false);\n    const [listEditorOpen, setListEditorOpen] = useState<boolean>(false);\n\n    const saveSelection = useCallback((kepzettsegSzint: FEGYVER_KEPZETTSEG) => {\n        const fegyver = selected !== undefined ? fegyverek[selected] : undefined;\n        if (fegyver) {\n            addFegyverAndKepzettseg(karakter, fegyver, kepzettsegSzint);\n            save(karakter);\n        }\n    }, [karakter, save, selected, fegyverek]);\n\n    const saveDeletion = useCallback(() => {\n        if (selectedForDeletion !== undefined) {\n            karakter.fegyverek = karakter.fegyverek.filter((f, i) => i !== selectedForDeletion);\n            karakter.valasztottFegyver = 0;\n            save(karakter);\n        }\n    }, [karakter, save, selectedForDeletion]);\n\n\n    return <Grid columns={3} relaxed>\n        <GridRow columns='equal'>\n            <GridColumn>\n                <Header size='large'>Vlaszthat\n                    <Modal trigger={<Button floated='right' primary>{selected !== undefined ? 'Mdost' : 'j'}</Button>}\n                        onOpen={() => setListEditorOpen(true)}\n                        onClose={() => setListEditorOpen(false)}\n                        open={listEditorOpen}>\n                        <Modal.Content>\n                            <FegyverEditor\n                                fegyver={selected !== undefined ? fegyverek[selected] : undefined}\n                                submit={f => {\n                                    if (selected === undefined) {\n                                        fegyverek.push(f);\n                                    } else {\n                                        fegyverek[selected] = f;\n                                    }\n                                    saveFegyverek(fegyverek);\n                                    setListEditorOpen(false);\n                                }}\n                                cancel={() => setListEditorOpen(false)} />\n                        </Modal.Content>\n                    </Modal>\n                    <Button floated='right' negative disabled={selected === undefined} onClick={() => {\n                        saveFegyverek(fegyverek.filter((f, i) => i !== selected));\n                    }}>Trl</Button>\n                    <Button floated='right' as='div' labelPosition='left'>\n                        <Label pointing='right'>\n                            Kpzettsg\n                        </Label>\n                        <Button disabled={selected === undefined} onClick={() => saveSelection('kpzetlen')}>Kpzetlen</Button>\n                        <Button secondary disabled={selected === undefined} onClick={() => saveSelection('Af')}>Af</Button>\n                        <Button primary disabled={selected === undefined} onClick={() => saveSelection('Mf')}>Mf</Button>\n                    </Button>\n                </Header>\n                <FegyverLista fegyverek={fegyverek.sort((a, b) => a.name.localeCompare(b.name))} selected={selected} onSelectionChange={setSelected}></FegyverLista>\n            </GridColumn>\n            <GridColumn>\n                <Header size='large'>Viselt\n                    <Modal trigger={<Button floated='right' primary>{selectedForDeletion !== undefined ? 'Mdost' : 'j'}</Button>} onOpen={() => setEditorOpen(true)} onClose={() => setEditorOpen(false)} open={editorOpen}>\n                        <Modal.Content>\n                            <FegyverEditor\n                                kepzettseg\n                                fegyver={selectedForDeletion !== undefined ? karakter.fegyverek[selectedForDeletion] : undefined}\n                                submit={(f, k) => { addFegyverAndKepzettseg(karakter, f, k ?? 'kpzetlen', selectedForDeletion); save(karakter); setEditorOpen(false) }}\n                                cancel={() => setEditorOpen(false)} />\n                        </Modal.Content>\n                    </Modal>\n                    <Button floated='right' negative disabled={selectedForDeletion === undefined} onClick={saveDeletion}>Trl</Button>\n                </Header>\n                <FegyverLista fegyverek={karakter.fegyverek} selected={selectedForDeletion} onSelectionChange={setSelectedForDeletion}></FegyverLista>\n            </GridColumn>\n        </GridRow>\n        <GridRow columns={1} textAlign='center'>\n            <GridColumn>\n                <div>\n                </div>\n            </GridColumn>\n        </GridRow>\n    </Grid>\n}\n\nfunction addFegyverAndKepzettseg(karakter: Karakter, fegyver: Fegyver, kepzettsegSzint: FEGYVER_KEPZETTSEG, idx?: number) {\n    const fIdx = idx ?? karakter.fegyverek.findIndex(f => f.name === fegyver.name);\n    if (fIdx === -1) {\n        karakter.fegyverek.push({ ...fegyver });\n    } else {\n        karakter.fegyverek[fIdx] = fegyver;\n    }\n    karakter.valasztottFegyver = karakter.fegyverek.findIndex(f => f.name === fegyver.name);\n    const kepzettsegName = `Fegyverhasznlat - ${fegyver.name.toLowerCase()}`;\n    karakter.kepzettsegek = (karakter.kepzettsegek ?? []).filter(k => k.name !== kepzettsegName);\n    if (kepzettsegSzint !== 'kpzetlen') {\n        const kepzettseg: Kepzettseg = {\n            name: kepzettsegName,\n            szint: kepzettsegSzint as any,\n            kp: 0\n        };\n        karakter.kepzettsegek.push(kepzettseg);\n    }\n}\n","import React, { useCallback, useEffect, useState } from 'react';\nimport { Button, Table } from 'semantic-ui-react';\nimport { Harcertek, HARCERTEK_DISPLAY_NAMES } from '../engine/harc';\nimport { NumberInput } from './NumberInput';\n\ninterface State {\n    harcertek: Harcertek,\n    hm: number\n};\n\nexport const HMEloszto: React.FC<{ harcertek: Harcertek, hm: number, complete: (harcertek: Harcertek, hm: number) => unknown }> = ({ harcertek, hm, complete }) => {\n    const [current, setCurrent] = useState<State>({ harcertek: { ...harcertek }, hm: hm } as State);\n\n    useEffect(() => {\n        setCurrent({ harcertek: { ...harcertek }, hm });\n    }, [harcertek, hm, setCurrent]);\n\n\n    const change = useCallback((he: ('ke' | 'te' | 've' | 'ce'), newValue: number) => {\n        const newCurrent: State = { ...current };\n        newCurrent.harcertek[he] = newValue;\n        newCurrent.hm = hm - (Object.keys(newCurrent.harcertek) as Array<any>).reduce((acc, curr: ('ke' | 'te' | 've' | 'ce')) => acc + (newCurrent.harcertek[curr] - harcertek[curr]), 0);\n        setCurrent(newCurrent);\n    }, [current, setCurrent, harcertek, hm]);\n\n    return <Table definition striped compact color='orange'>\n        <Table.Header>\n            <Table.Row>\n                <Table.HeaderCell>HM:</Table.HeaderCell>\n                <Table.Cell colSpan={2} style={!current.hm ? { padding: '0' } : {}} textAlign={current.hm ? 'left' : 'center'}>\n                    {current.hm ? current.hm : <Button compact color='green' circular icon='check' content='Eloszt' onClick={() => complete(current.harcertek, current.hm)} />}\n                </Table.Cell>\n            </Table.Row>\n        </Table.Header>\n        <Table.Body>\n            {(Object.keys(harcertek) as Array<any>).map((he: ('ke' | 'te' | 've' | 'ce')) => <Table.Row>\n                <Table.Cell>{HARCERTEK_DISPLAY_NAMES[he]}:</Table.Cell>\n                <Table.Cell collapsing><i>{harcertek[he]}</i></Table.Cell>\n                <Table.Cell collapsing><NumberInput icons value={current.harcertek[he]} min={harcertek[he]} max={(current.harcertek[he] ?? 0) + current.hm} onChange={e => change(he, e ?? 0)} /></Table.Cell>\n            </Table.Row>)}\n        </Table.Body>\n    </Table>\n}","import React, { useState } from 'react';\r\nimport { Modal, Button, Grid, GridColumn, Input, Label } from 'semantic-ui-react';\r\nimport { Karakter, Kepzettseg } from '../engine/karakter';\r\nimport { IntegerInput } from './IntegerInput';\r\n\r\nexport const KepzettsegModal: React.FC<{ karakter: Karakter; save: () => unknown }> = ({ karakter, save }) => {\r\n    const [modalOpen, setModalOpen] = useState(false);\r\n    const [kepzettseg, setKepzettseg] = useState<string>();\r\n    const [szint, setSzint] = useState<number | '1' | '2' | '3' | '4' | '5' | 'Af' | 'Mf'>();\r\n    const [kp, setKp] = useState<number>();\r\n\r\n    const saveKepzettseg = () => {\r\n        karakter.kepzettsegek = karakter.kepzettsegek ?? [];\r\n        if (kepzettseg && szint !== undefined) {\r\n            const curr = karakter.kepzettsegek.findIndex(k => k.name === kepzettseg);\r\n            const newKepzettseg: Kepzettseg = {\r\n                name: kepzettseg,\r\n                szint,\r\n                kp: kp ?? 0\r\n            }\r\n            if (curr !== -1) {\r\n                karakter.kepzettsegek[curr] = newKepzettseg;\r\n            } else {\r\n                karakter.kepzettsegek.push(newKepzettseg);\r\n            }\r\n            save();\r\n            setSzint(undefined);\r\n            setKp(undefined);\r\n            setKepzettseg('');\r\n        }\r\n    }\r\n\r\n    return <Modal trigger={<Button fluid circular icon='plus' content='Hozzad' />} onOpen={() => setModalOpen(true)} onClose={() => setModalOpen(false)} open={modalOpen}>\r\n        <Modal.Content>\r\n            <div style={{ marginBottom: '0.5rem' }}>\r\n                <Input fluid labelPosition='left' placeholder='Kpzettsg...' error={!kepzettseg} value={kepzettseg} onChange={e => setKepzettseg(e.target.value)}>\r\n                    <Label pointing='right' basic>Kpzettsg</Label>\r\n                    <input />\r\n                    <Button circular color='olive' style={{ marginLeft: '1rem' }} onClick={() => setKepzettseg('Nehzvrtviselet')}>Nehzvrtviselet</Button>\r\n                    <Button circular color='olive' style={{ marginLeft: '1rem' }} onClick={() => setKepzettseg('Ktkezes harc')}>Ktkezes harc</Button>\r\n                    <Button circular color='olive' style={{ marginLeft: '1rem' }} onClick={() => setKepzettseg('Pajzshasznlat')}>Pajzshasznlat</Button>\r\n                </Input>\r\n            </div>\r\n            <div style={{ marginBottom: '0.5rem' }}>\r\n                <Grid columns={4}>\r\n                    <GridColumn width={3}>\r\n                        <Button as='div' labelPosition='left'>\r\n                            <Label pointing='right'>\r\n                                Szint\r\n                    </Label>\r\n                            <Button color={szint === 'Af' ? 'black' : 'olive'} onClick={() => setSzint('Af')}>Af</Button>\r\n                            <Button color={szint === 'Mf' ? 'black' : 'olive'} onClick={() => setSzint('Mf')}>Mf</Button>\r\n                        </Button>\r\n                    </GridColumn>\r\n                    <GridColumn width={6} textAlign='center'>\r\n                        {['1', '2', '3', '4', '5'].map(i => <Button color={szint === i ? 'black' : 'olive'} circular onClick={() => setSzint(i as any)}>{i}</Button>)}\r\n                    </GridColumn>\r\n                    <GridColumn width={3} textAlign='left'>\r\n                        <IntegerInput labelPosition='right' label='Szzalk' value={typeof szint === 'number' ? szint : undefined} onChange={v => setSzint(v)} />\r\n                    </GridColumn>\r\n                    <GridColumn width={4} textAlign='right'>\r\n                        <IntegerInput labelPosition='right' label='Elklttt KP' value={kp} onChange={v => setKp(v)} />\r\n                    </GridColumn>\r\n                </Grid>\r\n            </div>\r\n            <div style={{ marginBottom: '0.5rem' }}>\r\n                <Button disabled={!kepzettseg || szint === undefined} onClick={saveKepzettseg}>Ment</Button>\r\n            </div>\r\n        </Modal.Content>\r\n    </Modal>\r\n}","import React from 'react';\nimport { Icon, Table } from 'semantic-ui-react';\nimport { Karakter, Kepzettseg } from '../engine/karakter';\nimport { KepzettsegModal } from './KepzettsegModal';\n\n\nconst compare = (a: Kepzettseg, b: Kepzettseg): number => {\n    if (typeof a.szint === 'number' && typeof b.szint !== 'number') {\n        return 1;\n    }\n    if (typeof b.szint === 'number' && typeof a.szint !== 'number') {\n        return -1;\n    }\n    return a.name.localeCompare(b.name);\n}\n\nexport const KepzettsegLista: React.FC<{ karakter: Karakter, save: () => unknown }> = ({ karakter, save }) => {\n    return <Table striped celled compact color='pink'>\n        <Table.Header>\n            <Table.Row>\n                <Table.HeaderCell>Kpzettsg</Table.HeaderCell>\n                <Table.HeaderCell collapsing>Szint</Table.HeaderCell>\n                <Table.HeaderCell collapsing>KP</Table.HeaderCell>\n                <Table.HeaderCell collapsing></Table.HeaderCell>\n            </Table.Row>\n        </Table.Header>\n        <Table.Body>\n            {karakter.kepzettsegek?.sort(compare).map((r, i) => <Table.Row>\n                <Table.Cell>{r.name}</Table.Cell>\n                <Table.Cell collapsing>{r.szint}</Table.Cell>\n                <Table.Cell collapsing>{r.kp ? r.kp : '-'}</Table.Cell>\n                <Table.Cell collapsing><Icon name='delete' onClick={() => { karakter.kepzettsegek?.splice(i, 1); save() }} /></Table.Cell>\n            </Table.Row>\n            )}\n            <Table.Row key='__new'>\n                <Table.Cell colspan={4}><KepzettsegModal karakter={karakter} save={save} /></Table.Cell>\n            </Table.Row>\n        </Table.Body>\n    </Table>\n\n}","import React from 'react';\nimport { Icon, SemanticCOLORS, Table } from 'semantic-ui-react';\nimport { Pancel } from '../engine/pancel';\n\ninterface PancelListaProps {\n    pancelok?: Array<Pancel>,\n    selected?: number,\n    onSelectionChange?: (newSelection: number | undefined) => unknown\n    extraButton?: JSX.Element;\n    color?: SemanticCOLORS\n}\n\nexport const PancelLista: React.FC<PancelListaProps> = ({ pancelok, selected, onSelectionChange, extraButton, color }) => {\n\n    return <Table compact celled striped definition selectable={onSelectionChange !== undefined} color={color}>\n        <Table.Header>\n            <Table.Row>\n                <Table.HeaderCell>Pncl</Table.HeaderCell>\n                <Table.HeaderCell>SF</Table.HeaderCell>\n                <Table.HeaderCell>MGT</Table.HeaderCell>\n                <Table.HeaderCell>Nehz</Table.HeaderCell>\n            </Table.Row>\n        </Table.Header>\n        <Table.Body>\n            {pancelok?.map((r, i) => <Table.Row key={i} active={selected === i} onClick={() => onSelectionChange?.(selected === i ? undefined : i)}>\n                <Table.Cell>{r.name}</Table.Cell>\n                <Table.Cell>{r.sfe}</Table.Cell>\n                <Table.Cell>{r.mgt}</Table.Cell>\n                <Table.Cell>{r.nehez && <Icon compact color='green' name='check' />}</Table.Cell>\n            </Table.Row>\n            )}\n            {extraButton && <Table.Row key='__extra'>\n                <Table.Cell colspan={4}>{extraButton}</Table.Cell>\n            </Table.Row>}\n        </Table.Body>\n    </Table>\n}","import React, { useEffect, useState } from 'react';\r\nimport { Button, Checkbox, Grid, GridColumn, GridRow, Input, Label } from 'semantic-ui-react';\r\nimport { Pancel } from '../engine/pancel';\r\nimport { IntegerInput } from './IntegerInput';\r\n\r\n\r\n\r\nexport const PancelEditor: React.FC<{ pancel?: Pancel, submit: (pancel: Pancel) => unknown, cancel: () => unknown }> = ({ pancel, submit, cancel }) => {\r\n\r\n    const [form, setForm] = useState<Pancel>(pancel ?? { name: '', mgt: 0, sfe: 0, nehez: false });\r\n\r\n    useEffect(() => {\r\n        setForm(pancel ?? { name: '', mgt: 0, sfe: 0, nehez: false });\r\n    }, [pancel]);\r\n\r\n    return <Grid columns={1} relaxed>\r\n        <GridRow>\r\n            <GridColumn>\r\n                <div>\r\n                    <Input fluid labelPosition='left' placeholder='Fegyver neve...' error={!form.name} value={form.name} onChange={e => setForm({ ...form, name: e.target.value })}>\r\n                        <Label pointing='right' basic>Nv</Label>\r\n                        <input />\r\n                    </Input>\r\n                </div>\r\n                <div><IntegerInput value={form.sfe} onChange={sfe => setForm({ ...form, sfe: sfe ?? 0 })} label='SF' /></div>\r\n                <div><IntegerInput value={form.mgt} onChange={mgt => setForm({ ...form, mgt: mgt ?? 0 })} label='MGT' /></div>\r\n                <div>\r\n                    <Label pointing='right' basic>Nehz:</Label>\r\n                    <Checkbox fitted={true} toggle checked={form.nehez} onChange={() => setForm({ ...form, nehez: !form.nehez })}>\r\n                    </Checkbox>\r\n                </div>\r\n            </GridColumn>\r\n        </GridRow>\r\n        <GridRow textAlign='center'>\r\n            <GridColumn>\r\n                {!!form.name && <Button onClick={() => submit(form)}>Ment</Button>}\r\n                <Button secondary basic onClick={cancel}>Mgse</Button>\r\n            </GridColumn>\r\n        </GridRow>\r\n    </Grid>;\r\n}","import React, { useCallback, useState } from 'react';\r\nimport { Button, Grid, GridColumn, GridRow, Header, Modal } from 'semantic-ui-react';\r\nimport { Karakter } from '../engine/karakter';\r\nimport { Pancel } from '../engine/pancel';\r\nimport { PancelEditor } from './PancelEditor';\r\nimport { PancelLista } from './PancelLista';\r\n\r\ninterface PancelValasztoProps {\r\n    pancelok: Array<Pancel>,\r\n    karakter: Karakter,\r\n    save: (karakter: Karakter) => unknown,\r\n    savePancelok: (pancelok: Array<Pancel>) => unknown\r\n}\r\n\r\nexport const PancelValaszto: React.FC<PancelValasztoProps> = ({ karakter, save, pancelok, savePancelok }) => {\r\n\r\n    const [selected, setSelected] = useState<number>();\r\n    const [selectedForDeletion, setSelectedForDeletion] = useState<number>();\r\n    const [editorOpen, setEditorOpen] = useState<boolean>(false);\r\n    const [listEditorOpen, setListEditorOpen] = useState<boolean>(false);\r\n\r\n    const saveDeletion = useCallback(() => {\r\n        if (selectedForDeletion !== undefined) {\r\n            karakter.pancelok = karakter.pancelok?.filter((f, i) => i !== selectedForDeletion);\r\n            karakter.valasztottPancel = undefined;\r\n            save(karakter);\r\n        }\r\n    }, [karakter, save, selectedForDeletion]);\r\n\r\n    return <Grid columns={3} relaxed>\r\n        <GridRow columns='equal'>\r\n            <GridColumn>\r\n                <Header size='large'>Vlaszthat\r\n                    <Button floated='right' secondary disabled={selected === undefined || (karakter.pancelok ?? []).some(p => p.name === pancelok[selected].name)} onClick={() => {\r\n                        karakter.pancelok = karakter.pancelok ?? [];\r\n                        if (selected && karakter.pancelok.every(p => p.name !== pancelok[selected].name)) {\r\n                            karakter.pancelok.push(pancelok[selected]);\r\n                            save(karakter);\r\n                        }\r\n                    }}>Vlaszt</Button>\r\n                    <Modal trigger={<Button floated='right' primary>{selected !== undefined ? 'Mdost' : 'j'}</Button>}\r\n                        onOpen={() => setListEditorOpen(true)}\r\n                        onClose={() => setListEditorOpen(false)}\r\n                        open={listEditorOpen}>\r\n                        <Modal.Content>\r\n                            <PancelEditor\r\n                                pancel={selected !== undefined ? pancelok[selected] : undefined}\r\n                                submit={f => {\r\n                                    if (selected === undefined) {\r\n                                        pancelok.push(f);\r\n                                    } else {\r\n                                        pancelok[selected] = f;\r\n                                    }\r\n                                    savePancelok(pancelok);\r\n                                    setListEditorOpen(false);\r\n                                }}\r\n                                cancel={() => setListEditorOpen(false)} />\r\n                        </Modal.Content>\r\n                    </Modal>\r\n                    <Button floated='right' negative disabled={selected === undefined} onClick={() => {\r\n                        savePancelok(pancelok.filter((f, i) => i !== selected));\r\n                    }}>Trl</Button>\r\n                </Header>\r\n                <PancelLista pancelok={pancelok.sort((a, b) => a.name.localeCompare(b.name))} selected={selected} onSelectionChange={setSelected} />\r\n            </GridColumn>\r\n            <GridColumn>\r\n                <Header size='large'>Viselt\r\n                    <Modal trigger={<Button floated='right' primary>{selectedForDeletion !== undefined ? 'Mdost' : 'j'}</Button>} onOpen={() => setEditorOpen(true)} onClose={() => setEditorOpen(false)} open={editorOpen}>\r\n                        <Modal.Content>\r\n                            <PancelEditor\r\n                                pancel={selectedForDeletion !== undefined ? karakter.pancelok?.[selectedForDeletion] : undefined}\r\n                                submit={p => {\r\n                                    karakter.pancelok = karakter.pancelok ?? [];\r\n                                    if (selectedForDeletion !== undefined) {\r\n                                        karakter.pancelok[selectedForDeletion] = p;\r\n                                    } else {\r\n                                        karakter.pancelok.push(p);\r\n                                    }\r\n                                    save(karakter);\r\n                                    setEditorOpen(false)\r\n                                }}\r\n                                cancel={() => setEditorOpen(false)} />\r\n                        </Modal.Content>\r\n                    </Modal>\r\n                    <Button floated='right' negative disabled={selectedForDeletion === undefined} onClick={saveDeletion}>Trl</Button>\r\n                </Header>\r\n                <PancelLista pancelok={karakter.pancelok} selected={selectedForDeletion} onSelectionChange={setSelectedForDeletion}></PancelLista>\r\n            </GridColumn>\r\n        </GridRow>\r\n        <GridRow columns={1} textAlign='center'>\r\n            <GridColumn>\r\n                <div>\r\n                </div>\r\n            </GridColumn>\r\n        </GridRow>\r\n    </Grid>\r\n}\r\n","import React from 'react';\nimport { Table } from 'semantic-ui-react';\nimport { Pajzs } from '../engine/karakter';\nimport { NumberInput } from './NumberInput';\n\n\n\n\n\nexport const Pajzsok: React.FC<{ pajzs: { asztral: Pajzs, mental: Pajzs }, onChange: (pajzs: { asztral: Pajzs, mental: Pajzs }) => unknown }> = ({ pajzs, onChange }) => {\n    return <Table striped celled definition fluid compact color='red'>\n        <Table.Header>\n            <Table.Row>\n                <Table.HeaderCell>Pajzsok</Table.HeaderCell>\n                <Table.HeaderCell collapsing>Asztrl</Table.HeaderCell>\n                <Table.HeaderCell collapsing>Mentl</Table.HeaderCell>\n            </Table.Row>\n\n        </Table.Header>\n        <Table.Body>\n            <Table.Row>\n                <Table.HeaderCell>Termszetes</Table.HeaderCell>\n                <Table.Cell collapsing><NumberInput icons value={pajzs.asztral.termeszetes} min={0} max={1000} onChange={(e: number) => { pajzs.asztral.termeszetes = e; onChange(pajzs) }} /></Table.Cell>\n                <Table.Cell collapsing><NumberInput icons value={pajzs.mental.termeszetes} min={0} max={1000} onChange={(e: number) => { pajzs.mental.termeszetes = e; onChange(pajzs) }} /></Table.Cell>\n            </Table.Row>\n            <Table.Row>\n                <Table.HeaderCell>Statikus</Table.HeaderCell>\n                <Table.Cell collapsing><NumberInput icons value={pajzs.asztral.statikus} min={0} max={1000} onChange={(e: number) => { pajzs.asztral.statikus = e; onChange(pajzs) }} /></Table.Cell>\n                <Table.Cell collapsing><NumberInput icons value={pajzs.mental.statikus} min={0} max={1000} onChange={(e: number) => { pajzs.mental.statikus = e; onChange(pajzs) }} /></Table.Cell>\n            </Table.Row>\n            <Table.Row>\n                <Table.HeaderCell>Dinamikus</Table.HeaderCell>\n                <Table.Cell collapsing><NumberInput icons value={pajzs.asztral.dinamikus} min={0} max={1000} onChange={(e: number) => { pajzs.asztral.dinamikus = e; onChange(pajzs) }} /></Table.Cell>\n                <Table.Cell collapsing><NumberInput icons value={pajzs.mental.dinamikus} min={0} max={1000} onChange={(e: number) => { pajzs.mental.dinamikus = e; onChange(pajzs) }} /></Table.Cell>\n            </Table.Row>\n            <Table.Row>\n                <Table.HeaderCell>sszeg</Table.HeaderCell>\n                <Table.Cell collapsing><b>{pajzs.asztral.termeszetes + pajzs.asztral.statikus + pajzs.asztral.dinamikus}</b></Table.Cell>\n                <Table.Cell collapsing><b>{pajzs.mental.termeszetes + pajzs.mental.statikus + pajzs.mental.dinamikus}</b></Table.Cell>\n            </Table.Row>\n        </Table.Body>\n    </Table>\n\n}","import React from 'react';\r\nimport { Table } from 'semantic-ui-react';\r\nimport { Karakter } from '../engine/karakter';\r\n\r\nexport const Jegyzetek: React.FC<{ karakter: Karakter, save: () => unknown }> = ({ karakter, save }) => <Table celled fluid compact color='yellow'>\r\n    <Table.Header>\r\n        <Table.Row>\r\n            <Table.HeaderCell>Jegyzetek</Table.HeaderCell>\r\n        </Table.Row>\r\n\r\n    </Table.Header>\r\n    <Table.Body>\r\n        <Table.Row>\r\n            <Table.Cell style={{ padding: '0' }}>\r\n                <textarea style={{ borderRadius: '0.25em', height: '10em', width: '100%' }} value={karakter.jegyzetek ?? ''} onChange={e => { karakter.jegyzetek = e.target.value; save(); }} />\r\n            </Table.Cell>\r\n        </Table.Row>\r\n    </Table.Body>\r\n</Table>;\r\n","import React, { forwardRef, useEffect, useImperativeHandle, useState } from 'react';\r\nimport { Input } from 'semantic-ui-react';\r\n\r\nexport interface EditableTextProps {\r\n    text?: string;\r\n    onChange: (text: string) => unknown;\r\n}\r\n\r\nexport const EditableText = forwardRef<any, EditableTextProps>(({ text, onChange }, ref) => {\r\n    const [editedText, setEditedText] = useState<string>('');\r\n    const [edited, setEdited] = useState<boolean>(false);\r\n    useImperativeHandle(ref, () => ({\r\n        edit: () => setEdited(true)\r\n    }));\r\n    useEffect(() => {\r\n        setEditedText(text ?? '');\r\n    }, [text]);\r\n    if (edited) {\r\n        return <form onSubmit={() => { setEdited(false); onChange(editedText) }}><Input transparent autoFocus value={editedText} onChange={(e, { value }) => { setEditedText(value) }} onBlur={() => { setEdited(false); onChange(editedText) }} /></form>\r\n    } else {\r\n        return <span onClick={() => setEdited(true)}>{text ?? ''}</span>;\r\n    }\r\n});\r\n","import React from 'react';\r\nimport { Button, Icon, Table } from 'semantic-ui-react';\r\nimport { Karakter } from '../engine/karakter';\r\nimport { EditableText } from '../story/components/EditableText';\r\nimport { NumberInput } from './NumberInput';\r\n\r\nexport const Felszereles: React.FC<{ karakter: Karakter, save: () => unknown }> = ({ karakter, save }) => {\r\n\r\n    const rowRefs: Record<string, { current: any }> = {};\r\n\r\n    return <Table celled fluid compact color='blue'>\r\n        <Table.Header>\r\n            <Table.Row>\r\n                <Table.HeaderCell>Felszerels</Table.HeaderCell>\r\n                <Table.HeaderCell>Mennyisg</Table.HeaderCell>\r\n                <Table.HeaderCell />\r\n            </Table.Row>\r\n        </Table.Header>\r\n        <Table.Body>\r\n            {karakter.felszereles?.map((f, i) => <Table.Row key={f.name}>\r\n                <Table.Cell onClick={() => rowRefs[f.name].current.edit()}>\r\n                    <EditableText ref={ref => rowRefs[f.name] = { current: ref }} text={f.name} onChange={v => { f.name = v; save() }} />\r\n                </Table.Cell>\r\n                <Table.Cell collapsing>\r\n                    <NumberInput min={0} max={10000} value={f.qty} onChange={q => { f.qty = q; save() }} icons />\r\n                </Table.Cell>\r\n                <Table.Cell collapsing>\r\n                    <Icon name='delete' onClick={() => { karakter.felszereles?.splice(i, 1); save() }} />\r\n                </Table.Cell>\r\n            </Table.Row>\r\n            )}\r\n            <Table.Row>\r\n                <Table.Cell colSpan={3} >\r\n                    <Button fluid circular icon='plus' content='Hozzad' onClick={() => { karakter.felszereles = [...(karakter.felszereles ?? []), { name: '', qty: 1 }]; save(); }} />\r\n                </Table.Cell>\r\n\r\n            </Table.Row>\r\n\r\n        </Table.Body>\r\n    </Table>;\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Modal, Button, Input, Grid, GridColumn } from 'semantic-ui-react';\r\n\r\nexport const KategoriaEditor: React.FC<{ categories: Array<string>, save: (value: string) => unknown }> = ({ categories, save }) => {\r\n    const [kategoriak, setKategoriak] = useState(false);\r\n    const [ujKategoria, setUjKategoria] = useState('');\r\n\r\n    return <Modal trigger={<Button floated='right' size='tiny' circular compact color='orange'>+</Button>} onOpen={() => setKategoriak(true)} onClose={() => setKategoriak(false)} open={kategoriak} size='mini' title='j kategria'>\r\n        <Modal.Header>j kategria</Modal.Header>\r\n        <Modal.Content>\r\n            <Grid columns={2} fluid relaxed>\r\n                <GridColumn>\r\n                    <Input list='categories' value={ujKategoria} onChange={e => setUjKategoria(e.target.value)} />\r\n                    <datalist id='categories'>\r\n                        {categories.map(c => <option value={c}>{c}</option>)}\r\n                    </datalist>\r\n                </GridColumn>\r\n                <GridColumn>\r\n                    <Button fluid primary onClick={() => { save(ujKategoria); setKategoriak(false); }}>Hozzad</Button>\r\n                </GridColumn>\r\n            </Grid>\r\n        </Modal.Content>\r\n    </Modal>\r\n\r\n}","import fileDownload from 'js-file-download';\r\nimport React, { useState } from 'react';\r\nimport { Button, Confirm, Icon, Label, Table } from 'semantic-ui-react';\r\nimport { Karakter, szintlepes } from '../engine/karakter';\r\nimport { EditableText } from '../story/components/EditableText';\r\nimport { KategoriaEditor } from './KategoriaEditor';\r\n\r\ninterface KarakterTablaProps {\r\n    karakter: Karakter;\r\n    save: (karakter: Karakter) => unknown;\r\n    categories: Array<string>;\r\n    clone: (karakter: Karakter) => Karakter;\r\n    remove: () => unknown\r\n\r\n}\r\n\r\nexport const KarakterTabla: React.FC<KarakterTablaProps> = ({ karakter, save, categories, clone, remove }) => {\r\n\r\n    const [torlesKerdes, setTorlesKerdes] = useState(false);\r\n\r\n    const exportKarakter = () => {\r\n        fileDownload(JSON.stringify(karakter), `${karakter.name}.json`, 'text/json');\r\n    }\r\n\r\n\r\n    return <Table striped definition compact>\r\n        <Table.Row><Table.Cell>Nv:</Table.Cell><Table.Cell><EditableText text={karakter.name} onChange={n => { karakter.name = n; save(karakter); }} /> </Table.Cell></Table.Row>\r\n        <Table.Row><Table.Cell>Faj:</Table.Cell><Table.Cell>{karakter.faj}</Table.Cell></Table.Row>\r\n        <Table.Row><Table.Cell>Kaszt:</Table.Cell><Table.Cell>{karakter.kaszt.name}</Table.Cell></Table.Row>\r\n        <Table.Row><Table.Cell>Szint:</Table.Cell>\r\n            <Table.Cell>\r\n                <Button as='div' labelPosition='left'>\r\n                    <Label pointing='right'>\r\n                        {karakter.szint}\r\n                    </Label>\r\n                    <Button secondary compact onClick={() => { save(szintlepes(karakter)) }}>Szintlps</Button>\r\n                </Button>\r\n            </Table.Cell>\r\n        </Table.Row>\r\n        <Table.Row>\r\n            <Table.Cell>Kategrik\r\n        <       KategoriaEditor categories={categories} save={value => { karakter.categories = [...new Set([...karakter.categories, value])]; save(karakter) }} />\r\n            </Table.Cell>\r\n            <Table.Cell>\r\n                {karakter.categories.map(c => <Label tag>{c} <Icon name='delete' onClick={() => { karakter.categories = karakter.categories.filter(value => value !== c); save(karakter) }} /></Label>)}\r\n            </Table.Cell>\r\n        </Table.Row>\r\n        <Table.Row>\r\n            <Table.Cell colSpan={2}>\r\n                <Button onClick={() => setTorlesKerdes(true)} color='red' compact circular>Karakter trlse</Button>\r\n                <Confirm\r\n                    open={torlesKerdes}\r\n                    onCancel={() => setTorlesKerdes(false)}\r\n                    onConfirm={() => { setTorlesKerdes(false); remove() }}\r\n                    header='Karakter trlse'\r\n                    content='Tuti?'\r\n                    cancelButton='Nem'\r\n                    confirmButton='De' />\r\n                <Button onClick={exportKarakter} color='green' circular compact>Export</Button>\r\n                <Button onClick={() => clone(karakter)} color='green' circular compact>Kln</Button>\r\n            </Table.Cell>\r\n        </Table.Row>\r\n    </Table>;\r\n}","import React from 'react';\nimport { Button, Grid, GridColumn, GridRow, Modal } from 'semantic-ui-react';\nimport { DobasMatrixDisplay } from '../components/DobasMatrixDisplay';\nimport { PointsTable } from '../components/PointsTable';\nimport { FegyverLista } from '../components/FegyverLista';\nimport { FegyverValaszto } from '../components/FegyverValaszto';\nimport { HMEloszto } from '../components/HMEloszto';\nimport { KepzettsegLista } from '../components/KepzettsegLista';\nimport { DobasMatrix } from '../engine/dobasmatrix';\nimport { HARCERTEK_DISPLAY_NAMES } from '../engine/harc';\nimport { calculateHarcertek, calculateMGT, Fegyver, folottiResz, Karakter, KarakterKepesseg } from '../engine/karakter';\nimport { KEPESSEG_NEV } from '../engine/kasztok';\nimport { PancelLista } from '../components/PancelLista';\nimport { PancelValaszto } from '../components/PancelValaszto';\nimport { Pancel } from '../engine/pancel';\nimport { Pajzsok } from '../components/Pajzsok';\nimport { Jegyzetek } from '../components/Jegyzetek';\nimport { Felszereles } from '../components/Felszereles';\nimport { KarakterTabla } from '../components/KarakterTabla';\n\ninterface KarakterlapProps {\n    categories: Array<string>,\n    karakter: Karakter,\n    fegyverek: Array<Fegyver>,\n    pancelok: Array<Pancel>,\n    savePancelok: (pancelok: Array<Pancel>) => unknown,\n    save: (karakter: Karakter) => unknown,\n    clone: (karakter: Karakter) => Karakter;\n\n    saveFegyverek: (fegyverek: Array<Fegyver>) => unknown,\n    remove: () => unknown\n}\n\nexport const Karakterlap: React.FC<KarakterlapProps> = ({ karakter, save, remove, categories, fegyverek, saveFegyverek, pancelok, savePancelok, clone }) => {\n\n    const points = [\n        { name: 'ep', label: 'P', ...karakter.ep },\n        { name: 'fp', label: 'FP', ...karakter.fp }];\n    if (karakter.pszi) {\n        points.push({ name: 'pszi', label: 'P', ...karakter.pszi })\n    }\n    if (karakter.mp) {\n        points.push({ name: 'mp', label: 'MP', ...karakter.mp })\n    }\n\n    const mgt = calculateMGT(karakter);\n    const kepessegMatrix = new DobasMatrix(Object.keys(KEPESSEG_NEV)).add('alap', karakter.kepessegek as any);\n    if (mgt[0] > 0) {\n        kepessegMatrix.add('mgt', { gy: -mgt[0], ugy: -mgt[0] });\n    }\n    kepessegMatrix.roll();\n\n\n\n    return <Grid relaxed>\n        <GridColumn width={4} >\n            <KarakterTabla karakter={karakter} categories={categories} save={save} clone={clone} remove={remove} />\n            {karakter.hm > 0 && <div><HMEloszto harcertek={karakter.hmHarcertek} hm={karakter.hm} complete={(he, hm) => {\n                karakter.hmHarcertek = he;\n                karakter.hm = hm;\n                save(karakter);\n            }} /> </div>}\n            <PointsTable color='olive'\n                points={points}\n                onChange={(name, max, value) => {\n                    (karakter as any)[name][max ? 'max' : 'akt'] = value;\n                    save(karakter);\n                }}\n            />\n            <Pajzsok\n                pajzs={karakter.pajzs ?? {\n                    asztral: { termeszetes: folottiResz(karakter.kepessegek.asz, 10), statikus: 0, dinamikus: 0 },\n                    mental: { termeszetes: folottiResz(karakter.kepessegek.ae, 10), statikus: 0, dinamikus: 0 }\n                }}\n                onChange={pajzs => { karakter.pajzs = pajzs; save(karakter); }}\n            />\n            <DobasMatrixDisplay\n                color='purple'\n                title='Kpessgek'\n                matrix={kepessegMatrix}\n                direction='vertical'\n                editable={['alap']}\n                numberOnly\n                keyMap={KEPESSEG_NEV}\n                setValue={(_, key, value) => { karakter.kepessegek[key as keyof KarakterKepesseg] = Number(value); save(karakter); }} />\n        </GridColumn>\n        <GridColumn width={12} >\n            <Grid columns={2}>\n                <GridRow>\n                    <GridColumn>\n                        <DobasMatrixDisplay color='orange' title='Harcrtkek' matrix={calculateHarcertek(karakter).roll(['te', 've', 'ce', 'ke'])} direction='vertical' keyMap={HARCERTEK_DISPLAY_NAMES} />\n                        <FegyverLista color='green' fegyverek={karakter.fegyverek} selected={karakter.valasztottFegyver} onSelectionChange={f => { karakter.valasztottFegyver = f; save(karakter) }}\n                            extraButton={<Modal trigger={<Button fluid circular icon='edit' content='Fegyverlista szerkesztse' />} size='fullscreen'>\n                                <Modal.Header>Fegyverek</Modal.Header>\n                                <Modal.Content>\n                                    <FegyverValaszto saveFegyverek={saveFegyverek} fegyverek={fegyverek} karakter={karakter} save={k => { save(k); }} />\n                                </Modal.Content>\n                            </Modal>} />\n                        <PancelLista color='teal' pancelok={karakter.pancelok} selected={karakter.valasztottPancel} onSelectionChange={f => { karakter.valasztottPancel = f; save(karakter) }}\n                            extraButton={<Modal trigger={<Button fluid circular icon='edit' content='Pncllista szerkesztse' />} size='fullscreen'>\n                                <Modal.Header>Pnclok</Modal.Header>\n                                <Modal.Content>\n                                    <PancelValaszto savePancelok={savePancelok} pancelok={pancelok} karakter={karakter} save={save} />\n                                </Modal.Content>\n                            </Modal>\n                            } />\n                        <KepzettsegLista karakter={karakter} save={() => save(karakter)} />\n                    </GridColumn>\n                    <GridColumn>\n                        {(karakter.masodlagosFegyverMutat ?? true) && <>\n                            {karakter.masodlagosFegyver !== undefined && <div><DobasMatrixDisplay color='orange' title='Msodlagos harcrtkek' matrix={calculateHarcertek(karakter, undefined, true).roll(['te', 've', 'ce', 'ke'])} direction='vertical' keyMap={HARCERTEK_DISPLAY_NAMES} /></div>}\n                            <FegyverLista color='green' title='Msodlagos fegyver' fegyverek={karakter.fegyverek} selected={karakter.masodlagosFegyver} onSelectionChange={f => { karakter.masodlagosFegyver = f; save(karakter) }}\n                                extraButton={<Modal trigger={<Button fluid circular icon='edit' content='Fegyverlista szerkesztse' />} size='fullscreen'>\n                                    <Modal.Header>Fegyverek</Modal.Header>\n                                    <Modal.Content>\n                                        <FegyverValaszto saveFegyverek={saveFegyverek} fegyverek={fegyverek} karakter={karakter} save={k => { save(k); }} />\n                                    </Modal.Content>\n                                </Modal>} />\n                        </>}\n                        <Button fluid circular icon={(karakter.masodlagosFegyverMutat ?? true) ? 'eye slash' : 'eye'} content='Msodlagos fegyver' onClick={() => {\n                            karakter.masodlagosFegyverMutat = !(karakter.masodlagosFegyverMutat ?? true);\n                            save(karakter);\n                        }} />\n                        <Felszereles karakter={karakter} save={() => save(karakter)} />\n                        <Jegyzetek karakter={karakter} save={() => save(karakter)} />\n                    </GridColumn>\n                </GridRow>\n            </Grid>\n        </GridColumn>\n    </Grid>\n}","\r\nexport interface Pancel {\r\n    name: string;\r\n    sfe: number;\r\n    mgt: number;\r\n    nehez?: boolean;\r\n}\r\n\r\nexport const PANCELOK: Array<Pancel> = [\r\n    { name: 'poszt', sfe: 1, mgt: 0 },\r\n    { name: 'kivert br', sfe: 1, mgt: 0 },\r\n    { name: 'kemnytett br', sfe: 2, mgt: 2 },\r\n    { name: 'gyrs', sfe: 1, mgt: 1 },\r\n    { name: 'brigantin', sfe: 3, mgt: 2 },\r\n    { name: 'lncing', sfe: 2, mgt: 1 },\r\n    { name: 'sodronying', sfe: 3, mgt: 1 },\r\n    { name: 'pikkelyvrt', sfe: 3, mgt: 2 },\r\n    { name: 'lemezvrtezet', sfe: 3, mgt: 3, nehez: true },\r\n    { name: 'mellvrt', sfe: 4, mgt: 4, nehez: true },\r\n    { name: 'flvrtezet', sfe: 5, mgt: 6, nehez: true },\r\n    { name: 'teljes vrtezet', sfe: 6, mgt: 8, nehez: true }\r\n]","import { useState } from \"react\";\nimport { v4 } from \"uuid\";\nimport { FEGYVEREK } from \"../engine/harc\";\nimport { Fegyver, Karakter, KarakterInfo, KarakterV1 } from \"../engine/karakter\";\nimport { FAJ_KEPESSEG, KepessegDobas } from \"../engine/kasztok\";\nimport { Pancel, PANCELOK } from \"../engine/pancel\";\n\nconst PREFIX = 'magus.';\nconst CONFIG_PREFIX = 'magus-config.';\nconst STORY_KEY = 'magus-story';\n\ninterface DataConnector {\n    categories: () => Array<string>;\n    list: (category?: string) => Array<KarakterInfo>;\n    load: (info: KarakterInfo) => Karakter;\n    save: (karakter: Karakter) => void;\n    clone: (karakter: Karakter) => Karakter;\n    remove: (info: KarakterInfo) => void;\n    listFajok: () => Record<string, KepessegDobas>;\n    listFegyverek: () => Array<Fegyver>;\n    saveFegyverek: (fegyverek: Array<Fegyver>) => void;\n    listPancelok: () => Array<Pancel>;\n    savePancelok: (pancelok: Array<Pancel>) => void;\n    loadStory: () => string,\n    saveStory: (story: string) => unknown;\n    key?: number;\n}\n\nexport function useDataConnector(): DataConnector {\n\n    const [operations, setOperations] = useState(0);\n\n    function fetch<T>(name: string): T {\n        const s = window.localStorage.getItem(name);\n        return s ? JSON.parse(s) : null;\n    };\n\n    function put(name: string, ob: any) {\n        window.localStorage.setItem(name, JSON.stringify(ob));\n        setOperations(operations + 1);\n    }\n\n    const categories = (): Array<string> => {\n        return [...new Set(list().flatMap(info => info.categories))];\n    }\n\n    const list = (category?: string): Array<KarakterInfo> => {\n        const all: Array<KarakterInfo> = [...Array(window.localStorage.length)].map((_, i) => window.localStorage.key(i) ?? '').filter(key => key.startsWith(PREFIX)).map(key => fetch(key));\n        if (!category) {\n            return all.sort((a, b) => a.name.localeCompare(b.name));\n        }\n        return all.filter(k => k.categories.some(cat => cat === category)).sort((a, b) => a.name.localeCompare(b.name));\n    };\n\n    const load = (info: KarakterInfo): Karakter => {\n        const karakter: Karakter | KarakterV1 = fetch(PREFIX + info.id);\n        if (karakter.version === 2) {\n            return karakter;\n        }\n        //Convert v1 to v2\n        (karakter as any).version = 2;\n        (karakter as any).ep = { max: karakter.maxEp, akt: karakter.ep };\n        (karakter as any).fp = { max: karakter.maxFp, akt: karakter.fp };\n        return karakter as unknown as Karakter;\n    };\n\n    const save = (karakter: Karakter): void => {\n        put(PREFIX + karakter.id, karakter);\n    };\n\n    const clone = (karakter: Karakter): Karakter => {\n        const karakterek = list();\n        let newNev: string;\n        let i = 2;\n        do {\n            newNev = `${karakter.name} (${i})`;\n            i++;\n            // eslint-disable-next-line no-loop-func\n        } while (karakterek.some(k => k.name === newNev));\n\n        const ret = { ...karakter, id: v4(), name: newNev };\n        save(ret);\n        return ret;\n    }\n\n    const remove = (info: KarakterInfo) => {\n        window.localStorage.removeItem(PREFIX + info.id);\n    }\n\n    (window as any).exportMagus = () => {\n        const ret: Record<string, any> = {};\n        list('').forEach(key => {\n            ret[key.id] = load(key);\n        })\n        console.log('export', JSON.stringify(ret));\n    }\n\n    (window as any).importMagus = (content: string) => {\n        const all = JSON.parse(content);\n        Object.keys(all).forEach(key => save(all[key]));\n        console.log('import complete');\n    }\n\n\n    return {\n        categories,\n        list,\n        load,\n        save,\n        clone,\n        remove,\n        listFajok: () => FAJ_KEPESSEG,\n        listFegyverek: () => {\n            let ret = fetch<Array<Fegyver>>(CONFIG_PREFIX + 'fegyverek');\n            if (!ret) {\n                put(CONFIG_PREFIX + 'fegyverek', FEGYVEREK);\n                ret = FEGYVEREK;\n            }\n            return ret;\n        },\n        saveFegyverek: fegyverek => put(CONFIG_PREFIX + 'fegyverek', fegyverek),\n        listPancelok: () => {\n            let ret = fetch<Array<Pancel>>(CONFIG_PREFIX + 'pancelok');\n            if (!ret) {\n                put(CONFIG_PREFIX + 'pancelok', PANCELOK);\n                ret = PANCELOK;\n            }\n            return ret;\n        },\n        savePancelok: pancelok => put(CONFIG_PREFIX + 'pancelok', pancelok),\n        loadStory: () => fetch(STORY_KEY) ?? '<story/>',\n        saveStory: (story: string) => put(STORY_KEY, story),\n        key: operations\n    }\n}","import React from 'react';\r\nimport { Dropdown } from 'semantic-ui-react';\r\n\r\ninterface CategoriesDropdownProps {\r\n    categories: Array<string>;\r\n    currentCategory: string;\r\n    setCurrentCategory: (category: string) => unknown\r\n}\r\n\r\nexport const CategoriesDropdown: React.FC<CategoriesDropdownProps> = ({ currentCategory, setCurrentCategory, categories }) => {\r\n    return <Dropdown item text={`Karakterek: ${currentCategory || 'sszes'}`}>\r\n        <Dropdown.Menu>\r\n            <Dropdown.Item key='__all' onClick={() => setCurrentCategory('')}>sszes</Dropdown.Item>\r\n            {categories.map(k => <Dropdown.Item key={k} onClick={() => setCurrentCategory(k)}>{k}</Dropdown.Item>)}\r\n        </Dropdown.Menu>\r\n    </Dropdown>\r\n}","import React, { Component, ReactNode } from 'react'\r\n\r\nexport interface DragAndDropProps {\r\n    handleDrop: (files: FileList) => unknown;\r\n    dragPlaceholder: ReactNode\r\n}\r\n\r\nclass DragAndDrop extends Component<DragAndDropProps, {}> {\r\n    state = {\r\n        drag: false\r\n    }\r\n    dropRef = React.createRef<HTMLDivElement>();\r\n    dragCounter = 0;\r\n\r\n    handleDrag = (e: Event) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n    }\r\n\r\n    handleDragIn = (e: DragEvent) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n        this.dragCounter++\r\n        if (e.dataTransfer?.items && e.dataTransfer.items.length > 0) {\r\n            this.setState({ drag: true })\r\n        }\r\n    }\r\n    handleDragOut = (e: DragEvent) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n        this.dragCounter--\r\n        if (this.dragCounter === 0) {\r\n            this.setState({ drag: false })\r\n        }\r\n    }\r\n    handleDrop = (e: DragEvent) => {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n        this.setState({ drag: false })\r\n        if (e.dataTransfer?.files && e.dataTransfer.files.length > 0) {\r\n            this.props.handleDrop(e.dataTransfer.files)\r\n            e.dataTransfer.clearData()\r\n            this.dragCounter = 0\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        let div = this.dropRef.current;\r\n        if (div) {\r\n            div.addEventListener('dragenter', this.handleDragIn)\r\n            div.addEventListener('dragleave', this.handleDragOut)\r\n            div.addEventListener('dragover', this.handleDrag)\r\n            div.addEventListener('drop', this.handleDrop)\r\n        }\r\n    }\r\n    componentWillUnmount() {\r\n        let div = this.dropRef.current;\r\n        if (div) {\r\n            div.removeEventListener('dragenter', this.handleDragIn)\r\n            div.removeEventListener('dragleave', this.handleDragOut)\r\n            div.removeEventListener('dragover', this.handleDrag)\r\n            div.removeEventListener('drop', this.handleDrop)\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div\r\n                style={{ display: 'inline-block', position: 'relative' }}\r\n                ref={this.dropRef}\r\n            >\r\n                {this.state.drag ? this.props.dragPlaceholder : this.props.children}\r\n            </div>\r\n        )\r\n    }\r\n}\r\nexport default DragAndDrop","import React from 'react';\r\nimport { Button, Icon } from 'semantic-ui-react';\r\nimport { Karakter } from '../engine/karakter';\r\nimport DragAndDrop from './DragAndDrop';\r\n\r\nexport const KarakterImport: React.FC<{ save: (karakter: Karakter) => unknown, saveMese: (story: string) => unknown }> = ({ save, saveMese }) => {\r\n    return <DragAndDrop\r\n        dragPlaceholder={<Button circular as='div' color='green'><Icon name='upload' />Import</Button>}\r\n        handleDrop={async l => {\r\n            const text = await l.item(0)?.text();\r\n            const mese = l.item(0)?.name.endsWith('.xml');\r\n            if (text) {\r\n                if (mese) {\r\n                    saveMese(text);\r\n                } else {\r\n                    save(JSON.parse(text));\r\n                }\r\n            }\r\n        }}>\r\n        <Button circular basic as='div' color='green'><Icon name='upload' />Import</Button>\r\n    </DragAndDrop>\r\n\r\n}","import React, { useCallback, useReducer, useState } from 'react';\nimport { DiceRollResult, formatDiceRoll, parseDiceRoll, roll } from '../engine/roll';\nimport { DobasEredmeny } from '../components/DobasEredmeny';\nimport { Button, Dropdown, Grid, GridColumn, GridRow, Header, Input, Label } from 'semantic-ui-react';\nimport { IntegerInput } from '../components/IntegerInput';\nconst { Slider } = require('react-semantic-ui-range');\n\nconst DICE_ROLLS = [2, 3, 5, 6, 10, 100];\nconst PLUS = [1, 2, 3, 5, 10];\nconst HISTORY_LENGTH = 10;\n\nconst MERETEK: Record<string, number> = {\n    'ris': -30,\n    'l': -15,\n    'ember': 0,\n    'kutya': 20,\n    'dinnya': 35,\n    'alma': 50,\n    'fmpnz': 65\n}\n\nconst MOZGASOK: Record<string, number> = {\n    'mozdulatlan': 0,\n    'kiszmthatan mozg': 20,\n    'kiszmthatatlanul mozg': 35,\n    'kitrsre sszpontost': 50\n\n}\n\nconst VISZONYOK: Record<string, number> = {\n    'napsts, szlcsend': 0,\n    'szemerkl es, szell': 10,\n    'gyenge es/szl': 30,\n    'gyenge kd, es, ers szl': 50,\n    'sr kd, zivatar, viharos szl': 70,\n    'egszen sr kd, felhszakads, orkn': 100,\n\n}\n\n\ninterface LofegyverVedo {\n    tavolsag: number,\n    meret: string;\n    mozgas: string;\n    viszonyok: string;\n}\n\nexport const Kockadobo: React.FC<{}> = () => {\n    const [input, setInput] = useState('');\n    const [result, setResult] = useState({} as DiceRollResult);\n    const [history, addToHistory] = useReducer((prev: Array<string>, elem: string) => {\n        if (prev[0] === elem) {\n            return prev;\n        }\n        return [elem, ...prev.slice(0, HISTORY_LENGTH - 1)];\n    }, []);\n    const [lofegyverVedo, setLofegyverVedo] = useState<LofegyverVedo>({ tavolsag: 0, meret: 'ember', mozgas: 'mozdulatlan', viszonyok: 'napsts, szlcsend' });\n\n    const dob = useCallback((ijasz?: boolean) => {\n        setResult(roll(input, ijasz));\n        addToHistory(input);\n    }, [input, setResult, addToHistory]);\n\n    const setKocka = useCallback((k: number) => {\n        const diceRoll = parseDiceRoll(input);\n        if (diceRoll.die === k) {\n            diceRoll.numDice++;\n        } else {\n            diceRoll.die = k;\n            diceRoll.numDice = 1;\n        }\n        setInput(formatDiceRoll(diceRoll));\n    }, [input, setInput]);\n\n    const setPlus = useCallback((k: number) => {\n        const diceRoll = parseDiceRoll(input);\n        if (k === 0) {\n            diceRoll.plus = 0;\n        } else {\n            diceRoll.plus += k;\n        }\n        setInput(formatDiceRoll(diceRoll));\n    }, [input, setInput]);\n\n\n    return <Grid columns={1} divided='vertically'>\n        <GridRow>\n            <GridColumn>\n                <Header>Kockadobs</Header>\n                <div>\n                    <Input labelPosition='right' value={input} onChange={e => setInput(e.target.value)}>\n                        <Label basic pointing='right'>Dobs</Label>\n                        <input />\n                        <DobasEredmeny pointing='left' result={result} />\n                        <Button.Group color='teal'>\n                            <Button primary disabled={!input} onClick={() => dob()}>Dob</Button>\n                            <Dropdown\n                                className='button icon'\n                                floating\n                                trigger={<></>}\n                            >\n                                <Dropdown.Menu>\n                                    <Button primary onClick={() => dob(true)}>jsz szabllyal</Button>\n                                </Dropdown.Menu>\n                            </Dropdown>\n                        </Button.Group>\n\n                    </Input>\n                </div>\n                <div>\n                    <Button as='div' labelPosition='left'>\n                        <Label basic pointing='right'>Kocka</Label>\n                        {DICE_ROLLS.map(r => <Button onClick={() => setKocka(r)}>k{r}</Button>)}\n                    </Button>\n                </div>\n                <div>\n                    <Button as='div' labelPosition='left'>\n                        <Label basic pointing='right'>Oszt</Label>\n                        {[1, 2, 3].map(r => <Button onClick={() => {\n                            const diceRoll = parseDiceRoll(input);\n                            diceRoll.div = r;\n                            setInput(formatDiceRoll(diceRoll))\n                        }}>/{r}</Button>)}\n                    </Button>\n                </div>\n                <div>\n                    <Button as='div' labelPosition='left'>\n                        <Label basic pointing='right'>Plusz</Label>\n                        {[...PLUS].reverse().map(r => <Button onClick={() => setPlus(-r)}>-{r}</Button>)}\n                        <Button secondary onClick={() => setPlus(0)}>0</Button>\n                        {PLUS.map(r => <Button onClick={() => setPlus(r)}>+{r}</Button>)}\n                    </Button>\n                </div>\n                <div>\n                    <Button as='div' labelPosition='left'>\n                        <Label basic pointing='right'>, jra</Label>\n                        {history.map(h => <Button color='olive' onClick={() => setInput(h)}>{h}</Button>)}\n                    </Button>\n                </div>\n            </GridColumn>\n        </GridRow>\n        <GridRow>\n            <GridColumn>\n                <Header>Clzs vd rtk</Header>\n                <div>\n                    <Slider value={lofegyverVedo.tavolsag} settings={{ min: 0, max: 100, step: 1, onChange: (v: number) => setLofegyverVedo({ ...lofegyverVedo, tavolsag: v }) }} />\n                    <IntegerInput label='Tvolsg' value={lofegyverVedo.tavolsag} onChange={v => setLofegyverVedo({ ...lofegyverVedo, tavolsag: Math.min(v ?? 0, 100) })} />\n                </div>\n                <div>\n                    <Button as='div' labelPosition='left'>\n                        <Label basic pointing='right'>Mret</Label>\n                        {Object.keys(MERETEK).map(r => <Button active={lofegyverVedo.meret === r} onClick={() => setLofegyverVedo({ ...lofegyverVedo, meret: r })}>{r}</Button>)}\n                    </Button>\n                </div>\n                <div>\n                    <Button as='div' labelPosition='left'>\n                        <Label basic pointing='right'>Mozgs</Label>\n                        {Object.keys(MOZGASOK).map(r => <Button active={lofegyverVedo.mozgas === r} onClick={() => setLofegyverVedo({ ...lofegyverVedo, mozgas: r })}>{r}</Button>)}\n                    </Button>\n                </div>\n                <div>\n                    <Button as='div' labelPosition='left'>\n                        <Label basic pointing='right'>Viszonyok</Label>\n                        {Object.keys(VISZONYOK).map(r => <Button active={lofegyverVedo.viszonyok === r} onClick={() => setLofegyverVedo({ ...lofegyverVedo, viszonyok: r })}>{r}</Button>)}\n                    </Button>\n                </div>\n                <div>\n                    <Button as='div' labelPosition='left'>\n                        <Label basic pointing='right'>Vd rtk</Label>\n                        <Label color='black' size='large'>{30 + lofegyverVedo.tavolsag + MERETEK[lofegyverVedo.meret] + MOZGASOK[lofegyverVedo.mozgas] + VISZONYOK[lofegyverVedo.viszonyok]}</Label>\n                    </Button>\n                </div>\n            </GridColumn>\n        </GridRow>\n    </Grid>\n}","import React, { useState } from 'react';\r\nimport { Modal, Button } from 'semantic-ui-react';\r\nimport { Kockadobo } from '../pages/Kocskadobo';\r\n\r\nexport const KockaModal: React.FC<{}> = () => {\r\n    const [kockaOpen, setKockaOpen] = useState(false);\r\n    return <Modal trigger={<Button primary>Kocka</Button>} onOpen={() => setKockaOpen(true)} onClose={() => setKockaOpen(false)} open={kockaOpen}>\r\n        <Modal.Content>\r\n            <Kockadobo />\r\n        </Modal.Content>\r\n    </Modal>\r\n}","export default __webpack_public_path__ + \"static/media/magus.810aa1ee.png\";","import React, { useEffect, useState } from 'react';\nimport { Icon, Menu, Image, Button } from 'semantic-ui-react';\nimport { Karakter, KarakterInfo } from '../engine/karakter';\nimport { CategoriesDropdown } from './CategoriesDropdown';\nimport { KarakterImport } from './KarakterImport';\nimport { KockaModal } from './KockaModal';\n\nimport logo from '../static/magus.png';\nimport { PageSelection } from '../App';\n\n\ninterface PageHeaderProps {\n    categories: Array<string>;\n    currentCategory: string;\n    setCurrentCategory: (category: string) => unknown;\n    karakter?: KarakterInfo;\n    karakterek: Array<KarakterInfo>;\n    page: PageSelection;\n    setPage: (pageSelection: PageSelection) => unknown;\n    save: (karakter: Karakter) => unknown;\n    saveMese: (story: string) => unknown;\n}\n\nconst MAX_KARAKTERS_PER_PAGE = 10;\n\nexport const PageHeader: React.FC<PageHeaderProps> = ({ categories, currentCategory, setCurrentCategory, karakter, karakterek, page, setPage, save, saveMese }) => {\n    const [karakterStart, setKarakterStart] = useState(0);\n\n    const karakterPos = karakterek.findIndex(k => k.id === karakter?.id);\n\n    //adjust scrolling\n    useEffect(() => {\n        if (karakterPos > -1) {\n            if (karakterPos < karakterStart) {\n                setKarakterStart(karakterPos);\n            }\n            if (karakterPos >= karakterStart + MAX_KARAKTERS_PER_PAGE) {\n                setKarakterStart(karakterPos - MAX_KARAKTERS_PER_PAGE + 1);\n            }\n        }\n    }, [karakterPos, karakterStart, setKarakterStart]);\n\n    const scrolled = karakterek.length > MAX_KARAKTERS_PER_PAGE;\n    const canScrollLeft = karakterStart > 0 && (karakterPos === -1 || karakterPos < karakterStart + MAX_KARAKTERS_PER_PAGE - 1);\n    const canScrollRight = (karakterStart + MAX_KARAKTERS_PER_PAGE < karakterek.length) && (karakterPos === -1 || karakterPos > karakterStart);\n    const karaktersDisplayed = karakterek.slice(karakterStart, karakterStart + MAX_KARAKTERS_PER_PAGE);\n\n    return <Menu tabular>\n        <Menu.Item key='header' header>\n            <Image src={logo} size='mini' onClick={() => setPage({ page: page.page === 'story' ? 'home' : 'story' })} />\n        </Menu.Item>\n        <CategoriesDropdown categories={categories} currentCategory={currentCategory} setCurrentCategory={setCurrentCategory} />\n        {scrolled &&\n            <Menu.Item key='scroll_left' disabled={!canScrollLeft} onClick={() => setKarakterStart(karakterStart - 1)}>\n                <Icon name='triangle left' />\n            </Menu.Item>\n        }\n        {karaktersDisplayed.map(k =>\n            <Menu.Item key={k.id} style={{ flexGrow: 1 }} active={k.id === karakter?.id} name={k.name} onClick={() => k.id === karakter?.id ? setPage({ page: 'home' }) : setPage({ page: 'karakterlap', karakter: k })} />\n        )}\n        <Menu.Item key='new' active={page.page === 'karakteralkoto'} onClick={() => setPage({ page: 'karakteralkoto' })}>\n            <Icon name='plus' />\n        </Menu.Item>\n        {scrolled &&\n            <Menu.Item key='scroll_right' disabled={!canScrollRight} onClick={() => setKarakterStart(karakterStart + 1)}>\n                <Icon name='triangle right' />\n            </Menu.Item>\n        }\n        <Menu.Item key='floated' position='right'>\n            <KarakterImport save={save} saveMese={saveMese} />\n            <Button negative onClick={() => setPage({ page: 'kombat', category: currentCategory })}>Kombat</Button>\n            <KockaModal />\n        </Menu.Item>\n    </Menu>\n}","import React from 'react';\r\nimport { Dropdown, DropdownItemProps } from 'semantic-ui-react';\r\nimport { SZITUACIOK } from '../engine/harc';\r\n\r\nexport const SzituacioSelector: React.FC<{ szituaciok: Array<string>, setSzituaciok: (value: Array<string>) => unknown }> = ({ szituaciok, setSzituaciok }) => {\r\n\r\n    const szituacioOptions: Array<DropdownItemProps> = Object.keys(SZITUACIOK).sort().map(nev => ({\r\n        id: nev,\r\n        key: nev,\r\n        value: nev,\r\n        text: nev\r\n    }));\r\n\r\n    const renderLabel = (label: any) => ({\r\n        color: 'blue',\r\n        content: `${label.text}`,\r\n    })\r\n\r\n    return <>\r\n        <Dropdown multiple simple className='icon' icon=''\r\n            renderLabel={renderLabel}\r\n            text='Harci szituci'\r\n            onChange={(e, v) => { setSzituaciok([...v.value as Array<string>]) }}\r\n            options={szituacioOptions}\r\n            value={szituaciok}>\r\n        </Dropdown>\r\n    </>\r\n}","import React, { forwardRef, useImperativeHandle, useState } from 'react';\r\nimport { Button, Card, Dropdown, DropdownItemProps, Table } from 'semantic-ui-react';\r\nimport { FEGYVERTELEN, FegyverUtils, HARCERTEK_DISPLAY_NAMES, SZITUACIOK } from '../engine/harc';\r\nimport { calculateHarcertek, calculateSebesulesHatrany, Karakter } from '../engine/karakter';\r\nimport { DiceRollResult, formatDiceRoll, parseDiceRoll, roll, sumRolls } from '../engine/roll';\r\nimport { DobasEredmeny } from './DobasEredmeny';\r\nimport { PointsTable } from './PointsTable';\r\nimport { SzituacioSelector } from './SzituacioSelector';\r\n\r\nexport interface KombatCardProps {\r\n    karakter: Karakter,\r\n    save: (karakter: Karakter) => unknown,\r\n    dobasEredmeny: Record<string, DiceRollResult>,\r\n    setDobasEredmeny(value: Record<string, DiceRollResult>): unknown,\r\n}\r\n\r\n\r\nexport const KombatCard: React.ForwardRefExoticComponent<KombatCardProps & React.RefAttributes<unknown>> = forwardRef(({ karakter, save, dobasEredmeny, setDobasEredmeny }, ref) => {\r\n    const [szituaciok, setSzituaciok] = useState<Array<string>>([]);\r\n\r\n    const fegyver = karakter.valasztottFegyver !== undefined ? karakter.fegyverek[karakter.valasztottFegyver] : FEGYVERTELEN;\r\n    const harcertekMatrix = calculateHarcertek(karakter, szituaciok.map(sz => ({ ...SZITUACIOK[sz], name: sz }))).roll(['ke', 'te', 'ce', 've']);\r\n    const sebzesRoll = sumRolls(harcertekMatrix.getRolls('sebzes')) ?? parseDiceRoll();\r\n\r\n    useImperativeHandle(ref, () => ({\r\n        rollKe: () => {\r\n            return roll('1k10+' + harcertekMatrix.sum.ke);\r\n        },\r\n        rollTe: () => {\r\n            return roll('1k100+' + harcertekMatrix.sum.te);\r\n        },\r\n        rollCe: () => {\r\n            return roll('1k100+' + harcertekMatrix.sum.ce);\r\n        },\r\n        rollSebzes: () => {\r\n            return roll(sebzesRoll, FegyverUtils.tipus(fegyver) === 'lofegyver');\r\n        },\r\n    }), [harcertekMatrix, sebzesRoll, fegyver]);\r\n\r\n\r\n    const fegyverCsere = (v?: number) => {\r\n        karakter.valasztottFegyver = v === undefined ? undefined : Number(v);\r\n        save(karakter);\r\n    };\r\n\r\n    const options: Array<DropdownItemProps> = [\r\n        {\r\n            id: -1,\r\n            value: undefined,\r\n            text: 'fegyver nlkl'\r\n        }\r\n    ];\r\n    karakter.fegyverek.forEach((f, i) => options.push({ id: i, value: i, text: f.name }));\r\n\r\n    const cellContents = (name: string) => {\r\n        switch (name) {\r\n            case 'sebzes': return <><Button compact circular color='orange' onClick={() => {\r\n                setDobasEredmeny({ ...dobasEredmeny, 'sebzes': roll(sebzesRoll, FegyverUtils.tipus(fegyver) === 'lofegyver') });\r\n            }}>{formatDiceRoll(sebzesRoll)}</Button><DobasEredmeny result={dobasEredmeny.sebzes} /></>\r\n            case 'ke': return <><Button compact circular color='olive' onClick={() => setDobasEredmeny({ ...dobasEredmeny, 'ke': roll('1k10+' + harcertekMatrix.sum[name]) })}>{harcertekMatrix.sum[name]}</Button><DobasEredmeny result={dobasEredmeny.ke} /></>\r\n            case 'ce':\r\n            case 'te': return <><Button compact circular color='purple' onClick={() => setDobasEredmeny({ ...dobasEredmeny, [name]: roll('1k100+' + harcertekMatrix.sum[name]) })}>{harcertekMatrix.sum[name]}</Button><DobasEredmeny result={dobasEredmeny[name]} /></>\r\n            case 've': return harcertekMatrix.sum[name];\r\n        }\r\n    }\r\n\r\n    const headerColour = () => {\r\n        const down = karakter.ep.akt <= 0 || karakter.fp.akt <= 0;\r\n        if (down) {\r\n            return 'darkgrey';\r\n        }\r\n        const hatrany = calculateSebesulesHatrany(karakter);\r\n        if (!hatrany) {\r\n            return 'white';\r\n        }\r\n        if (hatrany.te === -10) {\r\n            return 'bisque';\r\n        }\r\n        if (hatrany.te === -20) {\r\n            return 'coral';\r\n        }\r\n    }\r\n\r\n    return <Card fluid style={{ backgroundColor: headerColour(), filter: 'drop-shadow(5px 5px 3px #333)' }}>\r\n        <Card.Content>\r\n            <Card.Header >{karakter.name}</Card.Header>\r\n            <Card.Description>\r\n                <PointsTable\r\n                    points={[{ name: 'ep', label: 'P', ...karakter.ep }, { name: 'fp', label: 'FP', ...karakter.fp }]}\r\n                    onChange={(name, max, value) => {\r\n                        (karakter as any)[name][max ? 'max' : 'akt'] = value;\r\n                        save(karakter);\r\n                    }}\r\n                />\r\n                <Table columns={2} singleLine compact>\r\n                    <Table.Row>\r\n                        <Table.HeaderCell>SF</Table.HeaderCell>\r\n                        <Table.Cell>{karakter.valasztottPancel ? karakter.pancelok?.[karakter.valasztottPancel].sfe : '-'}</Table.Cell>\r\n                    </Table.Row>\r\n                    <Table.Row>\r\n                        <Table.HeaderCell>Asztrl ME</Table.HeaderCell>\r\n                        <Table.Cell>{karakter.pajzs ? karakter.pajzs.asztral.termeszetes + karakter.pajzs.asztral.statikus + karakter.pajzs.asztral.dinamikus : '-'}</Table.Cell>\r\n                    </Table.Row>\r\n                    <Table.Row>\r\n                        <Table.HeaderCell>Mentl ME</Table.HeaderCell>\r\n                        <Table.Cell>{karakter.pajzs ? karakter.pajzs.mental.termeszetes + karakter.pajzs.mental.statikus + karakter.pajzs.mental.dinamikus : '-'}</Table.Cell>\r\n                    </Table.Row>\r\n                </Table>\r\n                <Table columns={2} singleLine compact>\r\n                    <Table.Header>\r\n                        <Table.HeaderCell colSpan={2}>\r\n                            <Dropdown disabled={false} compact\r\n                                text={fegyver.name}\r\n                                onChange={(e, v) => fegyverCsere(v.value !== undefined ? Number(v.value) : undefined)}\r\n                                options={options}\r\n                                value={karakter.valasztottFegyver}>\r\n                            </Dropdown>\r\n                        </Table.HeaderCell>\r\n                    </Table.Header>\r\n                    {harcertekMatrix.keys.map(m => <Table.Row>\r\n                        <Table.HeaderCell>{(HARCERTEK_DISPLAY_NAMES as any)[m]}</Table.HeaderCell>\r\n                        <Table.Cell>{cellContents(m)}</Table.Cell>\r\n                    </Table.Row>\r\n                    )}\r\n                    {fegyver.name !== FEGYVERTELEN.name &&\r\n                        <Table.Row>\r\n                            <Table.HeaderCell>Tm/kr</Table.HeaderCell>\r\n                            <Table.Cell>{`${fegyver.lassu ? '1/' : ''}${fegyver.tamPerKor}`}</Table.Cell>\r\n                        </Table.Row>\r\n                    }\r\n                </Table>\r\n            </Card.Description>\r\n        </Card.Content>\r\n        <Card.Content extra textAlign='center'>\r\n            <SzituacioSelector szituaciok={szituaciok} setSzituaciok={setSzituaciok} />\r\n        </Card.Content>\r\n    </Card >\r\n});","import React, { useState } from 'react';\r\nimport { Button, ButtonGroup } from 'semantic-ui-react';\r\nimport { SemanticCOLORS } from 'semantic-ui-react/dist/commonjs/generic';\r\nimport { KombatCard } from '../components/KombatCard';\r\nimport { Karakter } from '../engine/karakter';\r\nimport { DiceRollResult } from '../engine/roll';\r\n\r\n\r\n\r\nexport const Kombat: React.FC<{ karakterek: Array<Karakter>; save: (karakter: Karakter) => unknown }> = ({ karakterek, save }) => {\r\n\r\n    const [dobasEredmenyek, setDobasEredmenyek] = useState<Record<string, Record<string, DiceRollResult>>>(karakterek.reduce((acc, curr) => { acc[curr.id] = {}; return acc; }, {} as Record<string, any>));\r\n    const [refs] = useState<Record<string, { current: any }>>({});\r\n\r\n    const DobasButton: React.FC<{\r\n        color: SemanticCOLORS,\r\n        label: string,\r\n        rollFn: string,\r\n        value: string\r\n    }> = ({ color, label, rollFn, value }) => <Button color={color} onClick={() => {\r\n        const uj = { ...dobasEredmenyek };\r\n        Object.keys(refs).forEach(id => {\r\n            uj[id][value] = refs[id]?.current?.[rollFn]();\r\n        });\r\n        setDobasEredmenyek(uj);\r\n    }}>{label}</Button>\r\n\r\n\r\n    const kezdemenySort = (one: Karakter, two: Karakter): number => {\r\n\r\n        const oneKe = dobasEredmenyek[one.id].ke?.value ?? 0;\r\n        const twoKe = dobasEredmenyek[two.id].ke?.value ?? 0;\r\n        return twoKe - oneKe;\r\n    }\r\n\r\n    return <>\r\n        <div style={{ textAlign: 'center' }}>\r\n            <ButtonGroup>\r\n                <DobasButton\r\n                    color='olive'\r\n                    label='Kezdemny'\r\n                    rollFn='rollKe'\r\n                    value='ke' />\r\n                <DobasButton\r\n                    color='purple'\r\n                    label='Tmad'\r\n                    rollFn='rollTe'\r\n                    value='te' />\r\n                <DobasButton\r\n                    color='purple'\r\n                    label='Clz'\r\n                    rollFn='rollCe'\r\n                    value='ce' />\r\n                <DobasButton\r\n                    color='orange'\r\n                    label='Sebzs'\r\n                    rollFn='rollSebzes'\r\n                    value='sebzes' />\r\n                <Button color='red' onClick={() => {\r\n                    setDobasEredmenyek(karakterek.reduce((acc, curr) => { acc[curr.id] = {}; return acc; }, {} as Record<string, any>));\r\n                }}>Dobsok trlse\r\n            </Button>\r\n            </ButtonGroup>\r\n        </div>\r\n        <div style={{ display: 'flex', flexDirection: 'row', flexWrap: 'wrap', alignItems: 'stretch' }}>\r\n            {karakterek.sort(kezdemenySort).reverse().map((k, i) => <div style={{ order: karakterek.length - i, margin: '1em' }}>\r\n                <KombatCard\r\n                    ref={ref => refs[k.id] = { current: ref }}\r\n                    key={k.id}\r\n                    karakter={k}\r\n                    save={save}\r\n                    dobasEredmeny={dobasEredmenyek[k.id]}\r\n                    setDobasEredmeny={e => setDobasEredmenyek({ ...dobasEredmenyek, [k.id]: e })} />\r\n            </div>\r\n            )}\r\n        </div>\r\n    </>\r\n}\r\n\r\n","import React from 'react';\r\nimport { Menu, Popup, StrictMenuItemProps } from 'semantic-ui-react';\r\n\r\nfunction createContextFromEvent(e: React.MouseEvent): HTMLElement {\r\n    const left = e.clientX\r\n    const top = e.clientY\r\n    const right = left + 1\r\n    const bottom = top + 1\r\n\r\n    return {\r\n        getBoundingClientRect: () => ({\r\n            left,\r\n            top,\r\n            right,\r\n            bottom,\r\n\r\n            height: 0,\r\n            width: 0,\r\n        }),\r\n    } as HTMLElement\r\n}\r\n\r\nexport interface ContextMenuProps {\r\n    items: Array<StrictMenuItemProps>,\r\n    onClicked: (target: StrictMenuItemProps) => unknown;\r\n    onClose: () => unknown;\r\n    event?: React.MouseEvent;\r\n}\r\n\r\n\r\nexport const ContextMenu: React.FC<ContextMenuProps> = ({ children, items, onClicked, onClose, event }) => {\r\n    const contextRef = React.useRef<HTMLElement | null>(null);\r\n    const [open, setOpen] = React.useState(false)\r\n\r\n    const close = () => {\r\n        setOpen(false);\r\n        onClose();\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {!event && <div\r\n                onContextMenu={(e: React.MouseEvent) => {\r\n                    e.preventDefault()\r\n\r\n                    contextRef.current = createContextFromEvent(e)\r\n                    setOpen(true)\r\n                }}\r\n            >\r\n                {children}\r\n            </div>}\r\n\r\n            <Popup\r\n                basic\r\n                context={event ? { current: createContextFromEvent(event) } : contextRef}\r\n                onClose={close}\r\n                open={open || !!event}\r\n            >\r\n                <Menu\r\n                    items={items}\r\n                    onItemClick={(_, data) => { close(); onClicked(data) }}\r\n                    secondary\r\n                    vertical\r\n                />\r\n            </Popup>\r\n        </>\r\n    )\r\n}","import React from 'react';\r\nimport { ContextMenu } from './ContextMenu';\r\n\r\nexport interface ScheneListContextMenuProps {\r\n    onSelected: (selection: 'insertBefore' | 'insertAfter' | 'delete') => unknown\r\n}\r\n\r\nexport const SceneListContextMenu: React.FC<ScheneListContextMenuProps> = ({ onSelected, children }) => (\r\n    <ContextMenu onClose={() => { }} items={[\r\n        { name: 'insertBefore', content: 'j elem', icon: 'left arrow' },\r\n        { name: 'delete', content: 'Trl', icon: 'delete' },\r\n        { name: 'insertAfter', content: 'j elem', icon: 'right arrow' },\r\n    ]}\r\n        onClicked={item => {\r\n            onSelected(item.name as any);\r\n        }}>\r\n        {children}\r\n    </ContextMenu>\r\n);","import { xml2js, Element, js2xml } from 'xml-js';\r\n\r\nexport interface DOMElement extends Element {\r\n    $parent: DOMElement;\r\n    elements?: Array<DOMElement>;\r\n}\r\n\r\nconst findElements = (root: DOMElement, filter: (ob: DOMElement) => boolean): Array<DOMElement> => {\r\n    let ret: Array<DOMElement> = [];\r\n    if (filter(root)) {\r\n        ret.push(root);\r\n    }\r\n    const children = root.elements?.map(elem => findElements(elem, filter));\r\n    children?.forEach(ch => {\r\n        ret = ret.concat(ch);\r\n    })\r\n    return ret;\r\n}\r\n\r\nconst findElementsByName = (root: DOMElement, name: string): Array<DOMElement> => {\r\n    return findElements(root, e => e.name === name);\r\n}\r\n\r\nconst findById = (root: DOMElement, name: string, id: string): DOMElement | null => {\r\n    const found = findElements(root, e => e.name === name && DomUtils.attr(e, 'id') === id);\r\n    return found.length > 0 ? found[0] : null;\r\n}\r\n\r\nconst findReferences = (root: DOMElement, target: DOMElement): Array<DOMElement> => {\r\n    const id = DomUtils.attr(target, 'id');\r\n    if (!id) {\r\n        return [];\r\n    }\r\n    return findElements(root, e => DomUtils.attr(e, 'ref') === id);\r\n}\r\n\r\n\r\nconst children = (elem: DOMElement, name: string): Array<DOMElement> => {\r\n    return elem.elements?.filter(e => e.name === name) ?? [];\r\n}\r\n\r\nconst addChild = (parent: DOMElement, name: string, referenceSibling?: DOMElement, insert: 'after' | 'before' = 'after'): DOMElement => {\r\n    const newElement: DOMElement = { type: 'element', name, $parent: parent };\r\n    return addChildElement(parent, newElement, referenceSibling, insert);\r\n}\r\n\r\n\r\nconst addChildElement = (parent: DOMElement, child: DOMElement, referenceSibling?: DOMElement, insert: 'after' | 'before' = 'after'): DOMElement => {\r\n    parent.elements = parent.elements ?? [];\r\n    let insertIndex = 0;\r\n    if (referenceSibling) {\r\n        const referenceIndex = parent.elements.indexOf(referenceSibling);\r\n        insertIndex = insert === 'after' ? referenceIndex + 1 : referenceIndex;\r\n    } else {\r\n        insertIndex = insert === 'after' ? parent.elements.length : 0;\r\n    }\r\n    parent.elements.splice(insertIndex, 0, child);\r\n    child.$parent = parent;\r\n\r\n    return child;\r\n}\r\n\r\nconst deleteChild = (parent: DOMElement, child: DOMElement) => {\r\n    parent.elements = parent.elements ?? [];\r\n    const deleteIndex = parent.elements.indexOf(child);\r\n    if (deleteIndex !== -1) {\r\n        parent.elements.splice(deleteIndex, 1);\r\n    }\r\n}\r\n\r\nconst addText = (parent: DOMElement, text: string, previousSibling?: DOMElement): DOMElement => {\r\n    parent.elements = parent.elements ?? [];\r\n    const insertIndex = previousSibling ? parent.elements.indexOf(previousSibling) + 1 : 0;\r\n    const newElement: DOMElement = { type: 'text', text, $parent: parent };\r\n    parent.elements.splice(insertIndex, 0, newElement);\r\n    return newElement;\r\n}\r\n\r\n\r\nconst child = (elem: DOMElement, name: string): DOMElement | null => {\r\n    const c = children(elem, name);\r\n    return c.length > 0 ? c[0] : null;\r\n}\r\n\r\nconst childText = (elem: Element, name: string): string => {\r\n    const ret = elem.elements?.find(e => e.name === name);\r\n    return text(ret);\r\n}\r\n\r\nconst attr = (elem: Element, name: string, value?: string | null): string => {\r\n    if (value !== undefined) {\r\n        elem.attributes = elem.attributes ?? {};\r\n        if (value !== null) {\r\n            elem.attributes[name] = value;\r\n        } else {\r\n            delete elem.attributes[name];\r\n        }\r\n    }\r\n    return (elem.attributes?.[name] ?? '').toString();\r\n}\r\n\r\n\r\nconst text = (elem?: Element): string => {\r\n    return elem?.elements?.map(t => t.text).join(' ') ?? '';\r\n}\r\n\r\nconst parse = (str: string): DOMElement => {\r\n    return xml2js(str, { compact: false, nativeType: true, trim: false, addParent: true, parentKey: '$parent' }) as DOMElement;\r\n}\r\n\r\nconst convertLegacyLinks = (elem: DOMElement) => {\r\n    if (elem.name === 'link') {\r\n        const [type, ref] = DomUtils.attr(elem, 'target').split(':');\r\n        elem.name = type;\r\n        elem.attributes = { ref }\r\n    }\r\n    if (elem.name === 'setting' && elem.$parent.name === 'scene') { //wrap legacy scene <setting> into a background event instead\r\n        const events = child(elem.$parent, 'events') || addChild(elem.$parent, 'events');\r\n        const event = addChild(events, 'event', undefined, 'before');\r\n        attr(event, 'role', 'background');\r\n        deleteChild(elem.$parent, elem);\r\n        addChildElement(event, elem);\r\n    }\r\n    elem.elements?.forEach(e => convertLegacyLinks(e));\r\n}\r\n\r\nconst print = (root: Element): string => {\r\n    return js2xml(root, { compact: false, parentKey: '$parent' });\r\n}\r\n\r\n\r\nexport const DomUtils = {\r\n    addChild,\r\n    addChildElement,\r\n    addText,\r\n    attr,\r\n    text,\r\n    child,\r\n    childText,\r\n    children,\r\n    deleteChild,\r\n    findById,\r\n    findElementsByName,\r\n    findReferences,\r\n    findElements,\r\n    parse,\r\n    convertLegacyLinks,\r\n    print\r\n};","import React, { useState } from 'react';\r\nimport { Button, Icon, Input, Label, Modal } from 'semantic-ui-react';\r\n\r\nexport interface CommentEditorModalProps {\r\n    addComment: (comment: string) => unknown\r\n}\r\n\r\nexport const CommentEditorModal: React.FC<CommentEditorModalProps> = ({ addComment }) => {\r\n    const [kommentModal, setKommentModal] = useState(false);\r\n    const [editedKomment, setEditedKomment] = useState('');\r\n\r\n    return <Modal trigger={<Icon name='comment' />} onOpen={() => setKommentModal(true)} onClose={() => setKommentModal(false)} open={kommentModal}>\r\n        <Modal.Content>\r\n            <Input fluid labelPosition='left' placeholder='Komment...' error={!editedKomment} value={editedKomment} onChange={e => setEditedKomment(e.target.value)}>\r\n                <Label pointing='right' basic>Komment</Label>\r\n                <input />\r\n                <Button floated='right' disabled={!editedKomment} onClick={() => {\r\n                    addComment(editedKomment);\r\n                    setEditedKomment('');\r\n                    setKommentModal(false);\r\n                }}>Ment</Button>\r\n            </Input>\r\n\r\n        </Modal.Content>\r\n    </Modal>\r\n}\r\n","import React from 'react';\r\nimport { List, Popup } from 'semantic-ui-react';\r\nimport { DOMElement } from '../utils/DomUtils';\r\nimport { Renderer } from '../utils/RenderUtils';\r\n\r\nexport interface CommentListProps {\r\n    comments?: Array<DOMElement>;\r\n    deleteComment: (comment: DOMElement) => unknown;\r\n    renderer: Renderer\r\n}\r\n\r\nexport const CommentList: React.FC<CommentListProps> = ({ comments, deleteComment, renderer }) => (\r\n    <>\r\n        {comments && comments.length ? <Popup hoverable trigger={<List.Description>{comments.length}&nbsp;komment</List.Description>} wide>\r\n            <List>\r\n                {comments.map(c => <List.Item><List.Icon name='delete' onClick={() => deleteComment(c)} /><List.Content>{renderer.renderElement(c)}</List.Content></List.Item>)}\r\n            </List>\r\n        </Popup>\r\n            : ''\r\n        }\r\n    </>\r\n)","import React, { useState } from 'react';\r\nimport { Icon, SemanticICONS } from 'semantic-ui-react';\r\nimport { CommentUtils } from '../utils/CommentUtils';\r\nimport { DOMElement, DomUtils } from '../utils/DomUtils';\r\nimport { Renderer } from '../utils/RenderUtils';\r\nimport { CommentEditorModal } from './CommentEditorModal';\r\nimport { CommentList } from './CommentList';\r\n\r\nexport const ROLE_ICONS: Record<string, SemanticICONS> = {\r\n    'normal': 'angle right',\r\n    'entrance': 'sign-in',\r\n    'exit': 'sign-out',\r\n    'info': 'info circle',\r\n    'background': 'film',\r\n    'speech': 'comment alternate outline',\r\n    'warning': 'warning'\r\n\r\n}\r\n\r\nconst iconForRole = (role: string): SemanticICONS => {\r\n    return ROLE_ICONS[role] ?? 'square full';\r\n}\r\n\r\nexport interface EditedEvent {\r\n    operation?: 'insertAfter' | 'insertBefore' | 'delete' | 'edit';\r\n}\r\n\r\nexport interface StoryEventProps {\r\n    event: DOMElement,\r\n    renderer: Renderer,\r\n    onClick: () => unknown,\r\n    commentUtils: CommentUtils,\r\n    onChange: () => unknown;\r\n    onContextMenu: (event: React.MouseEvent) => unknown,\r\n    onEdit: () => unknown;\r\n};\r\n\r\nexport const StoryEvent: React.FC<StoryEventProps> = ({ event, renderer, onClick, commentUtils, onChange, onContextMenu, onEdit }) => {\r\n    const role = DomUtils.attr(event, 'role').toString() || 'normal';\r\n    const status = DomUtils.attr(event, 'status');\r\n    const [active, setActive] = useState(false);\r\n\r\n    return <div onContextMenu={e => {\r\n        onContextMenu(e);\r\n        e.preventDefault();\r\n    }} style={\r\n        {\r\n            backgroundColor: status === 'completed' ? '#eefeee' : undefined,\r\n            display: 'flex',\r\n            alignItems: 'start',\r\n            width: '100%',\r\n            justifyContent: 'space-between',\r\n            padding: '1em',\r\n            borderTop: '1px solid #444',\r\n            borderBottom: '1px solid #444',\r\n        }}\r\n        onMouseEnter={() => !active && setActive(true)}\r\n        onMouseLeave={() => active && setActive(false)}\r\n    >\r\n        <div>\r\n            <ul style={{ listStyle: 'none', margin: '0' }}>\r\n                <li><Icon name={iconForRole(role)} /></li>\r\n                {active && <li style={{ cursor: 'pointer' }}><Icon name='edit' onClick={onEdit} /></li>}\r\n            </ul>\r\n        </div>\r\n        <div style={{ flexGrow: 1 }}>\r\n\r\n            {renderer.renderElement(event)}\r\n        </div>\r\n        <div style={{ textAlign: 'right' }}>\r\n            <CommentEditorModal addComment={content => { commentUtils.add(content); onChange(); }} />\r\n            <Icon name='checkmark' color={status === 'completed' ? 'green' : undefined} onClick={onClick} />\r\n            <CommentList comments={commentUtils.list()} deleteComment={comment => { commentUtils.remove(comment); onChange() }} renderer={renderer} />\r\n        </div>\r\n    </div>\r\n}\r\n","import { ContentBlock, ContentState, genKey, Modifier, SelectionState } from \"draft-js\";\r\nimport { DOMElement } from \"./DomUtils\";\r\n\r\nconst lastPos = (state: ContentState): SelectionState => {\r\n    const len = state.getLastBlock().getLength();\r\n    return createSelection(state, len, len);\r\n}\r\n\r\nconst createSelection = (state: ContentState, start: number, end: number) => {\r\n    let selection = SelectionState.createEmpty(state.getLastBlock().getKey());\r\n    return selection.merge({ anchorOffset: start, focusOffset: end });\r\n}\r\n\r\nconst addEntityToSelection = (state: ContentState, type: string, data: any, selection: SelectionState) => {\r\n    console.log('adding entity', type, data, selection);\r\n    let ret = state;\r\n    ret = ret.createEntity(type, 'MUTABLE', data);\r\n    const entityKey = ret.getLastCreatedEntityKey();\r\n    console.log(entityKey);\r\n    ret = Modifier.applyEntity(ret, selection, entityKey);\r\n    return ret;\r\n\r\n}\r\n\r\nconst addEntity = (state: ContentState, type: string, data: any, start: number, end: number): ContentState => {\r\n    return addEntityToSelection(state, type, data, createSelection(state, start, end));\r\n}\r\n\r\nconst addBlock = (state: ContentState): ContentState => {\r\n    console.log('creating new block');\r\n    const block = new ContentBlock({\r\n        key: genKey(),\r\n        type: 'paragraph',\r\n        text: '',\r\n    });\r\n    const blockMap = state.getBlockMap().merge({ [block.getKey()]: block }).toOrderedMap();\r\n    return state.merge({ blockMap }) as ContentState;\r\n}\r\n\r\nconst processElement = (elem: DOMElement, state: ContentState, contentsOnly: boolean, block?: ContentBlock): ContentState => {\r\n    console.log('processing', elem, contentsOnly, block);\r\n    let ret = state;\r\n    if (elem.type === 'text') {\r\n        console.log('adding text', elem.text);\r\n        if (!block) {\r\n            ret = addBlock(ret);\r\n        }\r\n        return Modifier.insertText(ret, lastPos(ret), elem.text as string);\r\n    } else if (elem.elements) {\r\n        if ((elem.name === 'p' || !block) && !contentsOnly) {\r\n            ret = addBlock(ret);\r\n        }\r\n        elem.elements.forEach(e => {\r\n            console.log('adding', e, elem);\r\n            const start = ret.getLastBlock()?.getLength() ?? 0;\r\n            ret = processElement(e, ret, false, ret.getLastBlock());\r\n            const end = ret.getLastBlock().getLength();;\r\n            if (e.name && e.name !== 'p') {\r\n                ret = addEntity(ret, e.name, e.attributes, start, end);\r\n            }\r\n        });\r\n        return ret;\r\n    }\r\n    return ret;\r\n}\r\n\r\nconst blockToElement = ($parent: DOMElement, state: ContentState, block: ContentBlock): DOMElement => {\r\n    const ret: DOMElement = {\r\n        type: 'element',\r\n        name: 'p',\r\n        $parent,\r\n        elements: []\r\n    };\r\n    const text = block.getText();\r\n    block.findEntityRanges(() => true, (start, end) => {\r\n        const entityKey = block.getEntityAt(start);\r\n        const textNode: DOMElement = {\r\n            type: 'text',\r\n            text: text.substring(start, end),\r\n            $parent\r\n        };\r\n        if (entityKey) {\r\n            const entity = state.getEntity(entityKey);\r\n            ret.elements?.push({\r\n                type: 'element',\r\n                name: entity.getType(),\r\n                attributes: entity.getData(),\r\n                elements: [textNode],\r\n                $parent: ret\r\n            });\r\n        } else {\r\n            ret.elements?.push(textNode);\r\n        }\r\n    });\r\n    return ret;\r\n}\r\n\r\nconst toElements = (state: ContentState, $parent: DOMElement): Array<DOMElement> => {\r\n    const ret = state.getBlocksAsArray().map(block => blockToElement($parent, state, block));\r\n    if (ret.length === 1) {\r\n        return ret[0].elements ?? [];\r\n    }\r\n    return ret;\r\n}\r\n\r\nexport const EditorUtils = {\r\n    processElement,\r\n    toElements,\r\n    addEntity,\r\n    addEntityToSelection\r\n}","import { EditorState, Modifier } from 'draft-js';\r\nimport React, { useState } from 'react';\r\nimport { Button, Dropdown, Input, Label, Modal } from 'semantic-ui-react';\r\nimport { DOMElement, DomUtils } from '../../utils/DomUtils';\r\nimport { EditorUtils } from '../../utils/EditorUtils';\r\n\r\nconst { addEntityToSelection } = EditorUtils;\r\n\r\n\r\nexport const EditingButtons: React.FC<{ editorState: EditorState; setEditorState(s: EditorState): unknown, root: DOMElement }> = ({ editorState, setEditorState, root }) => {\r\n\r\n    const [editorPopup, setEditorPopup] = useState<string>();\r\n    const [editedValue, setEditedValue] = useState<Record<string, string>>({});\r\n\r\n    function addTag(name: string, attrs?: Record<string, string>) {\r\n        const selection = editorState.getSelection();\r\n        const newContent = addEntityToSelection(editorState.getCurrentContent(), name, attrs, selection);\r\n        setEditorState(EditorState.push(editorState, newContent, 'apply-entity'));\r\n    }\r\n\r\n    function findTargets(type: string): Array<{ key: string, text: string, value: string }> {\r\n        return DomUtils.findElementsByName(root, type).filter(e => DomUtils.attr(e, 'id')).map(e => ({ key: DomUtils.attr(e, 'id'), value: DomUtils.attr(e, 'id'), text: DomUtils.childText(e, 'name') }));\r\n    }\r\n\r\n    function findScenes(): Array<{ key: string, text: string, value: string }> {\r\n        return DomUtils.findElementsByName(root, 'scene').map(e => ({ key: DomUtils.attr(e, 'id'), value: DomUtils.attr(e, 'id'), text: DomUtils.attr(e, 'title') }));\r\n    }\r\n\r\n    return <>\r\n        <Modal open={editorPopup !== undefined} onClose={() => setEditorPopup(undefined)}>\r\n            <Modal.Content>\r\n                {editorPopup === 'roll' && <>\r\n                    <Input labelPosition='left' value={editedValue.details ?? ''} onChange={e => setEditedValue({ details: e.target.value })}>\r\n                        <Label pointing='right' basic>Dobs</Label>\r\n                        <input />\r\n                    </Input>\r\n                    <Button primary onClick={() => {\r\n                        addTag('roll', editedValue);\r\n                        setEditedValue({});\r\n                        setEditorPopup(undefined)\r\n                    }\r\n                    }>OK</Button>\r\n                </>}\r\n                {(editorPopup === 'character' || editorPopup === 'item') && <>\r\n                    <Dropdown\r\n                        fluid\r\n                        search\r\n                        selection\r\n                        value={editedValue.ref}\r\n                        options={findTargets(editorPopup)}\r\n                        onChange={(e, data) => setEditedValue({ ref: data.value?.toString() ?? '' })} />\r\n                    <Button primary onClick={() => {\r\n                        addTag(editorPopup, editedValue);\r\n                        setEditedValue({});\r\n                        setEditorPopup(undefined)\r\n                    }\r\n                    }>OK</Button>\r\n                </>}\r\n                {(editorPopup === 'jump') && <>\r\n                    <Dropdown\r\n                        fluid\r\n                        search\r\n                        selection\r\n                        value={editedValue.ref}\r\n                        options={findScenes()}\r\n                        onChange={(e, data) => setEditedValue({ scene: data.value?.toString() ?? '' })} />\r\n                    <Button primary onClick={() => {\r\n                        addTag(editorPopup, editedValue);\r\n                        setEditedValue({});\r\n                        setEditorPopup(undefined)\r\n                    }\r\n                    }>OK</Button>\r\n                </>}\r\n                {editorPopup === 'setting' && <>\r\n                    <div>\r\n                        <Input labelPosition='left' value={editedValue.map ?? ''} onChange={e => setEditedValue({ ...editedValue, map: e.target.value })}>\r\n                            <Label pointing='right' basic>Trkp link</Label>\r\n                            <input />\r\n                        </Input>\r\n                    </div>\r\n                    <div>\r\n                        <Input labelPosition='left' value={editedValue.description ?? ''} onChange={e => setEditedValue({ ...editedValue, description: e.target.value })}>\r\n                            <Label pointing='right' basic>Lers link</Label>\r\n                            <input />\r\n                        </Input>\r\n                    </div>\r\n                    <Button primary onClick={() => {\r\n                        addTag('setting', editedValue);\r\n                        setEditedValue({});\r\n                        setEditorPopup(undefined)\r\n                    }\r\n                    }>OK</Button>\r\n                </>}\r\n            </Modal.Content>\r\n        </Modal>\r\n        <Button onClick={() => addTag('reward')} icon='trophy'></Button>\r\n        <Button onClick={() => setEditorPopup('roll')} icon='cube'></Button>\r\n        <Button onClick={() => setEditorPopup('setting')} icon='map marker alternate'></Button>\r\n        <Button onClick={() => setEditorPopup('character')} icon='user outline'></Button>\r\n        <Button onClick={() => setEditorPopup('item')} icon='gift'></Button>\r\n        <Button onClick={() => setEditorPopup('jump')} icon='paper plane outline'></Button>\r\n        <Button floated='right' onClick={() => {\r\n            const newContent = Modifier.applyEntity(editorState.getCurrentContent(), editorState.getSelection(), null);\r\n\r\n            setEditorState(EditorState.push(editorState, newContent, 'apply-entity'));\r\n        }} icon='remove circle'></Button>\r\n\r\n    </>;\r\n}","import React, { useState } from 'react';\r\nimport { Button } from 'semantic-ui-react';\r\nimport { DOMElement, DomUtils } from '../utils/DomUtils';\r\nimport { EventEditor } from './editor/EventEditor';\r\n\r\nexport interface EditableTextProps {\r\n    elem?: DOMElement | null;\r\n    root: DOMElement;\r\n    onChange: (elemt: DOMElement) => unknown;\r\n    create: () => unknown;\r\n    readOnly: boolean;\r\n}\r\n\r\nexport const EditableNode: React.FC<EditableTextProps> = ({ elem, root, onChange, children, create, readOnly }) => {\r\n    const [edited, setEdited] = useState<boolean>(false);\r\n\r\n    if (!readOnly) {\r\n        if (!elem) {\r\n            return <Button size='mini' onClick={() => { create(); setTimeout(() => setEdited(true), 0) }}>Create</Button>\r\n        }\r\n\r\n        if (!edited && !DomUtils.text(elem)) {\r\n            return <Button size='mini' onClick={() => setEdited(true)}>Edit</Button>\r\n        }\r\n        if (edited) {\r\n            return <EventEditor elem={elem} root={root} onFinished={res => { if (res) { onChange(elem); } setEdited(false) }} />\r\n        }\r\n    }\r\n    return <div onClick={() => setEdited(true)}>{children}</div>;\r\n\r\n}","import { DomUtils } from '../DomUtils';\r\nimport { RendererComponent } from '../RenderUtils';\r\n\r\nexport const EventRenderer: RendererComponent = ({ children, elem, switchToScene }) => {\r\n    const role = DomUtils.attr(elem, 'role').toString() || 'normal';\r\n\r\n    if (role === 'background') {\r\n        return <i>{children}</i>;\r\n    } else if (role === 'speech') {\r\n        return <blockquote>{children}</blockquote>;\r\n    } else {\r\n        return <>{children}</>;\r\n    }\r\n}","import { Icon } from 'semantic-ui-react';\r\nimport { DomUtils } from '../DomUtils';\r\nimport { RendererComponent } from '../RenderUtils';\r\n\r\nexport const JumpRenderer: RendererComponent = ({ children, elem, switchToScene }) => <><Icon name='paper plane outline' fitted /> <em style={{ cursor: 'pointer' }} onClick={() => switchToScene(DomUtils.attr(elem, 'scene'))}>{children}</em></>;","import { DomUtils } from '../DomUtils';\r\nimport { RendererComponent } from '../RenderUtils';\r\n\r\nexport const LanguageRenderer: RendererComponent = ({ children, elem }) => {\r\n    const level = DomUtils.attr(elem, 'level');\r\n    return <>{children} { level ? <em>({level})</em> : ''}</>;\r\n}","import { RendererComponent } from '../RenderUtils';\r\n\r\nexport const ParagraphRenderer: RendererComponent = ({ children }) => (<p>{children}</p>);","import React from 'react';\r\nimport { Icon } from 'semantic-ui-react';\r\nimport { RendererComponent } from '../RenderUtils';\r\n\r\nexport const RewardRenderer: RendererComponent = ({ children }) => <><Icon name='trophy' fitted /> <strong>{children}</strong></>;","import React from 'react';\r\nimport { Icon, Popup } from 'semantic-ui-react';\r\nimport { DomUtils } from '../DomUtils';\r\nimport { RendererComponent } from '../RenderUtils';\r\n\r\nexport const RollRenderer: RendererComponent = ({ children, elem }) => {\r\n    const details = DomUtils.attr(elem, 'details');\r\n    if (details) {\r\n        return <Popup hoverable trigger={<span><Icon name='cube' fitted /> <strong>{children}</strong></span>} wide>\r\n            <Popup.Content>\r\n                {details}\r\n            </Popup.Content>\r\n        </Popup>\r\n    } else {\r\n        return <><Icon name='cube' fitted /> <strong>{children}</strong></>;\r\n    }\r\n}","import { Icon } from 'semantic-ui-react';\r\nimport { DomUtils } from '../DomUtils';\r\nimport { RendererComponent } from '../RenderUtils';\r\n\r\nexport const SettingRenderer: RendererComponent = ({ children, elem }) => {\r\n    const map = DomUtils.attr(elem, 'map');\r\n    const description = DomUtils.attr(elem, 'description');\r\n\r\n    return <>\r\n        <Icon title={map ? 'Trkp' : undefined} style={map ? { cursor: 'pointer' } : {}} name='map marker alternate' onClick={() => map && window.open(map as string, '_blank')} />\r\n        <strong title={description ? 'Lers' : undefined} style={description ? { cursor: 'pointer' } : {}} onClick={() => description && window.open(description as string, '_blank')}>{children}</strong>\r\n    </>\r\n}","import React, { ReactNode } from 'react';\r\nimport { Button, Card, CardGroup, Icon, Popup, SemanticICONS, Table } from 'semantic-ui-react';\r\nimport { EditableNode } from '../components/EditableNode';\r\nimport { DOMElement, DomUtils } from './DomUtils';\r\nimport { EventRenderer } from './inlinerenderers/EventRenderer';\r\nimport { JumpRenderer } from './inlinerenderers/JumpRenderer';\r\nimport { LanguageRenderer } from './inlinerenderers/LanguageRenderer';\r\nimport { ParagraphRenderer } from './inlinerenderers/ParagraphRenderer';\r\nimport { RewardRenderer } from './inlinerenderers/RewardRenderer';\r\nimport { RollRenderer } from './inlinerenderers/RollRenderer';\r\nimport { SettingRenderer } from './inlinerenderers/SettingRenderer';\r\n\r\nexport const STORY_TAG_ICONS: Record<string, SemanticICONS> = {\r\n    setting: 'map marker alternate',\r\n    roll: 'cube',\r\n    reward: 'trophy',\r\n    character: 'user outline',\r\n    item: 'gift',\r\n    jump: 'paper plane outline',\r\n    '': 'question'\r\n}\r\n\r\nexport type RendererComponent = React.FC<{ elem: DOMElement; switchToScene: (id: string) => unknown }>;\r\n\r\n\r\n\r\nconst StoryElement: React.FC<{ elem: DOMElement | null, root: DOMElement, switchToScene: (id: string) => unknown }> = ({ elem, root, switchToScene }) => {\r\n    if (!elem) {\r\n        return <></>;\r\n    }\r\n    if (elem.type === 'text') {\r\n        return <>{elem.text}</>;\r\n    }\r\n    const contents = <>\r\n        {elem.elements?.map(e => <StoryElement elem={e} root={root} switchToScene={switchToScene} />)}\r\n    </>;\r\n    switch (elem.name) {\r\n        case 'p': return <ParagraphRenderer switchToScene={switchToScene} elem={elem}>{contents}</ParagraphRenderer>\r\n        case 'setting': return <SettingRenderer switchToScene={switchToScene} elem={elem}>{contents}</SettingRenderer>\r\n        case 'roll': return <RollRenderer switchToScene={switchToScene} elem={elem}>{contents}</RollRenderer>\r\n        case 'reward': return <RewardRenderer switchToScene={switchToScene} elem={elem}>{contents}</RewardRenderer>\r\n        case 'jump': return <JumpRenderer switchToScene={switchToScene} elem={elem}>{contents}</JumpRenderer>\r\n        case 'langauge': return <LanguageRenderer switchToScene={switchToScene} elem={elem}>{contents}</LanguageRenderer>\r\n        case 'event': return <EventRenderer switchToScene={switchToScene} elem={elem}>{contents}</EventRenderer>\r\n        case 'character':\r\n        case 'item':\r\n            {\r\n                const target = DomUtils.attr(elem, 'ref').toString();\r\n                const targetElem = DomUtils.findById(root, elem.name, target);\r\n                if (targetElem) {\r\n                    const targetIcon: SemanticICONS = targetElem.name === 'character' ? 'user outline' : 'gift';\r\n                    return <Popup hoverable trigger={<span><Icon name={targetIcon} fitted /> <strong>{contents}</strong></span>} wide>\r\n                        <Popup.Content>\r\n                            <StoryCard tag={targetElem} root={root} switchToScene={switchToScene} readOnly={true} save={() => { throw new Error('edit not implemented') }} />\r\n                        </Popup.Content>\r\n                    </Popup>\r\n                }\r\n                return contents;\r\n            } case 'language': {\r\n                const level = DomUtils.attr(elem, 'level');\r\n                return <>{contents} { level ? <em>({level})</em> : ''}</>;\r\n            }\r\n        default: {\r\n            return contents;\r\n        }\r\n    }\r\n}\r\n\r\nconst StoryCard: React.FC<{ tag: DOMElement, root: DOMElement, switchToScene: (id: string) => unknown, save: () => unknown, readOnly: boolean }> = ({ tag, root, switchToScene, save, readOnly }) => {\r\n    if (tag.name === 'character') {\r\n        return <CharacterCard save={save} elem={tag} root={root} switchToScene={switchToScene} readOnly={readOnly} />\r\n    }\r\n    if (tag.name === 'item') {\r\n        return <ItemCard save={save} elem={tag} root={root} switchToScene={switchToScene} readOnly={readOnly} />\r\n    }\r\n    return null;\r\n}\r\n\r\nconst TableRow: React.FC<{ label: string, elem: DOMElement | null, root: DOMElement, switchToScene: (id: string) => unknown, save: () => unknown, create: () => unknown, readOnly: boolean }> = ({ label, elem, root, switchToScene, save, create, readOnly }) => {\r\n    return <Table.Row>\r\n        <Table.Cell>{label}</Table.Cell>\r\n        <Table.Cell><EditableNode readOnly={readOnly} elem={elem} root={root} onChange={save} create={create}><StoryElement elem={elem} root={root} switchToScene={switchToScene} /></EditableNode> </Table.Cell>\r\n    </Table.Row>;\r\n}\r\n\r\n\r\n\r\nconst CharacterCard: React.FC<{ elem: DOMElement, root: DOMElement, switchToScene: (id: string) => unknown, save: () => unknown, readOnly: boolean }> = ({ elem, root, switchToScene, save, readOnly }) => {\r\n\r\n    const NestedTableRow: React.FC<{ name: string, parent: DOMElement, label: string }> = ({ name, parent, label }) => {\r\n        const elems = DomUtils.findElementsByName(parent, name);\r\n        const [first, ...rest] = elems;\r\n        return <>\r\n            <Table.Row key={`${name}-first`}>\r\n                <Table.Cell rowSpan={elems.length + 1}>{label}</Table.Cell>\r\n                <Table.Cell>\r\n                    <EditableNode readOnly={readOnly} elem={first} root={root} onChange={save} create={() => { DomUtils.addChild(parent, name); save() }}>\r\n                        <Button size='tiny' basic floated='right' icon='delete' onClick={() => { DomUtils.deleteChild(parent, first); save(); }} />\r\n                        <StoryElement elem={first} root={root} switchToScene={switchToScene} />\r\n                    </EditableNode>\r\n                </Table.Cell>\r\n            </Table.Row>\r\n            {rest.map((r, i) => <Table.Row key={`${name}-${i}`}><Table.Cell>\r\n                <EditableNode readOnly={readOnly} elem={r} root={root} onChange={save} create={() => { throw new Error('not applicable') }}>\r\n                    {!readOnly && <Button size='tiny' basic floated='right' icon='delete' onClick={() => { DomUtils.deleteChild(parent, r); save(); }} />}\r\n                    <StoryElement elem={r} root={root} switchToScene={switchToScene} />\r\n                </EditableNode>\r\n\r\n            </Table.Cell></Table.Row>)}\r\n            {first && !readOnly && <Table.Row key={`${name}-plus`}><Table.Cell><Button basic size='tiny' onClick={() => { DomUtils.addChild(parent, name); save() }} icon='plus' /></Table.Cell></Table.Row>}\r\n        </>;\r\n    }\r\n\r\n    const Row: React.FC<{ label: string, name: string }> = ({ label, name }) => <TableRow\r\n        key={name}\r\n        save={save}\r\n        label={label}\r\n        readOnly={readOnly}\r\n        elem={DomUtils.child(elem, name)}\r\n        create={() => { DomUtils.addChild(elem, name); save() }}\r\n        root={root}\r\n        switchToScene={switchToScene} />\r\n\r\n    return <Table definition striped columns={2} structured>\r\n        <Table.Body>\r\n            <Row label='Nv' name='name' />\r\n            <Row label='Faj' name='race' />\r\n            <Row label='Jellem' name='alignment' />\r\n            <Row label='Kaszt' name='class' />\r\n            <Row label='Szlfld' name='origin' />\r\n            <NestedTableRow parent={elem} name='language' label='Nyelvek' />\r\n            <Row label='Kinzet' name='looks' />\r\n            <Row label='Viselkeds' name='behaviour' />\r\n            <NestedTableRow parent={elem} name='loot' label='Felszerels' />\r\n        </Table.Body>\r\n    </Table>;\r\n}\r\n\r\n\r\nconst ItemCard: React.FC<{ elem: DOMElement, root: DOMElement, switchToScene: (id: string) => unknown, save: () => unknown, readOnly: boolean }> = ({ elem, root, switchToScene, save, readOnly }) => {\r\n\r\n    const Row: React.FC<{ label: string, name: string }> = ({ label, name }) => <TableRow\r\n        key={name}\r\n        save={save}\r\n        label={label}\r\n        readOnly={readOnly}\r\n        elem={DomUtils.child(elem, name)}\r\n        create={() => { DomUtils.addChild(elem, name); save() }}\r\n        root={root}\r\n        switchToScene={switchToScene} />\r\n\r\n\r\n    return <Table definition striped columns={2}>\r\n        <Table.Body>\r\n            <Row label='Nv' name='name' />\r\n            <Row label='rtk' name='value' />\r\n            <Table.Row>\r\n                <Table.Cell colSpan={2}>\r\n                    <EditableNode\r\n                        readOnly={readOnly}\r\n                        elem={DomUtils.child(elem, 'description')}\r\n                        root={root}\r\n                        onChange={save}\r\n                        create={() => { DomUtils.addChild(elem, 'description'); save() }}>\r\n                        <StoryElement elem={DomUtils.child(elem, 'description')} root={root} switchToScene={switchToScene} />\r\n                    </EditableNode>\r\n                </Table.Cell>\r\n            </Table.Row>\r\n        </Table.Body>\r\n    </Table>;\r\n}\r\n\r\nconst StoryCards: React.FC<{ root: DOMElement, name: string, switchToScene: (id: string) => unknown, save: () => unknown }> = ({ root, name, switchToScene, save }) => {\r\n    const cards = DomUtils.findElementsByName(root, name).filter(e => !e.attributes?.ref);\r\n    return <CardGroup itemsPerRow={5}>\r\n        {cards.map(c => <Card raised key={DomUtils.attr(c, 'id')}>\r\n            <Card.Content>\r\n                <Card.Header>{DomUtils.childText(c, 'name')}\r\n                    <Button floated='right' icon='delete' color='red'\r\n                        disabled={DomUtils.findReferences(root, c).length > 0}\r\n                        onClick={() => {\r\n                            DomUtils.deleteChild(c.$parent, c);\r\n                            save();\r\n                        }} />\r\n                </Card.Header>\r\n                <Card.Meta>\r\n                    <StoryCard readOnly={false} save={save} tag={c} root={root} switchToScene={switchToScene} />\r\n                </Card.Meta>\r\n            </Card.Content>\r\n        </Card>\r\n        )}\r\n    </CardGroup>\r\n}\r\n\r\nexport interface Renderer {\r\n    renderElement: (elem: DOMElement) => ReactNode\r\n    renderCards: (name: string, save: () => unknown) => ReactNode\r\n}\r\n\r\nconst createRenderer = (root: DOMElement, switchScene: (id: string) => unknown): Renderer => {\r\n    return {\r\n        renderElement: elem => <StoryElement elem={elem} root={root} switchToScene={switchScene} />,\r\n        renderCards: (name, save) => <StoryCards save={save} root={root} name={name} switchToScene={switchScene} />\r\n    }\r\n}\r\n\r\nexport const RenderUtils = {\r\n    createRenderer\r\n}","import { ContentState } from 'draft-js';\r\nimport React from 'react';\r\nimport { Icon, SemanticICONS } from 'semantic-ui-react';\r\nimport { STORY_TAG_ICONS } from '../../utils/RenderUtils';\r\n\r\nexport type DraftDecoratorComponentProps = {\r\n    contentState: ContentState,\r\n    decoratedText: string,\r\n    end: number,\r\n    // Many folks mistakenly assume that there will always be an 'entityKey'\r\n    // passed to a DecoratorComponent.\r\n    // To find the `entityKey`, Draft calls\r\n    // `contentBlock.getEntityKeyAt(leafNode)` and in many cases the leafNode does\r\n    // not have an entityKey. In those cases the entityKey will be null or\r\n    // undefined. That's why `getEntityKeyAt()` is typed to return `?string`.\r\n    // See https://github.com/facebook/draft-js/blob/2da3dcb1c4c106d1b2a0f07b3d0275b8d724e777/src/model/immutable/BlockNode.js#L51\r\n    entityKey?: string,\r\n    offsetKey: string,\r\n    start: number,\r\n};\r\n\r\n\r\n\r\nexport const IconComponent: React.FC<DraftDecoratorComponentProps> = ({ offsetKey, children, contentState, entityKey }) => {\r\n    const entity = entityKey ? contentState.getEntity(entityKey) : null;\r\n    const icon: SemanticICONS = STORY_TAG_ICONS[entity?.getType() ?? ''];\r\n    return <>\r\n        <span\r\n            style={{ fontWeight: 'bold' }}\r\n            data-offset-key={offsetKey}\r\n        >\r\n            <Icon name={icon} fitted />\r\n            {children}\r\n        </span>\r\n    </>;\r\n};","import React from 'react';\r\nimport { Dropdown, DropdownItemProps, Label } from 'semantic-ui-react';\r\nimport { ROLE_ICONS } from '../StoryEvent';\r\n\r\nconst options: Array<DropdownItemProps> = Object.keys(ROLE_ICONS).map(role => ({\r\n    key: role,\r\n    value: role,\r\n    text: role,\r\n    icon: ROLE_ICONS[role]\r\n}));\r\n\r\nexport const EventRowSelector: React.FC<{ role?: string, onRoleSelected(role?: string): unknown }> = ({ role, onRoleSelected }) => (\r\n    <>\r\n        <Label pointing='right'>\r\n            Event role:\r\n        </Label>\r\n        <Dropdown\r\n            placeholder='Select Role'\r\n            labeled\r\n            selection\r\n            value={role}\r\n            onChange={(e, { value }) => { onRoleSelected(value as string) }}\r\n            options={options}\r\n        >\r\n        </Dropdown>\r\n    </>\r\n)","import React, { useCallback, useEffect, useState } from 'react';\r\nimport { CompositeDecorator, ContentState, Editor, EditorState, getDefaultKeyBinding } from 'draft-js';\r\nimport 'draft-js/dist/Draft.css';\r\nimport { Button, Label, Segment } from 'semantic-ui-react';\r\nimport { EditorUtils } from '../../utils/EditorUtils';\r\nimport { EditingButtons } from './EditingButtons';\r\nimport { IconComponent } from './IconComponent';\r\nimport { DOMElement, DomUtils } from '../../utils/DomUtils';\r\nimport { EventRowSelector } from './EventRoleSelector';\r\nimport { NumberInput } from '../../../components/NumberInput';\r\n\r\nconst { processElement, toElements } = EditorUtils;\r\n\r\n\r\ninterface EventEditorProps { elem: DOMElement, onFinished(save: boolean): unknown, root: DOMElement, eventEdited?: boolean };\r\n\r\nexport const EventEditor: React.FC<EventEditorProps> = ({ elem, onFinished, root, eventEdited }) => {\r\n    const [editorState, setEditorState] = useState(\r\n        () => EditorState.createEmpty(),\r\n    );\r\n    const [eventRole, setEventRole] = useState<string | undefined>(eventEdited ? DomUtils.attr(elem, 'role') : undefined);\r\n    const [eventDate, setEventDate] = useState<string | undefined>(eventEdited ? DomUtils.attr(elem, 'date') : undefined);\r\n\r\n    const onEscape = useCallback(() => {\r\n        onFinished(false);\r\n    }, [onFinished]);\r\n\r\n    useEffect(() => {\r\n        const state = processElement(elem, ContentState.createFromBlockArray([]), true);\r\n        const inlineDecorator = new CompositeDecorator([\r\n            {\r\n                strategy: (block, callback, _state) => {\r\n                    block.findEntityRanges(c => !!c.getEntity(), callback);\r\n                },\r\n                component: IconComponent\r\n            }\r\n        ]);\r\n        setEditorState(EditorState.createWithContent(state, inlineDecorator));\r\n    }, [elem, eventEdited]);\r\n\r\n\r\n    return <>\r\n        {eventEdited && <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n            <span>\r\n                <EventRowSelector role={eventRole} onRoleSelected={setEventRole} />\r\n            </span>\r\n            <span>\r\n                <NumberInput icons={false} min={-100000} max={100000} value={Number(eventDate || 0)} onChange={v => setEventDate(String(v))} />\r\n                <Label pointing='left'>Nap</Label>\r\n            </span>\r\n        </div>\r\n        }\r\n        <EditingButtons editorState={editorState} setEditorState={setEditorState} root={root} />\r\n        <Segment>\r\n            <Editor editorState={editorState} onChange={setEditorState} keyBindingFn={e => {\r\n                if (e.key === 'Escape') {\r\n                    return 'my-escape';\r\n                }\r\n                return getDefaultKeyBinding(e);\r\n            }}\r\n                handleKeyCommand={c => {\r\n                    if (c === 'my-escape') {\r\n                        onEscape();\r\n                        return 'handled';\r\n                    }\r\n                    return 'not-handled';\r\n                }}\r\n\r\n            />\r\n        </Segment>\r\n        <Button floated='left' primary onClick={() => {\r\n            if (eventEdited) {\r\n                DomUtils.attr(elem, 'role', eventRole);\r\n                if (eventDate !== undefined) {\r\n                    DomUtils.attr(elem, 'date', eventDate.toString());\r\n                }\r\n            }\r\n            elem.elements = toElements(editorState.getCurrentContent(), elem);\r\n            console.log('edited', DomUtils.print(elem))\r\n            onFinished(true);\r\n        }\r\n        }>Save</Button>\r\n        <Button floated='right' circular color='red' basic content='Cancel' onClick={() => onFinished(false)} />\r\n    </>;\r\n}\r\n","import React from 'react';\r\nimport { Modal } from 'semantic-ui-react';\r\nimport { DOMElement, DomUtils } from '../utils/DomUtils';\r\nimport { EventEditor } from './editor/EventEditor';\r\nimport { EventEditingState } from './StoryScene';\r\n\r\nexport interface EventEditorModalProps {\r\n    onEditingFinished: (save: boolean) => unknown;\r\n    editedEvent?: EventEditingState;\r\n    root: DOMElement;\r\n}\r\n\r\nexport const EventEditorModal: React.FC<EventEditorModalProps> = ({ editedEvent, onEditingFinished, root }) => {\r\n    return <Modal style={{ padding: '1em' }} open={editedEvent !== undefined} onClose={() => onEditingFinished(false)}>\r\n        <Modal.Content>\r\n            <div>\r\n                {editedEvent && <EventEditor elem={editedEvent.elem} onFinished={save => {\r\n                    if (save && editedEvent.insert) {\r\n                        DomUtils.addChildElement(editedEvent.elem.$parent as DOMElement, editedEvent.elem, editedEvent.anchor as DOMElement, editedEvent.insert);\r\n                    }\r\n                    onEditingFinished(save);\r\n                }\r\n                } root={root} eventEdited />}\r\n            </div>\r\n        </Modal.Content>\r\n    </Modal>;\r\n}","import React from 'react';\r\nimport { Popup } from 'semantic-ui-react';\r\n\r\nexport interface TimelineEvent {\r\n    date: number;\r\n    content: JSX.Element;\r\n}\r\n\r\nexport const Timeline: React.FC<{ events: Array<TimelineEvent>; width: number }> = ({ events, width }) => {\r\n\r\n    if (events.length < 2) {\r\n        return null;\r\n    }\r\n\r\n    const orderedEvents = events.sort((a, b) => a.date - b.date);\r\n\r\n\r\n    const heights = [...Array(orderedEvents.length - 1).fill(0).map((_, i) => orderedEvents[i + 1].date - orderedEvents[i].date), 0];\r\n\r\n    const unitHeight = 100 / heights.reduce((acc, curr) => acc + curr, 0);\r\n\r\n    const TimelineUnit: React.FC<{ height: number, event: TimelineEvent, position: 'left' | 'right' }> = ({ height, event, position }) => {\r\n        const crossbar = () => <div style={{ backgroundColor: 'black', position: 'relative', top: 0, left: '-10px', width: `${20 + width}px`, height: '1px' }}>\r\n            &nbsp;\r\n            </div>\r\n        return <div style={{ flexBasis: `${height}%`, width: `${width}px`, backgroundColor: 'black' }}>\r\n            <Popup style={{ zIndex: 0 }} trigger={crossbar()} open={true} position={position === 'left' ? 'left center' : 'right center'} pinned wide>\r\n                {event.content}\r\n            </Popup>\r\n            <Popup style={{ border: 'none', boxShadow: 'none', zIndex: 0 }} trigger={crossbar()} open={true} position={position === 'left' ? 'right center' : 'left center'} pinned basic>\r\n                {event.date}\r\n            </Popup>\r\n        </div>\r\n    }\r\n\r\n\r\n    return <div style={{ height: '1000px', alignItems: 'center', display: 'flex', flexDirection: 'column', flexWrap: 'nowrap' }}>\r\n        {heights.map((height, i) => <TimelineUnit height={height * unitHeight} event={orderedEvents[i]} position={i % 2 ? 'left' : 'right'} />)}\r\n    </div>\r\n}","import React from 'react';\r\nimport { ContextMenu } from './ContextMenu';\r\nimport { EditedEvent } from './StoryEvent';\r\n\r\nexport interface StoryContextMenuProps {\r\n    setEditedEvent: (editedEvent: EditedEvent) => unknown;\r\n    onClose: () => unknown;\r\n    event: React.MouseEvent;\r\n}\r\n\r\nexport const StoryContextMenu: React.FC<StoryContextMenuProps> = ({ setEditedEvent, children, onClose, event }) => (\r\n\r\n\r\n    <ContextMenu onClose={onClose} event={event} items={[\r\n        { name: 'insertBefore', content: 'j elem', icon: 'up arrow' },\r\n        { name: 'edit', content: 'Szerkeszt', icon: 'edit' },\r\n        { name: 'delete', content: 'Trl', icon: 'delete' },\r\n        { name: 'insertAfter', content: 'j elem', icon: 'down arrow' },\r\n    ]}\r\n        onClicked={item => {\r\n            setEditedEvent({ operation: item.name as any });\r\n        }}>\r\n        {children}\r\n    </ContextMenu>\r\n);","import { v4 } from 'uuid';\r\nimport { DOMElement, DomUtils } from './DomUtils';\r\n\r\nconst { attr, child, addChild, deleteChild, children, addText, findElementsByName } = DomUtils;\r\n\r\nconst ensureComments = (root: DOMElement) => {\r\n    const story = child(root, 'story');\r\n    if (!story) {\r\n        throw new Error('story is missing');\r\n    }\r\n    return child(story, 'comments') || addChild(story, 'comments');\r\n}\r\n\r\nconst addComment = (event: DOMElement, root: DOMElement, contents: string) => {\r\n    const eventId = ensureEventId(event);\r\n    const comments = ensureComments(root);\r\n    const lastComment = children(comments, 'comment').pop();\r\n    const comment = addChild(comments, 'comment', lastComment);\r\n    attr(comment, 'event', eventId);\r\n    addText(comment, contents);\r\n}\r\n\r\nconst deleteComment = (comment: DOMElement, root: DOMElement) => {\r\n    const comments = ensureComments(root);\r\n    deleteChild(comments, comment);\r\n}\r\n\r\n\r\nconst findComments = (event: DOMElement, root: DOMElement): Array<DOMElement> => {\r\n    const eventId = attr(event, 'id');\r\n    const allComments = findElementsByName(root, 'comment');\r\n    return allComments.filter(c => attr(c, 'event') === eventId);\r\n}\r\n\r\n\r\nconst ensureEventId = (event: DOMElement) => {\r\n    let id = attr(event, 'id') || v4();\r\n    attr(event, 'id', id);\r\n    return id;\r\n\r\n}\r\n\r\nexport class CommentUtils {\r\n    constructor(private readonly root: DOMElement, private readonly event: DOMElement) { }\r\n\r\n    public add = (contents: string) => addComment(this.event, this.root, contents);\r\n    public remove = (comment: DOMElement) => deleteComment(comment, this.root);\r\n    public list = (): Array<DOMElement> => findComments(this.event, this.root);\r\n\r\n}","import React, { useState } from 'react';\r\nimport { Button } from 'semantic-ui-react';\r\nimport { DOMElement, DomUtils } from '../utils/DomUtils';\r\nimport { Renderer } from '../utils/RenderUtils';\r\nimport { StoryEvent } from './StoryEvent';\r\nimport { EventEditorModal } from './EventEditorModal';\r\nimport { Timeline } from './timeline/Timeline';\r\nimport { StoryContextMenu } from './StoryContextMenu';\r\nimport { CommentUtils } from '../utils/CommentUtils';\r\n\r\nconst { attr, children } = DomUtils;\r\n\r\nexport interface EventEditingState {\r\n    insert?: 'after' | 'before',\r\n    anchor?: DOMElement,\r\n    elem: DOMElement\r\n}\r\n\r\n\r\n\r\nexport const StoryScene: React.FC<{ scene: DOMElement, renderer: Renderer, onChange: () => unknown, root: DOMElement }> = ({ scene, renderer, onChange, root }) => {\r\n    const events = children(scene, 'events')[0];\r\n    const [editedEvent, setEditedEvent] = useState<EventEditingState>();\r\n    const [contextMenu, setContextMenu] = useState<{ elem: DOMElement, event: React.MouseEvent }>();\r\n    const [displayMode, setDisplayMode] = useState<'list' | 'timeline'>('list');\r\n\r\n    return <>\r\n        {contextMenu && <StoryContextMenu setEditedEvent={event => {\r\n            if (event.operation === 'insertAfter' || event.operation === 'insertBefore') {\r\n                setEditedEvent({\r\n                    insert: event.operation === 'insertAfter' ? 'after' : 'before', elem: {\r\n                        type: 'element',\r\n                        name: 'event',\r\n                        $parent: contextMenu.elem.$parent\r\n                    }, anchor: contextMenu.elem\r\n                });\r\n            } else if (event.operation === 'delete') {\r\n                DomUtils.deleteChild(contextMenu.elem.$parent, contextMenu.elem);\r\n                onChange();\r\n            } else {\r\n                setEditedEvent({ elem: contextMenu.elem });\r\n            }\r\n        }\r\n        }\r\n            onClose={() => setContextMenu(undefined)}\r\n            event={contextMenu.event}\r\n        />}\r\n        <EventEditorModal\r\n            editedEvent={editedEvent}\r\n            onEditingFinished={() => { setEditedEvent(undefined); onChange(); }}\r\n            root={root}\r\n        />\r\n        <div>\r\n            {displayMode === 'list' && events?.elements?.map(e => <StoryEvent\r\n                event={e}\r\n                renderer={renderer}\r\n                onContextMenu={event => setContextMenu({ elem: e, event })}\r\n                onEdit={() => setEditedEvent({ elem: e })}\r\n                onClick={() => {\r\n                    const status = attr(e, 'status');\r\n                    attr(e, 'status', status ? null : 'completed');\r\n                    onChange();\r\n                }}\r\n                commentUtils={new CommentUtils(root, e)}\r\n                onChange={onChange}\r\n            />)}\r\n            {displayMode === 'timeline' && <Timeline width={5} events={events?.elements?.filter(e => attr(e, 'date') !== '').map(e => ({ date: Number(attr(e, 'date')), content: <>{renderer.renderElement(e)}</> })) ?? []} />}\r\n\r\n            <div style={{ backgroundColor: 'gainsboro' }}>\r\n                <Button icon='plus' onClick={() => {\r\n                    setEditedEvent({\r\n                        insert: 'after',\r\n                        elem: {\r\n                            type: 'element',\r\n                            name: 'event',\r\n                            $parent: events\r\n                        }\r\n                    });\r\n\r\n                }} content='j elem' />\r\n                {displayMode === 'list' && <Button icon='calendar' onClick={() => setDisplayMode('timeline')} content='Idvonal' />}\r\n                {displayMode === 'timeline' && <Button icon='list' onClick={() => setDisplayMode('list')} content='Lista' />}\r\n            </div>\r\n        </div>\r\n\r\n    </>\r\n}\r\n\r\n","import fileDownload from 'js-file-download';\r\nimport React, { useState } from 'react';\r\nimport { Button, Header, Icon, Menu, Tab } from 'semantic-ui-react';\r\nimport { v4 } from 'uuid';\r\nimport { EditableText } from '../components/EditableText';\r\nimport { SceneListContextMenu } from '../components/SceneListContextMenu';\r\nimport { StoryScene } from '../components/StoryScene';\r\nimport { DOMElement, DomUtils } from '../utils/DomUtils';\r\nimport { RenderUtils } from '../utils/RenderUtils';\r\n\r\nconst { attr, findElementsByName, parse, print, convertLegacyLinks } = DomUtils;\r\n\r\nexport const StoryPage: React.FC<{ story: string, saveStory: (story: string) => unknown }> = ({ story, saveStory }) => {\r\n    const [activeScene, setActiveScene] = useState<string>();\r\n    const storyOb = parse(story);\r\n    convertLegacyLinks(storyOb);\r\n    const scenes = findElementsByName(storyOb, 'scene');\r\n    const findSceneById = (id?: string) => {\r\n        return scenes.findIndex(s => attr(s, 'id') === id);\r\n    }\r\n\r\n    const save = () => {\r\n        saveStory(print(storyOb))\r\n    }\r\n\r\n    const renderer = RenderUtils.createRenderer(storyOb, id => setActiveScene(id));\r\n    const sceneTabs = scenes.map(s => {\r\n        return {\r\n            menuItem: <Menu.Item key={attr(s, 'id')}><SceneListContextMenu onSelected={item => {\r\n                if (item === 'delete') {\r\n                    DomUtils.deleteChild(s.$parent, s);\r\n                } else {\r\n                    const scene = DomUtils.addChild(s.$parent, 'scene', s, item === 'insertAfter' ? 'after' : 'before');\r\n                    DomUtils.attr(scene, 'id', v4());\r\n                    DomUtils.attr(scene, 'title', 'j jelenet');\r\n                    DomUtils.addChild(scene, 'events');\r\n                    setTimeout(() => setActiveScene(DomUtils.attr(scene, 'id')), 0); //workaround for Tab overwriting activeIndex straight away\r\n                }\r\n                save();\r\n            }}>\r\n                {activeScene === DomUtils.attr(s, 'id') ? <EditableText text={attr(s, 'title')} onChange={title => {\r\n                    DomUtils.attr(s, 'title', title);\r\n                    save();\r\n                }} /> : attr(s, 'title')}\r\n            </SceneListContextMenu></Menu.Item>,\r\n            render: () => <Tab.Pane>\r\n                <StoryScene\r\n                    scene={s}\r\n                    renderer={renderer}\r\n                    onChange={save}\r\n                    root={storyOb} />\r\n            </Tab.Pane>\r\n        }\r\n    });\r\n    sceneTabs.push({\r\n        menuItem: <Menu.Item key='__add'><Icon name='plus' onClick={() => {\r\n            const story: DOMElement = DomUtils.child(storyOb, 'story') as DOMElement;\r\n            const scene = DomUtils.addChild(story, 'scene', undefined, 'after');\r\n            DomUtils.attr(scene, 'id', v4());\r\n            DomUtils.attr(scene, 'title', 'j jelenet');\r\n            DomUtils.addChild(scene, 'events');\r\n            setTimeout(() => setActiveScene(DomUtils.attr(scene, 'id')), 0); //workaround for Tab overwriting activeIndex straight away\r\n            save();\r\n\r\n        }} /></Menu.Item>,\r\n        render: () => {\r\n            return <></>;\r\n        }\r\n    })\r\n\r\n    return <>\r\n        <Button onClick={() => fileDownload(story, 'mese.xml', 'application/xml')} color='green' circular>Export</Button>\r\n        <Button onClick={() => {\r\n            const characters = DomUtils.findElementsByName(storyOb, 'characters')[0];\r\n            const character = DomUtils.addChild(characters, 'character');\r\n            DomUtils.attr(character, 'id', v4());\r\n            DomUtils.addChild(character, 'name');\r\n            DomUtils.addChild(character, 'race');\r\n            DomUtils.addChild(character, 'alignment');\r\n            DomUtils.addChild(character, 'class');\r\n            DomUtils.addChild(character, 'origin');\r\n            DomUtils.addChild(character, 'language');\r\n            DomUtils.addChild(character, 'looks');\r\n            DomUtils.addChild(character, 'behaviour');\r\n            DomUtils.addChild(character, 'loot');\r\n\r\n            save();\r\n\r\n        }} color='green' circular>j szerepl</Button>\r\n        <Button onClick={() => {\r\n            const items = DomUtils.findElementsByName(storyOb, 'items')[0];\r\n            const item = DomUtils.addChild(items, 'item');\r\n            DomUtils.attr(item, 'id', v4());\r\n            DomUtils.addChild(item, 'name');\r\n            DomUtils.addChild(item, 'value');\r\n            DomUtils.addChild(item, 'description');\r\n\r\n            save();\r\n\r\n        }} color='green' circular>j trgy</Button>\r\n        <Tab activeIndex={findSceneById(activeScene)} onTabChange={(e, { activeIndex }) => activeIndex as number < scenes.length && setActiveScene(DomUtils.attr(scenes[activeIndex as number], 'id'))} panes={sceneTabs} />\r\n\r\n        <>\r\n            <Header as='h1'>Szereplk</Header>\r\n            {renderer.renderCards('character', save)}\r\n        </>\r\n        <>\r\n            <Header as='h1'>Trgyak</Header>\r\n            {renderer.renderCards('item', save)}\r\n        </>\r\n    </>;\r\n}","import React, { useCallback, useState } from 'react';\nimport { KarakterAlkotas } from './pages/KarakterAlkotas';\nimport { Karakterlap } from './pages/Karakterlap';\nimport { useDataConnector } from './hooks/dataconnector';\nimport { Karakter, KarakterInfo } from './engine/karakter';\nimport 'semantic-ui-css/semantic.min.css'\nimport { PageHeader } from './components/PageHeader';\nimport { Kombat } from './pages/Kombat';\nimport { StoryPage } from './story/pages/StoryPage';\n\nexport type PageSelection = { page: 'karakteralkoto' | 'home' } | { page: 'karakterlap', karakter: KarakterInfo } | { page: 'kombat', category: string } | { page: 'story' }\n\n\nfunction App() {\n\n  const [page, setPage] = useState<PageSelection>({ page: 'home' });\n  const { save, list, categories, load, remove, listFajok, listFegyverek, saveFegyverek, loadStory, saveStory, listPancelok, savePancelok, clone } = useDataConnector();\n  const [currentCategory, setCurrentCategory] = useState('');\n\n  const saveKarakter = useCallback((karakter: Karakter) => {\n    save(karakter);\n    setPage({ page: 'karakterlap', karakter });\n  }, [save, setPage]);\n\n  const removeKarakter = useCallback((karakter: Karakter) => {\n    if (karakter) {\n      remove(karakter);\n      setPage({ page: 'home' });\n    }\n  }, [setPage, remove]);\n\n  const renderPage = () => {\n    switch (page.page) {\n      case 'home': return <div>vakodj a rotoni lomhatasaktl</div>\n      case 'kombat': return <Kombat karakterek={list(page.category).map(i => load(i))} save={save} />\n      case 'karakteralkoto': return <KarakterAlkotas save={saveKarakter} fajok={listFajok()} />\n      case 'story': return <StoryPage story={loadStory()} saveStory={saveStory} />;\n      case 'karakterlap': return <Karakterlap clone={clone} pancelok={listPancelok()} savePancelok={savePancelok} saveFegyverek={saveFegyverek} fegyverek={listFegyverek()} categories={categories()} karakter={load(page.karakter)} save={saveKarakter} remove={() => removeKarakter(page.karakter as Karakter)} />\n    }\n  };\n\n\n\n  return (\n    <div className=\"App\">\n      <PageHeader\n        categories={categories()}\n        currentCategory={currentCategory}\n        setCurrentCategory={setCurrentCategory}\n        karakter={page.page === 'karakterlap' ? page.karakter : undefined}\n        page={page}\n        setPage={ps => {\n          setPage(ps);\n          if (ps.page === 'kombat') {\n            setCurrentCategory(ps.category);\n          }\n        }}\n        save={saveKarakter}\n        karakterek={list(currentCategory)}\n        saveMese={saveStory}\n      />\n      {renderPage()}\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}